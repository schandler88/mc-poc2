/*!
 * CARTO VL js https://carto.com/
 * Version: 0.9.0
 * 
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.carto=e():t.carto=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=85)}([function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){var r=n(15),i=n(11);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?i(t):e}},function(t,e,n){var r=n(21);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e,n){n(0);var r=n(23);function i(e,n,a){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=i=Reflect.get:t.exports=i=function(t,e,n){var i=r(t,e);if(i){var a=Object.getOwnPropertyDescriptor(i,e);return a.get?a.get.call(n):a.value}},i(e,n,a||e)}t.exports=i},function(t,e,n){var r=n(21);function i(e,n,a){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?t.exports=i=function(t,e,n){var i=[null];i.push.apply(i,e);var a=new(Function.bind.apply(t,i));return n&&r(a,n.prototype),a}:t.exports=i=Reflect.construct,i.apply(null,arguments)}t.exports=i},function(t,e,n){var r=n(65),i=n(66),a=n(67);t.exports=function(t){return r(t)||i(t)||a()}},function(t,e,n){t.exports=n(69)},function(t,e,n){!function(n){"use strict";var r=function(t,e){var n=new Error(t+" at character "+e);throw n.index=e,n.description=t,n},i=!0,a={"-":i,"!":i,"~":i,"+":i},o={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},u={$:i,_:i},s=function(t){var e,n=0;for(var r in t)(e=r.length)>n&&t.hasOwnProperty(r)&&(n=e);return n},c=s(a),f=s(o),l={true:!0,false:!1,null:null},h=function(t){return o[t]||0},d=function(t,e,n){return{type:"||"===t||"&&"===t?"LogicalExpression":"BinaryExpression",operator:t,left:e,right:n}},p=function(t){return t>=48&&t<=57},v=function(t){return t>=65&&t<=90||t>=97&&t<=122||t>=128&&!o[String.fromCharCode(t)]||u.hasOwnProperty(String.fromCharCode(t))},y=function(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||t>=128&&!o[String.fromCharCode(t)]||u.hasOwnProperty(String.fromCharCode(t))},m=function(t){for(var e,n,i=0,u=t.charAt,s=t.charCodeAt,m=function(e){return u.call(t,e)},g=function(e){return s.call(t,e)},b=t.length,_=function(){for(var t=g(i);32===t||9===t||10===t||13===t;)t=g(++i)},x=function(){var t,e,n=T();return _(),63!==g(i)?n:(i++,(t=x())||r("Expected expression",i),_(),58===g(i)?(i++,(e=x())||r("Expected expression",i),{type:"ConditionalExpression",test:n,consequent:t,alternate:e}):void r("Expected :",i))},w=function(){_();for(var e=t.substr(i,f),n=e.length;n>0;){if(o.hasOwnProperty(e)&&(!v(g(i))||i+e.length<t.length&&!y(g(i+e.length))))return i+=n,e;e=e.substr(0,--n)}return!1},T=function(){var t,e,n,a,o,u,s,c;if(u=E(),!(e=w()))return u;for(o={value:e,prec:h(e)},(s=E())||r("Expected expression after "+e,i),a=[u,o,s];(e=w())&&0!==(n=h(e));){for(o={value:e,prec:n};a.length>2&&n<=a[a.length-2].prec;)s=a.pop(),e=a.pop().value,u=a.pop(),t=d(e,u,s),a.push(t);(t=E())||r("Expected expression after "+e,i),a.push(o,t)}for(t=a[c=a.length-1];c>1;)t=d(a[c-1].value,a[c-2],t),c-=2;return t},E=function(){var e,n,r;if(_(),e=g(i),p(e)||46===e)return k();if(39===e||34===e)return A();if(91===e)return D();for(r=(n=t.substr(i,c)).length;r>0;){if(a.hasOwnProperty(n)&&(!v(g(i))||i+n.length<t.length&&!y(g(i+n.length))))return i+=r,{type:"UnaryExpression",operator:n,argument:E(),prefix:!0};n=n.substr(0,--r)}return!(!v(e)&&40!==e)&&S()},k=function(){for(var t,e,n="";p(g(i));)n+=m(i++);if(46===g(i))for(n+=m(i++);p(g(i));)n+=m(i++);if("e"===(t=m(i))||"E"===t){for(n+=m(i++),"+"!==(t=m(i))&&"-"!==t||(n+=m(i++));p(g(i));)n+=m(i++);p(g(i-1))||r("Expected exponent ("+n+m(i)+")",i)}return e=g(i),v(e)?r("Variable names cannot start with a number ("+n+m(i)+")",i):46===e&&r("Unexpected period",i),{type:"Literal",value:parseFloat(n),raw:n}},A=function(){for(var t,e="",n=m(i++),a=!1;i<b;){if((t=m(i++))===n){a=!0;break}if("\\"===t)switch(t=m(i++)){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=t}else e+=t}return a||r('Unclosed quote after "'+e+'"',i),{type:"Literal",value:e,raw:n+e+n}},C=function(){var e,n=g(i),a=i;for(v(n)?i++:r("Unexpected "+m(i),i);i<b&&(n=g(i),y(n));)i++;return e=t.slice(a,i),l.hasOwnProperty(e)?{type:"Literal",value:l[e],raw:e}:"this"===e?{type:"ThisExpression"}:{type:"Identifier",name:e}},M=function(t){for(var e,n,a=[],o=!1;i<b;){if(_(),(e=g(i))===t){o=!0,i++;break}44===e?i++:((n=x())&&"Compound"!==n.type||r("Expected comma",i),a.push(n))}return o||r("Expected "+String.fromCharCode(t),i),a},S=function(){var t,e;for(e=40===(t=g(i))?R():C(),_(),t=g(i);46===t||91===t||40===t;)i++,46===t?(_(),e={type:"MemberExpression",computed:!1,object:e,property:C()}):91===t?(e={type:"MemberExpression",computed:!0,object:e,property:x()},_(),93!==(t=g(i))&&r("Unclosed [",i),i++):40===t&&(e={type:"CallExpression",arguments:M(41),callee:e}),_(),t=g(i);return e},R=function(){i++;var t=x();if(_(),41===g(i))return i++,t;r("Unclosed (",i)},D=function(){return i++,{type:"ArrayExpression",elements:M(93)}},I=[];i<b;)59===(e=g(i))||44===e?i++:(n=x())?I.push(n):i<b&&r('Unexpected "'+m(i)+'"',i);return 1===I.length?I[0]:{type:"Compound",body:I}};m.version="0.3.4",m.toString=function(){return"JavaScript Expression Parser (JSEP) v"+m.version},m.addUnaryOp=function(t){return c=Math.max(t.length,c),a[t]=i,this},m.addBinaryOp=function(t,e){return f=Math.max(t.length,f),o[t]=e,this},m.addIdentifierChar=function(t){return u[t]=i,this},m.addLiteral=function(t,e){return l[t]=e,this},m.removeUnaryOp=function(t){return delete a[t],t.length===c&&(c=s(a)),this},m.removeAllUnaryOps=function(){return a={},c=0,this},m.removeIdentifierChar=function(t){return delete u[t],this},m.removeBinaryOp=function(t){return delete o[t],t.length===f&&(f=s(o)),this},m.removeAllBinaryOps=function(){return o={},f=0,this},m.removeLiteral=function(t){return delete l[t],this},m.removeAllLiterals=function(){return l={},this},void 0!==t&&t.exports?e=t.exports=m:e.parse=m}()},function(t,e){function n(t,e,n,r,i,a,o){try{var u=t[a](o),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,i)}t.exports=function(t){return function(){var e=this,r=arguments;return new Promise(function(i,a){var o=t.apply(e,r);function u(t){n(o,i,a,u,s,"next",t)}function s(t){n(o,i,a,u,s,"throw",t)}u(void 0)})}}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,n){var r=n(71),i=n(72),a=n(73);t.exports=function(t,e){return r(t)||i(t,e)||a()}},function(t,e,n){n(0);var r=n(23),i=n(14);function a(t,e,n,o){return(a="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,a){var o,u=r(t,e);if(u){if((o=Object.getOwnPropertyDescriptor(u,e)).set)return o.set.call(a,n),!0;if(!o.writable)return!1}if(o=Object.getOwnPropertyDescriptor(a,e)){if(!o.writable)return!1;o.value=n,Object.defineProperty(a,e,o)}else i(a,e,n);return!0})(t,e,n,o)}t.exports=function(t,e,n,r,i){if(!a(t,e,n,r||t)&&i)throw new Error("failed to set property");return n}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=r=function(t){return n(t)}:t.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},r(e)}t.exports=r},function(t){t.exports={a:"0.9.0"}},function(t,e){t.exports='#ifndef CIELAB_TO_SRGBA\n#define CIELAB_TO_SRGBA\n\nconst mat3 XYZ_2_RGB = (mat3(\n    3.2404542,-1.5371385,-0.4985314,\n    -0.9692660, 1.8760108, 0.0415560,\n    0.0556434,-0.2040259, 1.0572252\n));\nconst float SRGB_GAMMA = 1.0 / 2.2;\n\nvec3 rgb_to_srgb_approx(vec3 rgb) {\n    return pow(rgb, vec3(SRGB_GAMMA));\n}\n\nfloat f1(float t){\n    const float sigma = 6./29.;\n    if (t>sigma){\n        return t*t*t;\n    }else{\n        return 3.*sigma*sigma*(t-4./29.);\n    }\n}\n\nvec3 cielabtoxyz(vec3 c) {\n    const float xn = 95.047/100.;\n    const float yn = 100./100.;\n    const float zn = 108.883/100.;\n    return vec3(xn*f1((c.x+16.)/116.  + c.y/500. ),\n                yn*f1((c.x+16.)/116.),\n                zn*f1((c.x+16.)/116.  - c.z/200. )\n            );\n}\n\nvec3 xyztorgb(vec3 c){\n    return c * XYZ_2_RGB;\n}\n\nvec3 xyztosrgb(vec3 c) { // FIXME naming\n    return rgb_to_srgb_approx(xyztorgb(c));\n}\n\nvec4 cielabToSRGBA(vec4 cielab){\n    return vec4(xyztosrgb(cielabtoxyz(\n        vec3(\n            clamp(cielab.r, 0., 100.),\n            clamp(cielab.g, -128., 128.),\n            clamp(cielab.b, -128., 128.)\n        )\n    )), cielab.a);\n}\n#endif\n\n\n#ifndef SRGBA_TO_CIELAB\n#define SRGBA_TO_CIELAB\nvec4 sRGBToXYZ (vec4 srgba);\nvec4 sRGBToLinearRGB (vec4 srgba);\nfloat inverseGammaCorrection(float t);\nvec4 XYZToCieLab (vec4 xyza);\nfloat XYZToCieLabAux(float t);\n\nvec4 sRGBAToCieLAB(vec4 srgba){\n    return XYZToCieLab(sRGBToXYZ(srgba));\n}\n\n// Convert sRGB to CIE XYZ with the D65 white point\nvec4 sRGBToXYZ (vec4 srgba) {\n    // Poynton, "Frequently Asked Questions About Color," page 10\n    // Wikipedia: http://en.wikipedia.org/wiki/SRGB\n    // Wikipedia: http://en.wikipedia.org/wiki/CIE_1931_color_space\n    vec4 rgba = sRGBToLinearRGB(srgba);\n    return vec4(\n        (0.4123955889674142161 * rgba.r + 0.3575834307637148171 * rgba.g + 0.1804926473817015735 * rgba.b),\n        (0.2125862307855955516 * rgba.r + 0.7151703037034108499 * rgba.g + 0.07220049864333622685 * rgba.b),\n        (0.01929721549174694484 * rgba.r + 0.1191838645808485318 * rgba.g + 0.9504971251315797660 * rgba.b),\n        rgba.a\n    );\n}\n\nvec4 sRGBToLinearRGB (vec4 srgba) {\n    // http://en.wikipedia.org/wiki/SRGB\n    return vec4(\n        inverseGammaCorrection(srgba.r),\n        inverseGammaCorrection(srgba.g),\n        inverseGammaCorrection(srgba.b),\n        srgba.a\n    );\n}\n\nfloat inverseGammaCorrection(float t) {\n    return t <= 0.0404482362771076 ? t / 12.92 : pow((t + 0.055) / 1.055, 2.4);\n}\n\n\nfloat WHITEPOINT_D65_X = 0.950456;\nfloat WHITEPOINT_D65_Y = 1.0;\nfloat WHITEPOINT_D65_Z = 1.088754;\n\n// Convert CIE XYZ to CIE L*a*b* (CIELAB) with the D65 white point\nvec4 XYZToCieLab (vec4 xyza) {\n    // Wikipedia: http://en.wikipedia.org/wiki/Lab_color_space\n\n    float xn = WHITEPOINT_D65_X;\n    float yn = WHITEPOINT_D65_Y;\n    float zn = WHITEPOINT_D65_Z;\n\n    return vec4(\n        116. * XYZToCieLabAux(xyza.y / yn) - 16.,\n        500. * (XYZToCieLabAux(xyza.x / xn) - XYZToCieLabAux(xyza.y / yn)),\n        200. * (XYZToCieLabAux(xyza.y / yn) - XYZToCieLabAux(xyza.z / zn)),\n        xyza.a\n    );\n}\n\nfloat XYZToCieLabAux(float t) {\n    return t >= 8.85645167903563082e-3\n            ? pow(t, 0.333333333333333) : (841.0 / 108.0) * t + 4.0 / 29.0;\n}\n\n#endif\n'},function(t,e,n){var r=n(14);t.exports=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){r(t,e,n[e])})}return t}},function(t,e){t.exports="precision highp float;\nattribute vec2 vertex;\n\nvarying  vec2 uv;\n\nvoid main(void) {\n    uv = vertex*0.5+vec2(0.5);\n    gl_Position = vec4(vertex, 0.5, 1.);\n}\n"},function(t,e){t.exports="precision highp float;\n\nvarying vec2 uv;\n\nvec2 featureID;\n\n$propertyPreface\n$style_preface\n\nvoid main(void) {\n    featureID = abs(uv);\n    gl_FragColor = $style_inline;\n}\n"},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e,n){t.exports=n(74)},function(t,e,n){var r=n(0);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t}},function(t,e){var n,r,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function u(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(t){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var s,c=[],f=!1,l=-1;function h(){f&&s&&(f=!1,s.length?c=s.concat(c):l=-1,c.length&&d())}function d(){if(!f){var t=u(h);f=!0;for(var e=c.length;e;){for(s=c,c=[];++l<e;)s&&s[l].run();l=-1,e=c.length}s=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||f||u(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){var r=n(0),i=n(21),a=n(68),o=n(6);function u(e){var n="function"==typeof Map?new Map:void 0;return t.exports=u=function(t){if(null===t||!a(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return o(t,arguments,r(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),i(e,t)},u(e)}t.exports=u},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M7.5 2c-.676-.01-.676 1.01 0 1H9v1.266L6.197 6.6 5.223 4H5.5c.676.01.676-1.01 0-1h-2c-.676-.01-.676 1.01 0 1h.652l.891 2.375A3.45 3.45 0 0 0 3.5 6C1.573 6 0 7.573 0 9.5S1.573 13 3.5 13 7 11.427 7 9.5c0-.67-.2-1.291-.53-1.824l2.821-2.35.463 1.16C8.71 7.094 8 8.211 8 9.5c0 1.927 1.573 3.5 3.5 3.5S15 11.427 15 9.5 13.427 6 11.5 6c-.283 0-.554.043-.818.107L10 4.402V2.5a.5.5 0 0 0-.5-.5h-2zm-4 5a2.48 2.48 0 0 1 1.555.553L3.18 9.115c-.511.427.128 1.195.64.77l1.875-1.563c.188.352.305.75.305 1.178C6 10.887 4.887 12 3.5 12S1 10.887 1 9.5 2.113 7 3.5 7zm8 0C12.887 7 14 8.113 14 9.5S12.887 12 11.5 12 9 10.887 9 9.5c0-.877.447-1.642 1.125-2.088l.91 2.274c.246.623 1.18.25.93-.372l-.908-2.27C11.2 7.02 11.348 7 11.5 7z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M3 2v11h5v-3h3v3h1V2H3zm4 10H4v-2h3v2zm0-3H4V7h3v2zm0-3H4V4h3v2zm4 3H8V7h3v2zm0-3H8V4h3v2z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M4 0C2.636 0 1 .743 1 2.746V12s0 1 1 1v1s0 1 1 1 1-1 1-1v-1h7v1s0 1 1 1 1-1 1-1v-1s1 0 1-1V2.746C14 .701 12.764 0 11.4 0H4zm.25 1.5h6.5a.25.25 0 1 1 0 .5h-6.5a.25.25 0 1 1 0-.5zM3 3h9c1 0 1 .967 1 .967V7s0 1-1 1H3C2 8 2 7 2 7V4s0-1 1-1zm0 7a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm9 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M14 7a1.5 1.5 0 0 0-1.15-1.45l-1.39-3.24A.5.5 0 0 0 11 2H4a.5.5 0 0 0-.44.28L2.15 5.54A1.5 1.5 0 0 0 1 7v3.5h1v1a1 1 0 1 0 2 0v-1h7v1a1 1 0 1 0 2 0v-1h1V7zM4.3 3h6.4l1.05 2.5h-8.5L4.3 3zM3 9a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm9 0a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M14 7.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M7.5 0a7.5 7.5 0 1 1 0 15 7.5 7.5 0 0 1 0-15zm0 1.667a5.833 5.833 0 1 0 0 11.666 5.833 5.833 0 0 0 0-11.666z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M2.64 1.27L7.5 6.13l4.84-4.84A.92.92 0 0 1 13 1a1 1 0 0 1 1 1 .9.9 0 0 1-.27.66L8.84 7.5l4.89 4.89A.9.9 0 0 1 14 13a1 1 0 0 1-1 1 .92.92 0 0 1-.69-.27L7.5 8.87l-4.85 4.85A.92.92 0 0 1 2 14a1 1 0 0 1-1-1 .9.9 0 0 1 .27-.66L6.16 7.5 1.27 2.61A.9.9 0 0 1 1 2a1 1 0 0 1 1-1c.24.003.47.1.64.27z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M2 13.748c0 .138.112.25.25.25h3.749v-3h3v3h3.749a.25.25 0 0 0 .25-.25v-5.75H2v5.75zm11.93-7.17l-.932-.82V2a1 1 0 1 0-2 0v2L7.681 1.09a.25.25 0 0 0-.353-.011l-.011.011-6.25 5.463a.25.25 0 0 0 .18.42L3 7h10.747a.25.25 0 0 0 .183-.421z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M6.65 2C5.43 2 4.48 3.38 4.11 3.82a.49.49 0 0 0-.11.32v4.4a.44.44 0 0 0 .72.36 3 3 0 0 1 1.93-1.17C8.06 7.73 8.6 9 10.07 9a5.28 5.28 0 0 0 2.73-1.09.49.49 0 0 0 .2-.4V2.45a.44.44 0 0 0-.62-.45 5.75 5.75 0 0 1-2.31 1.06C8.6 3.08 8.12 2 6.65 2zM2.5 3a1 1 0 1 1 0-2 1 1 0 0 1 0 2zM3 4v9.48a.5.5 0 0 1-1 0V4a.5.5 0 0 1 1 0z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M7.5 0C5.068 0 2.23 1.486 2.23 5.27c0 2.568 4.054 8.244 5.27 9.73 1.081-1.486 5.27-7.027 5.27-9.73C12.77 1.487 9.932 0 7.5 0z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path data-name="Layer 7" d="M7.5 14.941l-.4-.495c-.973-1.189-4.9-6.556-4.9-9.16A5.066 5.066 0 0 1 7.036 0q.222-.01.445 0a5.066 5.066 0 0 1 5.286 4.836q.01.225 0 .45c0 2.213-2.669 6.111-4.678 8.851zM7.481.986a4.077 4.077 0 0 0-4.3 4.3c0 1.832 2.759 6.038 4.286 8.034 1.25-1.71 4.315-5.989 4.315-8.034a4.077 4.077 0 0 0-4.3-4.3z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M7 1c-.6 0-1 .4-1 1v4H2c-.6 0-1 .4-1 1v1c0 .6.4 1 1 1h4v4c0 .6.4 1 1 1h1c.6 0 1-.4 1-1V9h4c.6 0 1-.4 1-1V7c0-.6-.4-1-1-1H9V2c0-.6-.4-1-1-1H7z" fill="#010101"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M13 14H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h11a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M12.7 2.3v10.4H2.3V2.3h10.4M13 1H2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M7.5 0l-2 5h-5l4 3.5-2 6 5-3.5 5 3.5-2-6 4-3.5h-5l-2-5z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M7.5 3.19l1.07 2.68.25.63h3l-2 1.75-.5.44.23.63 1 3.13-2.48-1.77-.57-.4-.57.4-2.52 1.77 1-3.13.21-.63-.5-.44-2-1.75h3l.25-.63L7.5 3.19M7.5.5l-2 5h-5l4 3.5-2 6 5-3.5 5 3.5-2-6 4-3.5h-5l-2-5z" fill="#010101"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M7.538 2c-.294 0-.488.177-.615.385l-5.846 9.538C1 12 1 12.153 1 12.308c0 .538.385.692.692.692h11.616c.384 0 .692-.154.692-.692 0-.154 0-.231-.077-.385l-5.77-9.538C8.029 2.177 7.789 2 7.539 2z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path d="M7.524 1.5a.77.77 0 0 0-.69.395l-5.5 9.87C1.022 12.307 1.395 13 2 13h11c.605 0 .978-.692.666-1.236l-5.5-9.869a.773.773 0 0 0-.642-.395zM7.5 3.9l4.127 7.47H3.373L7.5 3.9z"></path></svg>'},function(t,e,n){"use strict";t.exports=m;var r,i=n(77),a=n(79),o=n(83),u=(r="function"==typeof Symbol?function(t){return Symbol(t)}:function(t){return"_"+t})("max"),s=r("length"),c=r("lengthCalculator"),f=r("allowStale"),l=r("maxAge"),h=r("dispose"),d=r("noDisposeOnSet"),p=r("lruList"),v=r("cache");function y(){return 1}function m(t){if(!(this instanceof m))return new m(t);"number"==typeof t&&(t={max:t}),t||(t={});var e=this[u]=t.max;(!e||"number"!=typeof e||e<=0)&&(this[u]=1/0);var n=t.length||y;"function"!=typeof n&&(n=y),this[c]=n,this[f]=t.stale||!1,this[l]=t.maxAge||0,this[h]=t.dispose,this[d]=t.noDisposeOnSet||!1,this.reset()}function g(t,e,n,r){var i=n.value;_(t,i)&&(w(t,n),t[f]||(i=void 0)),i&&e.call(r,i.value,i.key,t)}function b(t,e,n){var r=t[v].get(e);if(r){var i=r.value;_(t,i)?(w(t,r),t[f]||(i=void 0)):n&&t[p].unshiftNode(r),i&&(i=i.value)}return i}function _(t,e){if(!e||!e.maxAge&&!t[l])return!1;var n=Date.now()-e.now;return e.maxAge?n>e.maxAge:t[l]&&n>t[l]}function x(t){if(t[s]>t[u])for(var e=t[p].tail;t[s]>t[u]&&null!==e;){var n=e.prev;w(t,e),e=n}}function w(t,e){if(e){var n=e.value;t[h]&&t[h](n.key,n.value),t[s]-=n.length,t[v].delete(n.key),t[p].removeNode(e)}}Object.defineProperty(m.prototype,"max",{set:function(t){(!t||"number"!=typeof t||t<=0)&&(t=1/0),this[u]=t,x(this)},get:function(){return this[u]},enumerable:!0}),Object.defineProperty(m.prototype,"allowStale",{set:function(t){this[f]=!!t},get:function(){return this[f]},enumerable:!0}),Object.defineProperty(m.prototype,"maxAge",{set:function(t){(!t||"number"!=typeof t||t<0)&&(t=0),this[l]=t,x(this)},get:function(){return this[l]},enumerable:!0}),Object.defineProperty(m.prototype,"lengthCalculator",{set:function(t){"function"!=typeof t&&(t=y),t!==this[c]&&(this[c]=t,this[s]=0,this[p].forEach(function(t){t.length=this[c](t.value,t.key),this[s]+=t.length},this)),x(this)},get:function(){return this[c]},enumerable:!0}),Object.defineProperty(m.prototype,"length",{get:function(){return this[s]},enumerable:!0}),Object.defineProperty(m.prototype,"itemCount",{get:function(){return this[p].length},enumerable:!0}),m.prototype.rforEach=function(t,e){e=e||this;for(var n=this[p].tail;null!==n;){var r=n.prev;g(this,t,n,e),n=r}},m.prototype.forEach=function(t,e){e=e||this;for(var n=this[p].head;null!==n;){var r=n.next;g(this,t,n,e),n=r}},m.prototype.keys=function(){return this[p].toArray().map(function(t){return t.key},this)},m.prototype.values=function(){return this[p].toArray().map(function(t){return t.value},this)},m.prototype.reset=function(){this[h]&&this[p]&&this[p].length&&this[p].forEach(function(t){this[h](t.key,t.value)},this),this[v]=new i,this[p]=new o,this[s]=0},m.prototype.dump=function(){return this[p].map(function(t){if(!_(this,t))return{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}},this).toArray().filter(function(t){return t})},m.prototype.dumpLru=function(){return this[p]},m.prototype.inspect=function(t,e){var n="LRUCache {",r=!1;this[f]&&(n+="\n  allowStale: true",r=!0);var i=this[u];i&&i!==1/0&&(r&&(n+=","),n+="\n  max: "+a.inspect(i,e),r=!0);var o=this[l];o&&(r&&(n+=","),n+="\n  maxAge: "+a.inspect(o,e),r=!0);var h=this[c];h&&h!==y&&(r&&(n+=","),n+="\n  length: "+a.inspect(this[s],e),r=!0);var d=!1;return this[p].forEach(function(t){d?n+=",\n  ":(r&&(n+=",\n"),d=!0,n+="\n  ");var i=a.inspect(t.key).split("\n").join("\n  "),u={value:t.value};t.maxAge!==o&&(u.maxAge=t.maxAge),h!==y&&(u.length=t.length),_(this,t)&&(u.stale=!0),u=a.inspect(u,e).split("\n").join("\n  "),n+=i+" => "+u}),(d||r)&&(n+="\n"),n+="}"},m.prototype.set=function(t,e,n){var r=(n=n||this[l])?Date.now():0,i=this[c](e,t);if(this[v].has(t)){if(i>this[u])return w(this,this[v].get(t)),!1;var a=this[v].get(t).value;return this[h]&&(this[d]||this[h](t,a.value)),a.now=r,a.maxAge=n,a.value=e,this[s]+=i-a.length,a.length=i,this.get(t),x(this),!0}var o=new function(t,e,n,r,i){this.key=t,this.value=e,this.length=n,this.now=r,this.maxAge=i||0}(t,e,i,r,n);return o.length>this[u]?(this[h]&&this[h](t,e),!1):(this[s]+=o.length,this[p].unshift(o),this[v].set(t,this[p].head),x(this),!0)},m.prototype.has=function(t){return!!this[v].has(t)&&!_(this,this[v].get(t).value)},m.prototype.get=function(t){return b(this,t,!0)},m.prototype.peek=function(t){return b(this,t,!1)},m.prototype.pop=function(){var t=this[p].tail;return t?(w(this,t),t.value):null},m.prototype.del=function(t){w(this,this[v].get(t))},m.prototype.load=function(t){this.reset();for(var e=Date.now(),n=t.length-1;n>=0;n--){var r=t[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{var a=i-e;a>0&&this.set(r.k,r.v,a)}}},m.prototype.prune=function(){var t=this;this[v].forEach(function(e,n){b(t,n,!1)})}},function(t,e,n){t.exports=function(){return n(84)('/*!\n * CARTO VL js https://carto.com/\n * Version: 0.9.0\n * \n */!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=39)}([function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function r(e){return t.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},r(e)}t.exports=r},function(t,e,r){var n=r(25),i=r(26),o=r(27);t.exports=function(t){return n(t)||i(t)||o()}},function(t,e,r){var n=r(36),i=r(37),o=r(38);t.exports=function(t,e){return n(t)||i(t,e)||o()}},function(t,e,r){var n=r(8),i=r(33);t.exports=function(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?i(t):e}},function(t,e,r){var n=r(10);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}},function(t,e,r){t.exports=r(28)},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}},function(t,e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(e){return"function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?t.exports=n=function(t){return r(t)}:t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":r(t)},n(e)}t.exports=n},function(t,e){function r(t,e,r,n,i,o,a){try{var u=t[o](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,i)}t.exports=function(t){return function(){var e=this,n=arguments;return new Promise(function(i,o){var a=t.apply(e,n);function u(t){r(a,i,o,u,s,"next",t)}function s(t){r(a,i,o,u,s,"throw",t)}u(void 0)})}}},function(t,e){function r(e,n){return t.exports=r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r(e,n)}t.exports=r},function(t,e,r){"use strict";var n=r(12);function i(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(o,this,e),this.length=this._features.length}function o(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(function(t){var e=null,r=t.readVarint()+t.pos;for(;t.pos<r;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(r))}t.exports=i,i.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new n(this._pbf,e,this.extent,this._keys,this._values)}},function(t,e,r){"use strict";var n=r(31);function i(t,e,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=i,t.readFields(o,this,e)}function o(t,e,r){1==t?e.id=r.readVarint():2==t?function(t,e){var r=t.readVarint()+t.pos;for(;t.pos<r;){var n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}function a(t){for(var e,r,n=0,i=0,o=t.length,a=o-1;i<o;a=i++)e=t[i],n+=((r=t[a]).x-e.x)*(e.y+r.y);return n}t.exports=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,i=1,o=0,a=0,u=0,s=[];t.pos<r;){if(o<=0){var c=t.readVarint();i=7&c,o=c>>3}if(o--,1===i||2===i)a+=t.readSVarint(),u+=t.readSVarint(),1===i&&(e&&s.push(e),e=[]),e.push(new n(a,u));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&s.push(e),s},i.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,o=0,a=1/0,u=-1/0,s=1/0,c=-1/0;t.pos<e;){if(n<=0){var f=t.readVarint();r=7&f,n=f>>3}if(n--,1===r||2===r)i+=t.readSVarint(),o+=t.readSVarint(),i<a&&(a=i),i>u&&(u=i),o<s&&(s=o),o>c&&(c=o);else if(7!==r)throw new Error("unknown command "+r)}return[a,s,u,c]},i.prototype.toGeoJSON=function(t,e,r){var n,o,u=this.extent*Math.pow(2,r),s=this.extent*t,c=this.extent*e,f=this.loadGeometry(),h=i.types[this.type];function l(t){for(var e=0;e<t.length;e++){var r=t[e],n=180-360*(r.y+c)/u;t[e]=[360*(r.x+s)/u-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(n=0;n<f.length;n++)p[n]=f[n][0];l(f=p);break;case 2:for(n=0;n<f.length;n++)l(f[n]);break;case 3:for(f=function(t){var e=t.length;if(e<=1)return[t];for(var r,n,i=[],o=0;o<e;o++){var u=a(t[o]);0!==u&&(void 0===n&&(n=u<0),n===u<0?(r&&i.push(r),r=[t[o]]):r.push(t[o]))}r&&i.push(r);return i}(f),n=0;n<f.length;n++)for(o=0;o<f[n].length;o++)l(f[n][o])}1===f.length?f=f[0]:h="Multi"+h;var y={type:"Feature",geometry:{type:h,coordinates:f},properties:this.properties};return"id"in this&&(y.id=this.id),y}},function(t,e,r){t.exports.VectorTile=r(30),t.exports.VectorTileFeature=r(12),t.exports.VectorTileLayer=r(11)},function(t,e,r){"use strict";t.exports=i;var n=r(32);function i(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;function o(t){return t.type===i.Bytes?t.readVarint()+t.pos:t.pos+1}function a(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function u(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=t;i--)r.buf[i+n]=r.buf[i]}function s(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function c(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function f(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function h(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function l(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function p(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function y(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function d(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function v(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function x(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function g(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function m(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,t(i,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=x(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=m(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=x(this.buf,this.pos)+4294967296*x(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=x(this.buf,this.pos)+4294967296*m(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,n=this.buf;return e=127&(r=n[this.pos++]),r<128?e:(e|=(127&(r=n[this.pos++]))<<7,r<128?e:(e|=(127&(r=n[this.pos++]))<<14,r<128?e:(e|=(127&(r=n[this.pos++]))<<21,r<128?e:function(t,e,r){var n,i,o=r.buf;if(i=o[r.pos++],n=(112&i)>>4,i<128)return a(t,n,e);if(i=o[r.pos++],n|=(127&i)<<3,i<128)return a(t,n,e);if(i=o[r.pos++],n|=(127&i)<<10,i<128)return a(t,n,e);if(i=o[r.pos++],n|=(127&i)<<17,i<128)return a(t,n,e);if(i=o[r.pos++],n|=(127&i)<<24,i<128)return a(t,n,e);if(i=o[r.pos++],n|=(1&i)<<31,i<128)return a(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,r){var n="",i=e;for(;i<r;){var o,a,u,s=t[i],c=null,f=s>239?4:s>223?3:s>191?2:1;if(i+f>r)break;1===f?s<128&&(c=s):2===f?128==(192&(o=t[i+1]))&&(c=(31&s)<<6|63&o)<=127&&(c=null):3===f?(o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&((c=(15&s)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===f&&(o=t[i+1],a=t[i+2],u=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&u)&&((c=(15&s)<<18|(63&o)<<12|(63&a)<<6|63&u)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,f=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),i+=f}return n}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var r=o(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),g(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),g(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),g(this.buf,-1&t,this.pos),g(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),g(this.buf,-1&t,this.pos),g(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var r,n;t>=0?(r=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,n=n+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn\'t fit into 10 bytes");e.realloc(10),function(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos]=127&t}(r,0,e),function(t,e){var r=(7&t)<<4;if(e.buf[e.pos++]|=r|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var n,i,o=0;o<e.length;o++){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){n>56319||o+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):i=n;continue}if(n<56320){t[r++]=239,t[r++]=191,t[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(t[r++]=239,t[r++]=191,t[r++]=189,i=null);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(n<65536?t[r++]=n>>12|224:(t[r++]=n>>18|240,t[r++]=n>>12&63|128),t[r++]=n>>6&63|128),t[r++]=63&n|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&u(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),n.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),n.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&u(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,r){this.writeTag(t,i.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){this.writeMessage(t,s,e)},writePackedSVarint:function(t,e){this.writeMessage(t,c,e)},writePackedBoolean:function(t,e){this.writeMessage(t,l,e)},writePackedFloat:function(t,e){this.writeMessage(t,f,e)},writePackedDouble:function(t,e){this.writeMessage(t,h,e)},writePackedFixed32:function(t,e){this.writeMessage(t,p,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,y,e)},writePackedFixed64:function(t,e){this.writeMessage(t,d,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,v,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},function(t,e,r){var n=r(1),i=r(10),o=r(34),a=r(35);function u(e){var r="function"==typeof Map?new Map:void 0;return t.exports=u=function(t){if(null===t||!o(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return a(t,arguments,n(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),i(e,t)},u(e)}t.exports=u},function(t,e,r){"use strict";function n(t,e,r){r=r||2;var n,u,s,c,f,p,d,v=e&&e.length,x=v?e[0]*r:t.length,g=i(t,0,x,r,!0),m=[];if(!g)return m;if(v&&(g=function(t,e,r,n){var a,u,s,c,f,p=[];for(a=0,u=e.length;a<u;a++)s=e[a]*n,c=a<u-1?e[a+1]*n:t.length,(f=i(t,s,c,n,!1))===f.next&&(f.steiner=!0),p.push(y(f));for(p.sort(h),a=0;a<p.length;a++)l(p[a],r),r=o(r,r.next);return r}(t,e,g,r)),t.length>80*r){n=s=t[0],u=c=t[1];for(var w=r;w<x;w+=r)f=t[w],p=t[w+1],f<n&&(n=f),p<u&&(u=p),f>s&&(s=f),p>c&&(c=p);d=0!==(d=Math.max(s-n,c-u))?1/d:0}return a(g,m,r,n,u,d),m}function i(t,e,r,n,i){var o,a;if(i===T(t,e,r,n)>0)for(o=e;o<r;o+=n)a=M(o,t[o],t[o+1],a);else for(o=r-n;o>=e;o-=n)a=M(o,t[o],t[o+1],a);return a&&g(a,a.next)&&(_(a),a=a.next),a}function o(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!g(n,n.next)&&0!==x(n.prev,n,n.next))n=n.next;else{if(_(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function a(t,e,r,n,i,h,l){if(t){!l&&h&&function(t,e,r,n){var i=t;do{null===i.z&&(i.z=p(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,r,n,i,o,a,u,s,c=1;do{for(r=t,t=null,o=null,a=0;r;){for(a++,n=r,u=0,e=0;e<c&&(u++,n=n.nextZ);e++);for(s=c;u>0||s>0&&n;)0!==u&&(0===s||!n||r.z<=n.z)?(i=r,r=r.nextZ,u--):(i=n,n=n.nextZ,s--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,c*=2}while(a>1)}(i)}(t,n,i,h);for(var y,d,v=t;t.prev!==t.next;)if(y=t.prev,d=t.next,h?s(t,n,i,h):u(t))e.push(y.i/r),e.push(t.i/r),e.push(d.i/r),_(t),t=d.next,v=d.next;else if((t=d)===v){l?1===l?a(t=c(t,e,r),e,r,n,i,h,2):2===l&&f(t,e,r,n,i,h):a(o(t),e,r,n,i,h,1);break}}}function u(t){var e=t.prev,r=t,n=t.next;if(x(e,r,n)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(d(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&x(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function s(t,e,r,n){var i=t.prev,o=t,a=t.next;if(x(i,o,a)>=0)return!1;for(var u=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,s=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,f=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=p(u,s,e,r,n),l=p(c,f,e,r,n),y=t.prevZ,v=t.nextZ;y&&y.z>=h&&v&&v.z<=l;){if(y!==t.prev&&y!==t.next&&d(i.x,i.y,o.x,o.y,a.x,a.y,y.x,y.y)&&x(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,v!==t.prev&&v!==t.next&&d(i.x,i.y,o.x,o.y,a.x,a.y,v.x,v.y)&&x(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;y&&y.z>=h;){if(y!==t.prev&&y!==t.next&&d(i.x,i.y,o.x,o.y,a.x,a.y,y.x,y.y)&&x(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;v&&v.z<=l;){if(v!==t.prev&&v!==t.next&&d(i.x,i.y,o.x,o.y,a.x,a.y,v.x,v.y)&&x(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function c(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!g(i,o)&&m(i,n,n.next,o)&&w(i,o)&&w(o,i)&&(e.push(i.i/r),e.push(n.i/r),e.push(o.i/r),_(n),_(n.next),n=t=o),n=n.next}while(n!==t);return n}function f(t,e,r,n,i,u){var s=t;do{for(var c=s.next.next;c!==s.prev;){if(s.i!==c.i&&v(s,c)){var f=b(s,c);return s=o(s,s.next),f=o(f,f.next),a(s,e,r,n,i,u),void a(f,e,r,n,i,u)}c=c.next}s=s.next}while(s!==t)}function h(t,e){return t.x-e.x}function l(t,e){if(e=function(t,e){var r,n=e,i=t.x,o=t.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var u=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=i&&u>a){if(a=u,u===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(i===a)return r.prev;var s,c=r,f=r.x,h=r.y,l=1/0;n=r.next;for(;n!==c;)i>=n.x&&n.x>=f&&i!==n.x&&d(o<h?i:a,o,f,h,o<h?a:i,o,n.x,n.y)&&((s=Math.abs(o-n.y)/(i-n.x))<l||s===l&&n.x>r.x)&&w(n,t)&&(r=n,l=s),n=n.next;return r}(t,e)){var r=b(e,t);o(r,r.next)}}function p(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function y(t){var e=t,r=t;do{e.x<r.x&&(r=e),e=e.next}while(e!==t);return r}function d(t,e,r,n,i,o,a,u){return(i-a)*(e-u)-(t-a)*(o-u)>=0&&(t-a)*(n-u)-(r-a)*(e-u)>=0&&(r-a)*(o-u)-(i-a)*(n-u)>=0}function v(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&m(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&w(t,e)&&w(e,t)&&function(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)}function x(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function g(t,e){return t.x===e.x&&t.y===e.y}function m(t,e,r,n){return!!(g(t,e)&&g(r,n)||g(t,n)&&g(r,e))||x(t,e,r)>0!=x(t,e,n)>0&&x(r,n,t)>0!=x(r,n,e)>0}function w(t,e){return x(t.prev,t,t.next)<0?x(t,e,t.next)>=0&&x(t,t.prev,e)>=0:x(t,e,t.prev)<0||x(t,t.next,e)<0}function b(t,e){var r=new F(t.i,t.x,t.y),n=new F(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function M(t,e,r,n){var i=new F(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function _(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,r,n){for(var i=0,o=e,a=r-n;o<r;o+=n)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}t.exports=n,t.exports.default=n,n.deviation=function(t,e,r,n){var i=e&&e.length,o=i?e[0]*r:t.length,a=Math.abs(T(t,0,o,r));if(i)for(var u=0,s=e.length;u<s;u++){var c=e[u]*r,f=u<s-1?e[u+1]*r:t.length;a-=Math.abs(T(t,c,f,r))}var h=0;for(u=0;u<n.length;u+=3){var l=n[u]*r,p=n[u+1]*r,y=n[u+2]*r;h+=Math.abs((t[l]-t[y])*(t[p+1]-t[l+1])-(t[l]-t[p])*(t[y+1]-t[l+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},n.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[i][o][a]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r}},,,,,,,,,function(t,e){t.exports=function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}},function(t,e){t.exports=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,e,r){var n=function(){return this||"object"==typeof self&&self}()||Function("return this")(),i=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,o=i&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,t.exports=r(29),i)n.regeneratorRuntime=o;else try{delete n.regeneratorRuntime}catch(t){n.regeneratorRuntime=void 0}},function(t,e){!function(e){"use strict";var r,n=Object.prototype,i=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag",c="object"==typeof t,f=e.regeneratorRuntime;if(f)c&&(t.exports=f);else{(f=e.regeneratorRuntime=c?t.exports:{}).wrap=w;var h="suspendedStart",l="suspendedYield",p="executing",y="completed",d={},v={};v[a]=function(){return this};var x=Object.getPrototypeOf,g=x&&x(x(E([])));g&&g!==n&&i.call(g,a)&&(v=g);var m=F.prototype=M.prototype=Object.create(v);_.prototype=m.constructor=F,F.constructor=_,F[s]=_.displayName="GeneratorFunction",f.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},f.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,F):(t.__proto__=F,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(m),t},f.awrap=function(t){return{__await:t}},T(V.prototype),V.prototype[u]=function(){return this},f.AsyncIterator=V,f.async=function(t,e,r,n){var i=new V(w(t,e,r,n));return f.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},T(m),m[s]="Generator",m[a]=function(){return this},m.toString=function(){return"[object Generator]"},f.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},f.values=E,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(P),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return u.type="throw",u.arg=t,e.next=n,i&&(e.method="next",e.arg=r),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),d}}}function w(t,e,r,n){var i=e&&e.prototype instanceof M?e:M,o=Object.create(i.prototype),a=new A(n||[]);return o._invoke=function(t,e,r){var n=h;return function(i,o){if(n===p)throw new Error("Generator is already running");if(n===y){if("throw"===i)throw o;return N()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var u=S(a,r);if(u){if(u===d)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var s=b(t,e,r);if("normal"===s.type){if(n=r.done?y:l,s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n=y,r.method="throw",r.arg=s.arg)}}}(t,r,a),o}function b(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}function M(){}function _(){}function F(){}function T(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function V(t){var e;this._invoke=function(r,n){function o(){return new Promise(function(e,o){!function e(r,n,o,a){var u=b(t[r],t,n);if("throw"!==u.type){var s=u.arg,c=s.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then(function(t){e("next",t,o,a)},function(t){e("throw",t,o,a)}):Promise.resolve(c).then(function(t){s.value=t,o(s)},function(t){return e("throw",t,o,a)})}a(u.arg)}(r,n,e,o)})}return e=e?e.then(o,o):o()}}function S(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,S(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a \'throw\' method")}return d}var i=b(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function E(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(i.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=r,e.done=!0,e};return o.next=o}}return{next:N}}function N(){return{value:r,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(t,e,r){"use strict";var n=r(11);function i(t,e,r){if(3===t){var i=new n(r,r.readVarint()+r.pos);i.length&&(e[i.name]=i)}}t.exports=function(t,e){this.layers=t.readFields(i,{},e)}},function(t,e,r){"use strict";function n(t,e){this.x=t,this.y=e}t.exports=n,n.prototype={clone:function(){return new n(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,i=r*this.x+e*this.y;return this.x=n,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),i=e.x+r*(this.x-e.x)-n*(this.y-e.y),o=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(t){return t instanceof n?t:Array.isArray(t)?new n(t[0],t[1]):t}},function(t,e){e.read=function(t,e,r,n,i){var o,a,u=8*i-n-1,s=(1<<u)-1,c=s>>1,f=-7,h=r?i-1:0,l=r?-1:1,p=t[e+h];for(h+=l,o=p&(1<<-f)-1,p>>=-f,f+=u;f>0;o=256*o+t[e+h],h+=l,f-=8);for(a=o&(1<<-f)-1,o>>=-f,f+=n;f>0;a=256*a+t[e+h],h+=l,f-=8);if(0===o)o=1-c;else{if(o===s)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=c}return(p?-1:1)*a*Math.pow(2,o-n)},e.write=function(t,e,r,n,i,o){var a,u,s,c=8*o-i-1,f=(1<<c)-1,h=f>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,y=n?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,a=f):(a=Math.floor(Math.log(e)/Math.LN2),e*(s=Math.pow(2,-a))<1&&(a--,s*=2),(e+=a+h>=1?l/s:l*Math.pow(2,1-h))*s>=2&&(a++,s/=2),a+h>=f?(u=0,a=f):a+h>=1?(u=(e*s-1)*Math.pow(2,i),a+=h):(u=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[r+p]=255&u,p+=y,u/=256,i-=8);for(a=a<<i|u,c+=i;c>0;t[r+p]=255&a,p+=y,a/=256,c-=8);t[r+p-y]|=128*d}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return t}},function(t,e){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}},function(t,e,r){var n=r(10);function i(e,r,o){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?t.exports=i=function(t,e,r){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return r&&n(o,r.prototype),o}:t.exports=i=Reflect.construct,i.apply(null,arguments)}t.exports=i},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==u.return||u.return()}finally{if(i)throw o}}return r}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e,r){"use strict";r.r(e);var n={};r.r(n),r.d(n,"create",function(){return F}),r.d(n,"clone",function(){return T}),r.d(n,"fromValues",function(){return V}),r.d(n,"copy",function(){return S}),r.d(n,"set",function(){return k}),r.d(n,"add",function(){return P}),r.d(n,"subtract",function(){return A}),r.d(n,"multiply",function(){return E}),r.d(n,"divide",function(){return N}),r.d(n,"ceil",function(){return O}),r.d(n,"floor",function(){return I}),r.d(n,"min",function(){return B}),r.d(n,"max",function(){return L}),r.d(n,"round",function(){return j}),r.d(n,"scale",function(){return D}),r.d(n,"scaleAndAdd",function(){return Z}),r.d(n,"distance",function(){return G}),r.d(n,"squaredDistance",function(){return C}),r.d(n,"length",function(){return R}),r.d(n,"squaredLength",function(){return q}),r.d(n,"negate",function(){return z}),r.d(n,"inverse",function(){return U}),r.d(n,"normalize",function(){return W}),r.d(n,"dot",function(){return Y}),r.d(n,"lerp",function(){return J}),r.d(n,"random",function(){return K}),r.d(n,"transformMat4",function(){return Q}),r.d(n,"transformQuat",function(){return H}),r.d(n,"str",function(){return X}),r.d(n,"exactEquals",function(){return $}),r.d(n,"equals",function(){return tt}),r.d(n,"sub",function(){return et}),r.d(n,"mul",function(){return rt}),r.d(n,"div",function(){return nt}),r.d(n,"dist",function(){return it}),r.d(n,"sqrDist",function(){return ot}),r.d(n,"len",function(){return at}),r.d(n,"sqrLen",function(){return ut}),r.d(n,"forEach",function(){return st});var i=r(8),o=r.n(i),a=r(2),u=r.n(a),s=r(6),c=r.n(s),f=r(9),h=r.n(f),l=r(0),p=r.n(l),y=r(7),d=r.n(y),v=r(13),x=r(14),g=r(3),m=r.n(g);function w(t,e,r){return{center:{x:(t+.5)/Math.pow(2,r)*2-1,y:2*(1-(e+.5)/Math.pow(2,r))-1},scale:1/Math.pow(2,r)}}var b=1e-6,M="undefined"!=typeof Float32Array?Float32Array:Array,_=Math.random;Math.PI;function F(){var t=new M(4);return M!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function T(t){var e=new M(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function V(t,e,r,n){var i=new M(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function S(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function k(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function P(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function A(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function E(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function N(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function O(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function I(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function B(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function L(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function j(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function D(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function Z(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function G(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+n*n+i*i+o*o)}function C(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+i*i+o*o}function R(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.sqrt(e*e+r*r+n*n+i*i)}function q(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function z(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function U(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function W(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=o*a),t}function Y(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function J(t,e,r,n){var i=e[0],o=e[1],a=e[2],u=e[3];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=a+n*(r[2]-a),t[3]=u+n*(r[3]-u),t}function K(t,e){var r,n,i,o,a,u;e=e||1;do{a=(r=2*_()-1)*r+(n=2*_()-1)*n}while(a>=1);do{u=(i=2*_()-1)*i+(o=2*_()-1)*o}while(u>=1);var s=Math.sqrt((1-a)/u);return t[0]=e*r,t[1]=e*n,t[2]=e*i*s,t[3]=e*o*s,t}function Q(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,t}function H(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],u=r[1],s=r[2],c=r[3],f=c*n+u*o-s*i,h=c*i+s*n-a*o,l=c*o+a*i-u*n,p=-a*n-u*i-s*o;return t[0]=f*c+p*-a+h*-s-l*-u,t[1]=h*c+p*-u+l*-a-f*-s,t[2]=l*c+p*-s+f*-u-h*-a,t[3]=e[3],t}function X(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function $(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function tt(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=e[0],u=e[1],s=e[2],c=e[3];return Math.abs(r-a)<=b*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-u)<=b*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-s)<=b*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-c)<=b*Math.max(1,Math.abs(o),Math.abs(c))}var et=A,rt=E,nt=N,it=G,ot=C,at=R,ut=q,st=function(){var t=F();return function(e,r,n,i,o,a){var u=void 0,s=void 0;for(r||(r=4),n||(n=0),s=i?Math.min(i*r+n,e.length):e.length,u=n;u<s;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}();function ct(t,e){var r=m()(t,2),n=r[0],i=r[1],o=m()(e,2);return[n-o[0],i-o[1]]}function ft(t,e){var r=m()(t,2),n=r[0],i=r[1],o=m()(e,2);return n*o[0]+i*o[1]}function ht(t){var e=m()(t,2),r=e[0];return[-e[1],r]}function lt(t,e){var r=function(t,e){var r=Math.hypot(t,e);return[t/r,e/r]}(t[0]-e[0],t[1]-e[1]);return[-r[1],r[0]]}function pt(t,e){var r=[t[1],-t[0]],n=[-e[1],e[0]],i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[0]+n[1]*r[1],a=Math.abs(i);return{turnLeft:i>0,joinNormal:!(a<.866&&o>.5)&&yt([(r[0]+n[0])/a,(r[1]+n[1])/a])}}function yt(t){return[-t[0],-t[1]]}function dt(t,e,r){return(t.x-r.x)*(e.y-r.y)-(e.x-r.x)*(t.y-r.y)}function vt(t,e){return t.x===e.x&&t.y===e.y}function xt(t,e,r){switch(r){case"line":return function(t,e){for(var r=t,n=t.length,i=0;i<n;i+=2)e.minx=Math.min(e.minx,r[i+0]),e.miny=Math.min(e.miny,r[i+1]),e.maxx=Math.max(e.maxx,r[i+0]),e.maxy=Math.max(e.maxy,r[i+1]);return e}(t,e);case"polygon":return function(t,e){for(var r=[t.flat,t.holes[0]||t.flat.length/2],n=r[0],i=r[1],o=0;o<i;o++)e.minx=Math.min(e.minx,n[2*o+0]),e.miny=Math.min(e.miny,n[2*o+1]),e.maxx=Math.max(e.maxx,n[2*o+0]),e.maxy=Math.max(e.maxy,n[2*o+1]);return e}(t,e)}}var gt={intersect:function(t,e,r,n){var i=t,o=r,a=ct(e,t),u=ct(n,r),s=ht(a),c=ht(u),f=ft(ct(o,i),c)/ft(a,c),h=ft(ct(i,o),s)/ft(u,s);if(f>=0&&f<=1&&h>=0&&h<=1)return[i[0]+f*a[0],i[1]+f*a[1]]},sub:ct,dot:ft,perpendicular:ht,getLineNormal:lt,getJoinNormal:pt,neg:yt,halfPlaneSign:dt,pointInTriangle:function(t,e,r,n){if(vt(e,r)||vt(r,n)||vt(n,e))return!1;var i=dt(t,e,r)<0,o=dt(t,r,n)<0,a=dt(t,n,e)<0;return i===o&&o===a},equalPoints:vt,pointInCircle:function(t,e,r){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i<=r*r},pointInRectangle:function(t,e){if(null===e)return!1;var r=t.x.toFixed(2),n=t.y.toFixed(2);return e.minx<=r&&r<=e.maxx&&e.miny<=n&&n<=e.maxy}},mt=function t(){p()(this,t),this.flat=[],this.holes=[],this.clipped=[],this.clippedType=[]};function wt(t,e){var r=[];return t.map(function(t){var n=[];t.map(function(t){n.push([2*t.x/e-1,2*(1-t.y/e)-1])}),r.push.apply(r,u()(function(t){var e=[],r=[];function n(t){for(var e=0,r=0;r<_t;r++)e|=Mt[r].inside(t)?0:1<<r;return e}function i(t,e,r){for(var i=0;i<_t;i++){var o=1<<i;if(r&o){var a=Mt[i].intersect(t,e);return r=n(a)&~o,[a,r]}}}for(var o=t[0],a=n(o),s=1;s<t.length;++s){for(var c=t[s],f=n(c),h=f,l=c;;){if(!(a|f)){var p,y;if((p=e).push.apply(p,u()(o)),f!==h)(y=e).push.apply(y,u()(c)),s<t.length-1&&(r.push(e),e=[]);else if(s===t.length-1){var d;(d=e).push.apply(d,u()(c))}break}if(a&f)break;if(a){var v=i(o,c,a),x=m()(v,2);o=x[0],a=x[1]}else{var g=i(o,c,f),w=m()(g,2);c=w[0],f=w[1]}}o=l,a=h}(e=function(t){for(var e,r,n=[],i=0;i<t.length;i+=2){var o=t[i],a=t[i+1];o===e&&a===r||(n.push(o,a),e=o,r=a)}return n}(e)).length>0&&r.push(e);return r}(n)))}),r}function bt(t,e){var r,n=null,i=[];return t.forEach(function(t){var o=function(t){for(var e=0,r=0;r<t.length;r++){var n=(r+1)%t.length;e+=t[r].x*t[n].y,e-=t[n].x*t[r].y}return e/2}(t);if(0!==o){void 0===r&&(r=o>0);var a=r?o>0:o<0,u=function(t,e){return t.map(function(t){var r=t.x,n=t.y;return[r=2*r/e-1,n=2*(1-n/e)-1]})}(t,e);a&&(n&&i.push(n),n=new mt),n=function(t,e,r){for(var n={},i=function(e){for(var r=[],i={},o=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,o=0;e>=0&&(o=n[e]||0),r>=0&&(o|=1<<r),o&&(i[t]=o)},a=0;a<t.length-1;a++){var u=t[a],s=t[a+1],c=Mt[e].inside(u),f=Mt[e].inside(s);if(c&&f)o(r.length,a+1),r.push(s);else if(c){var h=Mt[e].intersect(u,s);o(r.length,a+1,e),r.push(h)}else if(f){var l=Mt[e].intersect(u,s);o(r.length,a,e),r.push(l),o(r.length,a+1),r.push(s)}}r.length&&(i[0]&&(i[r.length]=i[0]),r.push(r[0])),t=r,n=i},o=0;o<_t;o++)i(o);t.length>=4&&(r&&e.holes.push(e.flat.length/2),t.forEach(function(t){e.flat.push(t[0],t[1])}),Object.keys(n).forEach(function(t){e.clipped.push(2*Number(t)),e.clippedType.push(n[t])}));return e}(u,n,!a)}}),n&&i.push(n),i}var Mt=[{inside:function(t){return t[0]<=1},intersect:function(t,e){return gt.intersect(t,e,[1,-100],[1,100])}},{inside:function(t){return t[1]<=1},intersect:function(t,e){return gt.intersect(t,e,[-100,1],[100,1])}},{inside:function(t){return t[0]>=-1},intersect:function(t,e){return gt.intersect(t,e,[-1,-100],[-1,100])}},{inside:function(t){return t[1]>=-1},intersect:function(t,e){return gt.intersect(t,e,[-100,-1],[100,-1])}}],_t=Mt.length;var Ft=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{properties:{}},n=r.properties,i=r.featureCount,o=r.sample,a=r.geomType,u=r.isAggregated,s=r.idProperty;p()(this,t),this.properties=n,this.featureCount=i,this.sample=o,this.geomType=a,this.isAggregated=u,this.idProperty=s||"cartodb_id",this.categoryToID=new Map,this.IDToCategory=new Map,this.numCategories=0,Object.values(n).map(function(t){t.categories=t.categories||[],t.categories.map(function(r){return e.categorizeString(t,r.name,!0)})}),this.propertyKeys=Object.keys(this.properties)}return d()(t,[{key:"categorizeString",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return void 0===e&&(e=null),this.categoryToID.has(e)?this.categoryToID.get(e):(r||this.properties[t].categories.push({name:e,frequency:Number.NaN}),this.categoryToID.set(e,this.numCategories),this.IDToCategory.set(this.numCategories,e),this.numCategories++,this.numCategories-1)}},{key:"propertyNames",value:function(t){var e=this.properties[t];return e.aggregations?Object.keys(e.aggregations).map(function(t){return e.aggregations[t]}):[t]}}]),t}();function Tt(t,e,r,n,i){var o,a,u,s,c,f;if(t.length>=4){if(s=lt(o=[t[0],t[1]],a=[t[2],t[3]]),o[0]===a[0]&&o[1]===a[1])return r;for(var h=4;h<=t.length;h+=2){if((f=!(i&&i(h)))&&(e.vertices[r]=o[0],e.normals[r++]=-s[0],e.vertices[r]=o[1],e.normals[r++]=-s[1],e.vertices[r]=o[0],e.normals[r++]=s[0],e.vertices[r]=o[1],e.normals[r++]=s[1],e.vertices[r]=a[0],e.normals[r++]=s[0],e.vertices[r]=a[1],e.normals[r++]=s[1],e.vertices[r]=o[0],e.normals[r++]=-s[0],e.vertices[r]=o[1],e.normals[r++]=-s[1],e.vertices[r]=a[0],e.normals[r++]=s[0],e.vertices[r]=a[1],e.normals[r++]=s[1],e.vertices[r]=a[0],e.normals[r++]=-s[0],e.vertices[r]=a[1],e.normals[r++]=-s[1]),h<=t.length-2?u=[t[h],t[h+1]]:n&&(u=[t[2],t[3]]),u){if(u[0]===a[0]&&u[1]===a[1])return r;if(c=lt(a,u),f){var l=pt(s,c),p=l.turnLeft,y=l.joinNormal,d=p?s:yt(c),v=p?c:yt(s);e.vertices[r]=a[0],e.normals[r++]=0,e.vertices[r]=a[1],e.normals[r++]=n?1e-37:0,e.vertices[r]=a[0],e.normals[r++]=d[0],e.vertices[r]=a[1],e.normals[r++]=d[1],e.vertices[r]=a[0],e.normals[r++]=v[0],e.vertices[r]=a[1],e.normals[r++]=v[1],y&&(e.vertices[r]=a[0],e.normals[r++]=y[0],e.vertices[r]=a[1],e.normals[r++]=y[1],e.vertices[r]=a[0],e.normals[r++]=v[0],e.vertices[r]=a[1],e.normals[r++]=v[1],e.vertices[r]=a[0],e.normals[r++]=d[0],e.vertices[r]=a[1],e.normals[r++]=d[1])}}o=a,a=u,s=c,u=null}}return r}function Vt(t,e){var r=new Float32Array(e);return r.set(t),r}var St=24,kt=0,Pt={vertices:new Float32Array(1048576),normals:new Float32Array(1048576)};function At(t){var e=kt+t;if(e>Pt.vertices.length){var r=2*e;Pt.vertices=Vt(Pt.vertices,r),Pt.normals=Vt(Pt.normals,r)}}var Et=r(16),Nt=2,Ot=24,It=0,Bt={vertices:new Float32Array(2097152),normals:new Float32Array(2097152)};function Lt(t){var e=It+t;if(e>Bt.vertices.length){var r=2*e;Bt.vertices=Vt(Bt.vertices,r),Bt.normals=Vt(Bt.normals,r)}}function jt(t,e){Bt.vertices[It]=t[e],Bt.normals[It++]=0,Bt.vertices[It]=t[e+1],Bt.normals[It++]=0}function Dt(t,e,r){return!!(t.clipped.includes(e)&&t.clipped.includes(r)&&t.clippedType[t.clipped.indexOf(e)]&t.clippedType[t.clipped.indexOf(r)])}var Zt=r(4),Gt=r.n(Zt),Ct=r(1),Rt=r.n(Ct),qt=r(5),zt=r.n(qt),Ut=r(15),Wt=function(t){function e(t){var r;if(p()(this,e),!t||!t.message)throw Error("Invalid CartoError, a message is mandatory");return(r=Gt()(this,Rt()(e).call(this,t.message))).name="CartoError",r.originalError=t,r}return zt()(e,t),e}(r.n(Ut)()(Error)),Yt=function(t){function e(t){var r;return p()(this,e),(r=Gt()(this,Rt()(e).call(this,{message:t}))).name="CartoRuntimeError",r}return zt()(e,t),e}(Wt),Jt={NOT_SUPPORTED:"[Not supported]:",WEB_GL:"[WebGL]:",MVT:"[MVT]:"};function Kt(t,e){switch(t){case"point":return function(t){return{verticesArrayBuffer:t,vertices:new Float32Array(t),breakpoints:[]}}(e);case"line":return function(t){var e=[],r=new Map;kt=0;for(var n=0;n<t.length;n++){for(var i=t[n],o=0;o<i.length;o++)At(St*i[o].length),kt=Tt(i[o],Pt,kt);r.set(e.length,0===e.length?{start:0,end:kt}:{start:r.get(e.length-1).end,end:kt}),e.push(kt)}for(var a=new ArrayBuffer(4*kt),u=new ArrayBuffer(4*kt),s=new Float32Array(a),c=new Float32Array(u),f=0;f<kt;f++)s[f]=Pt.vertices[f],c[f]=Pt.normals[f];return{vertices:s,normals:c,verticesArrayBuffer:a,normalsArrayBuffer:u,featureIDToVertexIndex:r,breakpoints:e}}(e);case"polygon":return function(t){var e=[],r=new Map;It=0;for(var n=0;n<t.length;n++){for(var i=t[n],o=function(t){var e=i[t],r=Et(e.flat,e.holes);Lt(Nt*r.length+Ot*e.flat.length);for(var n=0;n<r.length;n++)jt(e.flat,2*r[n]);It=Tt(e.flat,Bt,It,!0,function(t){return e.holes.includes((t-2)/2)||Dt(e,t-4,t-2)})},a=0;a<i.length;a++)o(a);r.set(e.length,0===e.length?{start:0,end:It}:{start:r.get(e.length-1).end,end:It}),e.push(It)}for(var u=new ArrayBuffer(4*It),s=new ArrayBuffer(4*It),c=new Float32Array(u),f=new Float32Array(s),h=0;h<It;h++)c[h]=Bt.vertices[h],f[h]=Bt.normals[h];return{vertices:c,normals:f,verticesArrayBuffer:u,normalsArrayBuffer:s,featureIDToVertexIndex:r,breakpoints:e}}(e);default:throw new Yt("".concat(Jt.NOT_SUPPORTED," Unimplemented geometry type: \'").concat(t,"\'."))}}var Qt=function t(e){var r=e.center,n=e.scale,i=e.geom,o=e.properties,a=e.type,u=e.active,s=e.size,c=e.metadata;p()(this,t),this.active=u,this.center=r,this.properties=o,this.scale=n,this.type=a,this.decodedGeom=Kt(a,i),this.numVertex="point"===a?3*s:this.decodedGeom.vertices.length/2,this.numFeatures="point"===a?s:this.decodedGeom.breakpoints.length||this.numVertex,this.propertyTex=[],this.metadata=c,this.propertyCount=0,this._aabb=function(t,e){switch(e){case"point":return[];case"line":case"polygon":for(var r=[],n=0;n<t.length;n++){for(var i=t[n],o={minx:Number.POSITIVE_INFINITY,miny:Number.POSITIVE_INFINITY,maxx:Number.NEGATIVE_INFINITY,maxy:Number.NEGATIVE_INFINITY},a=0;a<i.length;a++)o=xt(i[a],o,e);o.minx===Number.POSITIVE_INFINITY&&(o=null),r.push(o)}return r}}(i,a),this.t1=[.1,.1,.1,.1],this.t2=[.1,.1,.1,.1],this.t3=[.1,.1,.1,.1],this.t4=[.1,.1,.1,.1]},Ht=function(t){function e(t){var r;return p()(this,e),(r=Gt()(this,Rt()(e).call(this,{message:t}))).name="CartoValidationError",r}return zt()(e,t),e}(Wt),Xt="[Missing required property]:",$t="[Property with an incorrect type]:",te=1,ee=2,re=3,ne="point",ie="line",oe="polygon",ae={1:ne,2:ie,3:oe},ue=function(){function t(){p()(this,t)}return d()(t,[{key:"onmessage",value:function(t){var e=this;this.processEvent(t).then(function(t){var r=[];t.dataframe.empty||(r.push(e._propertiesArrayBuffer),r.push(t.dataframe.decodedGeom.verticesArrayBuffer),t.dataframe.decodedGeom.normalsArrayBuffer&&r.push(t.dataframe.decodedGeom.normalsArrayBuffer)),postMessage(t,r)})}},{key:"processEvent",value:function(){var t=h()(c.a.mark(function t(e){var r,n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(r=e.data).metadata&&(Object.setPrototypeOf(r.metadata,Ft.prototype),this.metadata=r.metadata),t.next=4,this._requestDataframe(r.x,r.y,r.z,r.url,r.layerID,this.metadata);case 4:return n=t.sent,t.abrupt("return",{mID:r.mID,dataframe:n});case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"_requestDataframe",value:function(){var t=h()(c.a.mark(function t(e,r,n,i,o,a){var u,s;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(i);case 2:return u=t.sent,t.next=5,this.urlToDataframeTransformer(u,e,r,n,o,a);case 5:return s=t.sent,t.abrupt("return",s);case 7:case"end":return t.stop()}},t,this)}));return function(e,r,n,i,o,a){return t.apply(this,arguments)}}()},{key:"urlToDataframeTransformer",value:function(){var t=h()(c.a.mark(function t(e,r,n,i,o,a){var u,s,f,h,l,p,y,d,g,m;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u=4096,t.next=3,e.arrayBuffer();case 3:if(0!==(s=t.sent).byteLength&&"null"!==e){t.next=6;break}return t.abrupt("return",{empty:!0});case 6:if(f=new v.VectorTile(new x(s)),!(Object.keys(f.layers).length>1)||o){t.next=9;break}throw new Ht("".concat(Xt," LayerID parameter wasn\'t specified and the MVT tile contains multiple layers: ").concat(JSON.stringify(Object.keys(f.layers)),"."));case 9:if(h=f.layers[o||Object.keys(f.layers)[0]]){t.next=12;break}return t.abrupt("return",{empty:!0});case 12:return l=this._decodeMVTLayer(h,a,u),p=l.geometries,y=l.properties,d=l.numFeatures,g=w(r,n,i),m=this._generateDataFrame(g,p,y,d,a.geomType,a),t.abrupt("return",m);case 16:case"end":return t.stop()}},t,this)}));return function(e,r,n,i,o,a){return t.apply(this,arguments)}}()},{key:"_decodeMVTLayer",value:function(t,e,r){if(!t.length)return{properties:[],geometries:{},numFeatures:0};switch(e.geomType||(e.geomType=this._autoDiscoverType(t)),e.geomType){case ne:var n=new ArrayBuffer(2*t.length*3*4);return this._decode(t,e,r,n);case ie:return this._decode(t,e,r,[],wt);case oe:return this._decode(t,e,r,[],bt);default:throw new Ht("".concat($t," MVT: invalid geometry type \'").concat(e.geomType,"\'"))}}},{key:"_autoDiscoverType",value:function(t){var e=t.feature(0).type;switch(e){case te:return ne;case ee:return ie;case re:return oe;default:throw new Ht("".concat($t," MVT: invalid geometry type \'").concat(e,"\'"))}}},{key:"_decode",value:function(t,e,r,n,i){var o,a=0;n&&(o=new Float32Array(n));for(var u=this._initializePropertyArrays(e,t.length),s=u.properties,c=u.propertyNames,f=0;f<t.length;f++){var h=t.feature(f);this._checkType(h,e.geomType);var l=h.loadGeometry();if(i){var p=i(l,r);n.push(p)}else{var y=2*l[0][0].x/r-1,d=2*(1-l[0][0].y/r)-1;if(y<-1||y>=1||d<-1||d>=1)continue;o[6*a+0]=y,o[6*a+1]=d,o[6*a+2]=y,o[6*a+3]=d,o[6*a+4]=y,o[6*a+5]=d}if(void 0===h.properties[e.idProperty])throw new Yt("".concat(Jt.MVT," MVT feature with undefined idProperty \'").concat(e.idProperty,"\'"));this._decodeProperties(e,c,s,h,a),a++}return{properties:s,geometries:n,numFeatures:a}}},{key:"_checkType",value:function(t,e){var r=t.type,n=ae[r];if(n!==e)throw new Yt("".concat(Jt.MVT," MVT: mixed geometry types in the same layer. Layer has type: ").concat(e," but feature was ").concat(n))}},{key:"_initializePropertyArrays",value:function(t,e){var r=this._getPropertyNamesFrom(t);return{propertyNames:r,properties:this._getPropertiesFor(r,e)}}},{key:"_getPropertyNamesFrom",value:function(t){for(var e=[],r=0;r<t.propertyKeys.length;r++){var n=t.propertyKeys[r];"geometry"!==t.properties[n].type&&e.push.apply(e,u()(t.propertyNames(n)))}return e}},{key:"_getPropertiesFor",value:function(t,e){var r={},n=1024*Math.ceil(e/1024),i=new ArrayBuffer(4*n*t.length);this._propertiesArrayBuffer=i;for(var o=0;o<t.length;o++){r[t[o]]=new Float32Array(i,4*o*n,n)}return r}},{key:"_decodeProperties",value:function(t,e,r,n,i){for(var o=e.length,a=0;a<o;a++){var u=e[a],s=n.properties[u];r[u][i]=this.decodeProperty(t,u,s)}}},{key:"decodeProperty",value:function(t,e,r){var n=t.properties[e].type;if("string"==typeof r){if("category"!==n)throw new Yt("".concat(Jt.MVT," MVT decoding error. Metadata property \'").concat(e,"\' is of type \'").concat(n,"\' but the MVT tile contained a feature property of type \'string\': \'").concat(r,"\'"));return t.categorizeString(e,r)}if(null===r||void 0===r||Number.isNaN(r))return Number.MIN_SAFE_INTEGER;if("number"==typeof r){if("number"!==n)throw new Yt("".concat(Jt.MVT," MVT decoding error. Metadata property \'").concat(e,"\' is of type \'").concat(n,"\' but the MVT tile contained a feature property of type \'number\': \'").concat(r,"\'"));return r}throw new Yt("".concat(Jt.MVT," MVT decoding error. Feature property value of type \'").concat(o()(r),"\' cannot be decoded."))}},{key:"_generateDataFrame",value:function(t,e,r,n,i,o){return new Qt({active:!1,center:t.center,geom:e,properties:r,scale:t.scale,size:n,type:i,metadata:o})}}]),t}();var se=new RegExp("^_cdb_agg_[a-zA-Z0-9]+_"),ce={isAggregated:function(t){return t.startsWith("_cdb_agg_")},getBase:function(t){return t.replace(se,"")},getAggFN:function(t){var e=t.substr("_cdb_agg_".length);return e.substr(0,e.indexOf("_"))},aggColumn:function(t,e){return"".concat("_cdb_agg_").concat(e,"_").concat(t)}},fe=function(t){function e(t){var r;return p()(this,e),(r=Gt()(this,Rt()(e).call(this,{message:t}))).name="CartoMapsAPIError",r}return zt()(e,t),e}(Wt),he="[Not supported]:",le=function(t){function e(){return p()(this,e),Gt()(this,Rt()(e).apply(this,arguments))}return zt()(e,t),d()(e,[{key:"decodeProperty",value:function(t,e,r){var n=ce.getBase(e),i=t.properties[n];if(i)switch(i.type){case"date":return function(t,e){var r=new Date;r.setTime(1e3*e);var n=t.min,i=t.max;return(r-n)/(i.getTime()-n.getTime())}(i,r);case"category":return t.categorizeString(n,r);case"number":return r;default:throw new fe("".concat(he," Windshaft MVT decoding error. Feature property value of type \'").concat(o()(r),"\' cannot be decoded."))}}}]),e}(ue);const pe={MVT:new ue,windshaft:new le};onmessage=function(t){return pe[t.data.workerName].onmessage(t)}}]);',"/dist/9e60f06212986eb61cfe.worker.js")}},function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,u,s,c,f,d,v,y=e&&e.length,m=y?e[0]*n:t.length,g=i(t,0,m,n,!0),b=[];if(!g)return b;if(y&&(g=function(t,e,n,r){var o,u,s,c,f,d=[];for(o=0,u=e.length;o<u;o++)s=e[o]*r,c=o<u-1?e[o+1]*r:t.length,(f=i(t,s,c,r,!1))===f.next&&(f.steiner=!0),d.push(p(f));for(d.sort(l),o=0;o<d.length;o++)h(d[o],n),n=a(n,n.next);return n}(t,e,g,n)),t.length>80*n){r=s=t[0],u=c=t[1];for(var _=n;_<m;_+=n)f=t[_],d=t[_+1],f<r&&(r=f),d<u&&(u=d),f>s&&(s=f),d>c&&(c=d);v=0!==(v=Math.max(s-r,c-u))?1/v:0}return o(g,b,n,r,u,v),b}function i(t,e,n,r,i){var a,o;if(i===k(t,e,n,r)>0)for(a=e;a<n;a+=r)o=w(a,t[a],t[a+1],o);else for(a=n-r;a>=e;a-=r)o=w(a,t[a],t[a+1],o);return o&&g(o,o.next)&&(T(o),o=o.next),o}function a(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!g(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(T(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function o(t,e,n,r,i,l,h){if(t){!h&&l&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=d(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,a,o,u,s,c=1;do{for(n=t,t=null,a=null,o=0;n;){for(o++,r=n,u=0,e=0;e<c&&(u++,r=r.nextZ);e++);for(s=c;u>0||s>0&&r;)0!==u&&(0===s||!r||n.z<=r.z)?(i=n,n=n.nextZ,u--):(i=r,r=r.nextZ,s--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;n=r}a.nextZ=null,c*=2}while(o>1)}(i)}(t,r,i,l);for(var p,v,y=t;t.prev!==t.next;)if(p=t.prev,v=t.next,l?s(t,r,i,l):u(t))e.push(p.i/n),e.push(t.i/n),e.push(v.i/n),T(t),t=v.next,y=v.next;else if((t=v)===y){h?1===h?o(t=c(t,e,n),e,n,r,i,l,2):2===h&&f(t,e,n,r,i,l):o(a(t),e,n,r,i,l,1);break}}}function u(t){var e=t.prev,n=t,r=t.next;if(m(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(v(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&m(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function s(t,e,n,r){var i=t.prev,a=t,o=t.next;if(m(i,a,o)>=0)return!1;for(var u=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,s=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,c=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,f=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,l=d(u,s,e,n,r),h=d(c,f,e,n,r),p=t.prevZ,y=t.nextZ;p&&p.z>=l&&y&&y.z<=h;){if(p!==t.prev&&p!==t.next&&v(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,y!==t.prev&&y!==t.next&&v(i.x,i.y,a.x,a.y,o.x,o.y,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;p&&p.z>=l;){if(p!==t.prev&&p!==t.next&&v(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;y&&y.z<=h;){if(y!==t.prev&&y!==t.next&&v(i.x,i.y,a.x,a.y,o.x,o.y,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function c(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!g(i,a)&&b(i,r,r.next,a)&&_(i,a)&&_(a,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(a.i/n),T(r),T(r.next),r=t=a),r=r.next}while(r!==t);return r}function f(t,e,n,r,i,u){var s=t;do{for(var c=s.next.next;c!==s.prev;){if(s.i!==c.i&&y(s,c)){var f=x(s,c);return s=a(s,s.next),f=a(f,f.next),o(s,e,n,r,i,u),void o(f,e,n,r,i,u)}c=c.next}s=s.next}while(s!==t)}function l(t,e){return t.x-e.x}function h(t,e){if(e=function(t,e){var n,r=e,i=t.x,a=t.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var u=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(u<=i&&u>o){if(o=u,u===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===o)return n.prev;var s,c=n,f=n.x,l=n.y,h=1/0;r=n.next;for(;r!==c;)i>=r.x&&r.x>=f&&i!==r.x&&v(a<l?i:o,a,f,l,a<l?o:i,a,r.x,r.y)&&((s=Math.abs(a-r.y)/(i-r.x))<h||s===h&&r.x>n.x)&&_(r,t)&&(n=r,h=s),r=r.next;return n}(t,e)){var n=x(e,t);a(n,n.next)}}function d(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function p(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function v(t,e,n,r,i,a,o,u){return(i-o)*(e-u)-(t-o)*(a-u)>=0&&(t-o)*(r-u)-(n-o)*(e-u)>=0&&(n-o)*(a-u)-(i-o)*(r-u)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&b(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&_(t,e)&&_(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function g(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,n,r){return!!(g(t,e)&&g(n,r)||g(t,r)&&g(n,e))||m(t,e,n)>0!=m(t,e,r)>0&&m(n,r,t)>0!=m(n,r,e)>0}function _(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function x(t,e){var n=new E(t.i,t.x,t.y),r=new E(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function w(t,e,n,r){var i=new E(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function T(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function E(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function k(t,e,n,r){for(var i=0,a=e,o=n-r;a<n;a+=r)i+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return i}t.exports=r,t.exports.default=r,r.deviation=function(t,e,n,r){var i=e&&e.length,a=i?e[0]*n:t.length,o=Math.abs(k(t,0,a,n));if(i)for(var u=0,s=e.length;u<s;u++){var c=e[u]*n,f=u<s-1?e[u+1]*n:t.length;o-=Math.abs(k(t,c,f,n))}var l=0;for(u=0;u<r.length;u+=3){var h=r[u]*n,d=r[u+1]*n,p=r[u+2]*n;l+=Math.abs((t[h]-t[p])*(t[d+1]-t[h+1])-(t[h]-t[d])*(t[p+1]-t[h+1]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var a=0;a<t[i].length;a++)for(var o=0;o<e;o++)n.vertices.push(t[i][a][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},function(t,e){t.exports="precision highp float;\nattribute vec2 vertex;\n\nvarying  vec2 uv;\n\nvoid main(void) {\n    uv = vertex*0.5+vec2(0.5);\n    gl_Position = vec4(vertex, 0.5, 1.);\n}\n"},function(t,e){t.exports="precision highp float;\n\nvarying  vec2 uv;\n\nuniform sampler2D aaTex;\n\nvoid main(void) {\n    vec4 aa = texture2D(aaTex, uv);\n    gl_FragColor = aa;\n}\n"},function(t,e){t.exports="vec2 encodeWidth(float x) {\n    if (!(x<=0. || x>=0.) ){\n        // Convert NaN widths to `0`\n        // Do not remove this, some GPUs will convert NaN floats to 1. when\n        // packing the shader output to a RGBA UNSIGNED BYTE textures\n        x = 0.;\n    }\n    float high, low;\n    x = clamp(x, 0., 1023.);\n    high = floor(x/4.);\n    low = (x-high*4.)/4.;\n    return vec2(high/255., low);\n}\n\n$width_preface\n"},function(t,e){t.exports="precision highp float;\n\nattribute vec2 vertexPosition;\nattribute vec2 featureID;\n\nuniform float orderMinWidth;\nuniform float orderMaxWidth;\nuniform float devicePixelRatio;\nuniform vec2 resolution;\nuniform mat4 matrix;\n\nuniform sampler2D colorTex;\nuniform sampler2D widthTex;\nuniform sampler2D filterTex;\n//TODO order bucket texture\n\nvarying highp vec2 featureIDVar;\nvarying highp vec4 color;\nvarying highp vec2 pointCoord;\nvarying highp float filtering;\n\nfloat decodeWidth(vec2 enc) {\n  return enc.x*(255.*4.) + 4.*enc.y;\n}\n\n$symbolPlacement_preface\n$propertyPreface\n$transform_preface\n\nvec2 transform(vec2 p){\n    return $transform_inline(p*resolution)/resolution;\n}\n\nvoid main(void) {\n    featureIDVar = abs(featureID);\n    color = texture2D(colorTex, abs(featureID));\n    filtering = texture2D(filterTex, abs(featureID)).a;\n\n    float size = decodeWidth(texture2D(widthTex, abs(featureID)).rg);\n    float fillSize = size;\n\n    vec4 p =  matrix*vec4(vertexPosition, 0., 1.);\n    p/=p.w;\n    float sizeNormalizer = (size +2.)/size;\n    vec2 size2 = (2.*size+4.)/resolution;\n\n    if (featureID.y<0.){\n        pointCoord = vec2(0.866025, -0.5)*2.*sizeNormalizer;\n        p.xy += transform(size2*vec2(0.866025, -0.5));\n    }else if (featureID.x<0.){\n        pointCoord = vec2(-0.866025, -0.5)*2.*sizeNormalizer;\n        p.xy += transform(size2*vec2(-0.866025, -0.5));\n    }else{\n        pointCoord = vec2(0., 1.)*2.*sizeNormalizer;\n        p.xy += transform(vec2(0.,size2.y));\n    }\n    pointCoord.y = -pointCoord.y;\n\n\n    p.xy += ($symbolPlacement_inline)*size/resolution;\n\n\n    vec4 noOverrideColor = vec4(0.);\n    if (size==0. || (color.a==0. && color != noOverrideColor) || size<orderMinWidth || size>=orderMaxWidth){\n        p.x=10000.;\n    }\n\n    gl_Position  = p;\n}\n"},function(t,e){t.exports="precision highp float;\n\nvarying highp vec2 featureIDVar;\nvarying highp vec4 color;\nvarying highp vec2 pointCoord;\nvarying highp float filtering;\n\n$symbol_preface\n$propertyPreface\n\nvoid main(void) {\n    vec2 featureID = abs(featureIDVar);\n    vec2 imageUV = pointCoord*0.5+vec2(0.5);\n    vec4 symbolColor = $symbol_inline;\n    vec4 noOverrideColor = vec4(0.);\n\n    vec4 c;\n    if (color != noOverrideColor){\n        c = color * vec4(vec3(1), symbolColor.a);\n    }else{\n        c = symbolColor;\n    }\n    c.a *= filtering;\n    if (imageUV!=clamp(imageUV, 0.,1.)){\n        c.a = 0.;\n    }\n\n    gl_FragColor = vec4(c.rgb*c.a, c.a);\n}\n"},function(t,e){t.exports="precision highp float;\n\nattribute vec2 vertexPosition;\nattribute vec2 featureID;\n\nuniform float orderMinWidth;\nuniform float orderMaxWidth;\nuniform vec2 resolution;\nuniform mat4 matrix;\n\nuniform sampler2D colorTex;\nuniform sampler2D widthTex;\nuniform sampler2D strokeColorTex;\nuniform sampler2D strokeWidthTex;\nuniform sampler2D filterTex;\n//TODO order bucket texture\n\nvarying highp vec4 color;\nvarying highp vec4 stroke;\nvarying highp float dp;\nvarying highp float fillScale;\nvarying highp float strokeScale;\nvarying highp vec2 pointCoord;\n\nfloat decodeWidth(vec2 enc) {\n  return enc.x*(255.*4.) + 4.*enc.y;\n}\n\n$propertyPreface\n$transform_preface\n\nvec2 transform(vec2 p){\n    return $transform_inline(p*resolution*0.5)/resolution*2.;\n}\n\nvoid main(void) {\n  color = texture2D(colorTex, abs(featureID));\n  stroke = texture2D(strokeColorTex, abs(featureID));\n  float filtering = texture2D(filterTex, abs(featureID)).a;\n  color.a *= filtering;\n  stroke.a *= filtering;\n  float size = decodeWidth(texture2D(widthTex, abs(featureID)).rg);\n  float fillSize = size;\n  float strokeSize = decodeWidth(texture2D(strokeWidthTex, abs(featureID)).rg);\n  size += strokeSize;\n  fillScale = min(size / fillSize, 1.);\n  strokeScale = size / max(0.001, (fillSize - strokeSize));\n  if (fillScale == strokeScale) {\n    stroke.a = 0.;\n  }\n  dp = 1.0 / (size + 1.);\n  float sizeNormalizer = (size +1.)/size;\n\n  vec4 p =  matrix*vec4(vertexPosition, 0., 1.);\n  p/=p.w;\n  vec2 size2 = (2.*size+4.)/resolution;\n\n    if (featureID.y<0.){\n        pointCoord = vec2(0.866025, -0.5)*2.*sizeNormalizer;\n        p.xy += transform(size2*vec2(0.866025, -0.5));\n    }else if (featureID.x<0.){\n        pointCoord = vec2(-0.866025, -0.5)*2.*sizeNormalizer;\n        p.xy += transform(size2*vec2(-0.866025, -0.5));\n    }else{\n        pointCoord = vec2(0., 1.)*2.*sizeNormalizer;\n        p.xy += transform(vec2(0.,size2.y));\n    }\n\n  if (size == 0. || (stroke.a == 0. && color.a == 0.) || size < orderMinWidth || size >= orderMaxWidth) {\n    p.z = p.w*2.;\n  }\n\n  gl_Position = p;\n}\n"},function(t,e){t.exports="precision highp float;\n\nvarying lowp vec4 color;\nvarying lowp vec4 stroke;\nvarying highp float dp;\nvarying highp float fillScale;\nvarying highp float strokeScale;\nvarying highp vec2 pointCoord;\n\nfloat distanceAntialias(vec2 p){\n    return 1. - smoothstep(1.-dp*1.4142, 1.+dp*1.4142, length(p));\n}\n\nvoid main(void) {\n    vec2 p = pointCoord;\n    vec4 c = color;\n\n    vec4 s = stroke;\n\n    c.a *= distanceAntialias(p*fillScale);\n    c.rgb*=c.a;\n\n    s.a *= distanceAntialias(p);\n    s.a *= 1.-distanceAntialias((strokeScale)*p);\n    s.rgb*=s.a;\n\n    c=s+(1.-s.a)*c;\n\n    gl_FragColor = c;\n}\n"},function(t,e){t.exports="// Line Vertex Shader\nprecision highp float;\n\nattribute vec2 vertexPosition;\nattribute vec2 featureID;\nattribute vec2 normal;\n\nuniform float normalScale;\nuniform vec2 resolution;\nuniform mat4 matrix;\n\nuniform sampler2D colorTex;\nuniform sampler2D widthTex;\nuniform sampler2D filterTex;\n\nvarying lowp vec4 color;\n\nfloat decodeWidth(vec2 enc) {\n  return enc.x*(255.*4.) + 4.*enc.y;\n}\n\n$propertyPreface\n$transform_preface\n\nvoid main(void) {\n    color = texture2D(colorTex, featureID);\n    float filtering = texture2D(filterTex, featureID).a;\n    color.a *= filtering;\n    color.rgb *= color.a;\n    float size = decodeWidth(texture2D(widthTex, featureID).rg);\n\n    // 64 is computed based on RTT_WIDTH and the depth buffer precision\n    // 64 = 2^(BUFFER_BITS)/RTT_WIDTH = 2^16/1024 = 64\n    float z = featureID.y * 63. / 64. + featureID.x / (64.);\n\n    // Set z range (-1, 1)\n    z = z * 2. - 1.;\n\n    vec2 n = normal*size*normalScale;\n    vec4 p =  matrix*vec4(vertexPosition+n, 0., 1.);\n    p/=p.w;\n\n    p.xy = $transform_inline(p.xy*resolution)/resolution;\n    if (size==0. || color.a==0.){\n        p.x=10000.;\n    }\n    p.z=z;\n    gl_Position  = p;\n}\n"},function(t,e){t.exports="precision highp float;\n\nvarying lowp vec4 color;\n\nvoid main(void) {\n    gl_FragColor = color;\n}\n"},function(t,e){t.exports="precision mediump float;\n\nattribute vec2 vertexPosition;\nattribute vec2 featureID;\nattribute vec2 normal;\n\nuniform float normalScale;\nuniform vec2 resolution;\n\nuniform sampler2D colorTex;\nuniform sampler2D strokeColorTex;\nuniform sampler2D strokeWidthTex;\nuniform sampler2D filterTex;\nuniform mat4 matrix;\n\nvarying lowp vec4 color;\n\nfloat decodeWidth(vec2 enc) {\n  return enc.x*(255.*4.) + 4.*enc.y;\n}\n\n$propertyPreface\n$transform_preface\n\nvoid main(void) {\n    // 64 is computed based on RTT_WIDTH and the depth buffer precision\n    // 64 = 2^(BUFFER_BITS)/RTT_WIDTH = 2^16/1024 = 64\n    float z = featureID.y * 63. / 64. + featureID.x / 64.;\n\n    vec4 c;\n    if (normal == vec2(0.)){\n        c = texture2D(colorTex, featureID);\n    }else{\n        z = mod(z + (z > 0.5 ? -1./64. : 1./64.), 1.);\n        c = texture2D(strokeColorTex, featureID);\n    }\n    z = 2.*z - 1.;\n    float filtering = texture2D(filterTex, featureID).a;\n    c.a *= filtering;\n    float size = decodeWidth(texture2D(strokeWidthTex, featureID).rg);\n\n    vec2 n = normal*size*normalScale;\n    vec4 p =  matrix*vec4(vertexPosition+n, 0., 1.);\n    p/=p.w;\n\n    p.xy = $transform_inline(p.xy*resolution*0.5)/resolution*2.;\n\n    if (c.a==0.){\n        p.x=10000.;\n    }\n    p.z=z;\n    color = vec4(c.rgb*c.a, c.a);\n    gl_Position  = p;\n}\n"},function(t,e){t.exports="precision lowp float;\n\nvarying lowp vec4 color;\n\nvoid main(void) {\n    gl_FragColor = color;\n}\n"},,,,,,,,function(t,e){t.exports=function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}},function(t,e){t.exports=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,e){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}},function(t,e,n){var r=function(){return this||"object"==typeof self&&self}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,a=i&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,t.exports=n(70),i)r.regeneratorRuntime=a;else try{delete r.regeneratorRuntime}catch(t){r.regeneratorRuntime=void 0}},function(t,e){!function(e){"use strict";var n,r=Object.prototype,i=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag",c="object"==typeof t,f=e.regeneratorRuntime;if(f)c&&(t.exports=f);else{(f=e.regeneratorRuntime=c?t.exports:{}).wrap=_;var l="suspendedStart",h="suspendedYield",d="executing",p="completed",v={},y={};y[o]=function(){return this};var m=Object.getPrototypeOf,g=m&&m(m(D([])));g&&g!==r&&i.call(g,o)&&(y=g);var b=E.prototype=w.prototype=Object.create(y);T.prototype=b.constructor=E,E.constructor=T,E[s]=T.displayName="GeneratorFunction",f.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===T||"GeneratorFunction"===(e.displayName||e.name))},f.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(b),t},f.awrap=function(t){return{__await:t}},k(A.prototype),A.prototype[u]=function(){return this},f.AsyncIterator=A,f.async=function(t,e,n,r){var i=new A(_(t,e,n,r));return f.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},k(b),b[s]="Generator",b[o]=function(){return this},b.toString=function(){return"[object Generator]"},f.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},f.values=D,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,i){return u.type="throw",u.arg=t,e.next=r,i&&(e.method="next",e.arg=n),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],u=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:D(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),v}}}function _(t,e,n,r){var i=e&&e.prototype instanceof w?e:w,a=Object.create(i.prototype),o=new R(r||[]);return a._invoke=function(t,e,n){var r=l;return function(i,a){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw a;return I()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var u=C(o,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var s=x(t,e,n);if("normal"===s.type){if(r=n.done?p:h,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=p,n.method="throw",n.arg=s.arg)}}}(t,n,o),a}function x(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function w(){}function T(){}function E(){}function k(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function A(t){var e;this._invoke=function(n,r){function a(){return new Promise(function(e,a){!function e(n,r,a,o){var u=x(t[n],t,r);if("throw"!==u.type){var s=u.arg,c=s.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then(function(t){e("next",t,a,o)},function(t){e("throw",t,a,o)}):Promise.resolve(c).then(function(t){s.value=t,a(s)},function(t){return e("throw",t,a,o)})}o(u.arg)}(n,r,e,a)})}return e=e?e.then(a,a):a()}}function C(t,e){var r=t.iterator[e.method];if(r===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,C(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=x(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,v;var a=i.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,v):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function D(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(i.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return a.next=a}}return{next:I}}function I(){return{value:n,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e,n){var r,i;!function(){var a={Burg:{2:["#ffc6c4","#672044"],3:["#ffc6c4","#cc607d","#672044"],4:["#ffc6c4","#e38191","#ad466c","#672044"],5:["#ffc6c4","#ee919b","#cc607d","#9e3963","#672044"],6:["#ffc6c4","#f29ca3","#da7489","#b95073","#93345d","#672044"],7:["#ffc6c4","#f4a3a8","#e38191","#cc607d","#ad466c","#8b3058","#672044"],tags:["quantitative"]},BurgYl:{2:["#fbe6c5","#70284a"],3:["#fbe6c5","#dc7176","#70284a"],4:["#fbe6c5","#ee8a82","#c8586c","#70284a"],5:["#fbe6c5","#f2a28a","#dc7176","#b24b65","#70284a"],6:["#fbe6c5","#f4b191","#e7807d","#d06270","#a44360","#70284a"],7:["#fbe6c5","#f5ba98","#ee8a82","#dc7176","#c8586c","#9c3f5d","#70284a"],tags:["quantitative"]},RedOr:{2:["#f6d2a9","#b13f64"],3:["#f6d2a9","#ea8171","#b13f64"],4:["#f6d2a9","#f19c7c","#dd686c","#b13f64"],5:["#f6d2a9","#f3aa84","#ea8171","#d55d6a","#b13f64"],6:["#f6d2a9","#f4b28a","#ef9177","#e3726d","#cf5669","#b13f64"],7:["#f6d2a9","#f5b78e","#f19c7c","#ea8171","#dd686c","#ca5268","#b13f64"],tags:["quantitative"]},OrYel:{2:["#ecda9a","#ee4d5a"],3:["#ecda9a","#f7945d","#ee4d5a"],4:["#ecda9a","#f3ad6a","#f97b57","#ee4d5a"],5:["#ecda9a","#f1b973","#f7945d","#f86f56","#ee4d5a"],6:["#ecda9a","#f0c079","#f5a363","#f98558","#f76856","#ee4d5a"],7:["#ecda9a","#efc47e","#f3ad6a","#f7945d","#f97b57","#f66356","#ee4d5a"],tags:["quantitative"]},Peach:{2:["#fde0c5","#eb4a40"],3:["#fde0c5","#f59e72","#eb4a40"],4:["#fde0c5","#f8b58b","#f2855d","#eb4a40"],5:["#fde0c5","#f9c098","#f59e72","#f17854","#eb4a40"],6:["#fde0c5","#fac7a1","#f7ac80","#f38f65","#f0704f","#eb4a40"],7:["#fde0c5","#facba6","#f8b58b","#f59e72","#f2855d","#ef6a4c","#eb4a40"],tags:["quantitative"]},PinkYl:{2:["#fef6b5","#e15383"],3:["#fef6b5","#ffa679","#e15383"],4:["#fef6b5","#ffc285","#fa8a76","#e15383"],5:["#fef6b5","#ffd08e","#ffa679","#f67b77","#e15383"],6:["#fef6b5","#ffd795","#ffb77f","#fd9576","#f37378","#e15383"],7:["#fef6b5","#ffdd9a","#ffc285","#ffa679","#fa8a76","#f16d7a","#e15383"],tags:["quantitative"]},Mint:{2:["#e4f1e1","#0d585f"],3:["#e4f1e1","#63a6a0","#0d585f"],4:["#e4f1e1","#89c0b6","#448c8a","#0d585f"],5:["#E4F1E1","#9CCDC1","#63A6A0","#337F7F","#0D585F"],6:["#e4f1e1","#abd4c7","#7ab5ad","#509693","#2c7778","#0d585f"],7:["#e4f1e1","#b4d9cc","#89c0b6","#63a6a0","#448c8a","#287274","#0d585f"],tags:["quantitative"]},BluGrn:{2:["#c4e6c3","#1d4f60"],3:["#c4e6c3","#4da284","#1d4f60"],4:["#c4e6c3","#6dbc90","#36877a","#1d4f60"],5:["#c4e6c3","#80c799","#4da284","#2d7974","#1d4f60"],6:["#c4e6c3","#8dce9f","#5fb28b","#3e927e","#297071","#1d4f60"],7:["#c4e6c3","#96d2a4","#6dbc90","#4da284","#36877a","#266b6e","#1d4f60"],tags:["quantitative"]},DarkMint:{2:["#d2fbd4","#123f5a"],3:["#d2fbd4","#559c9e","#123f5a"],4:["#d2fbd4","#7bbcb0","#3a7c89","#123f5a"],5:["#d2fbd4","#8eccb9","#559c9e","#2b6c7f","#123f5a"],6:["#d2fbd4","#9cd5be","#6cafa9","#458892","#266377","#123f5a"],7:["#d2fbd4","#a5dbc2","#7bbcb0","#559c9e","#3a7c89","#235d72","#123f5a"],tags:["quantitative"]},Emrld:{2:["#d3f2a3","#074050"],3:["#d3f2a3","#4c9b82","#074050"],4:["#d3f2a3","#6cc08b","#217a79","#074050"],5:["#d3f2a3","#82d091","#4c9b82","#19696f","#074050"],6:["#d3f2a3","#8fda94","#60b187","#35877d","#145f69","#074050"],7:["#d3f2a3","#97e196","#6cc08b","#4c9b82","#217a79","#105965","#074050"],tags:["quantitative"]},ag_GrnYl:{2:["#245668","#EDEF5D"],3:["#245668","#39AB7E","#EDEF5D"],4:["#245668","#0D8F81","#6EC574","#EDEF5D"],5:["#245668","#04817E","#39AB7E","#8BD16D","#EDEF5D"],6:["#245668","#09787C","#1D9A81","#58BB79","#9DD869","#EDEF5D"],7:["#245668","#0F7279","#0D8F81","#39AB7E","#6EC574","#A9DC67","#EDEF5D"],tags:["aggregation"]},BluYl:{2:["#f7feae","#045275"],3:["#f7feae","#46aea0","#045275"],4:["#f7feae","#7ccba2","#089099","#045275"],5:["#f7feae","#9bd8a4","#46aea0","#058092","#045275"],6:["#f7feae","#ace1a4","#68bfa1","#2a9c9c","#02778e","#045275"],7:["#f7feae","#b7e6a5","#7ccba2","#46aea0","#089099","#00718b","#045275"],tags:["quantitative"]},Teal:{2:["#d1eeea","#2a5674"],3:["#d1eeea","#68abb8","#2a5674"],4:["#d1eeea","#85c4c9","#4f90a6","#2a5674"],5:["#d1eeea","#96d0d1","#68abb8","#45829b","#2a5674"],6:["#d1eeea","#a1d7d6","#79bbc3","#599bae","#3f7994","#2a5674"],7:["#d1eeea","#a8dbd9","#85c4c9","#68abb8","#4f90a6","#3b738f","#2a5674"],tags:["quantitative"]},TealGrn:{2:["#b0f2bc","#257d98"],3:["#b0f2bc","#4cc8a3","#257d98"],4:["#b0f2bc","#67dba5","#38b2a3","#257d98"],5:["#b0f2bc","#77e2a8","#4cc8a3","#31a6a2","#257d98"],6:["#b0f2bc","#82e6aa","#5bd4a4","#3fbba3","#2e9ea1","#257d98"],7:["#b0f2bc","#89e8ac","#67dba5","#4cc8a3","#38b2a3","#2c98a0","#257d98"],tags:["quantitative"]},Purp:{2:["#f3e0f7","#63589f"],3:["#f3e0f7","#b998dd","#63589f"],4:["#f3e0f7","#d1afe8","#9f82ce","#63589f"],5:["#f3e0f7","#dbbaed","#b998dd","#9178c4","#63589f"],6:["#f3e0f7","#e0c2ef","#c8a5e4","#aa8bd4","#8871be","#63589f"],7:["#f3e0f7","#e4c7f1","#d1afe8","#b998dd","#9f82ce","#826dba","#63589f"],tags:["quantitative"]},PurpOr:{3:["#f9ddda","#ce78b3","#573b88"],4:["#f9ddda","#e597b9","#ad5fad","#573b88"],5:["#f9ddda","#eda8bd","#ce78b3","#9955a8","#573b88"],6:["#f9ddda","#f0b2c1","#dd8ab6","#bb69b0","#8c4fa4","#573b88"],7:["#f9ddda","#f2b9c4","#e597b9","#ce78b3","#ad5fad","#834ba0","#573b88"],tags:["quantitative"]},Sunset:{2:["#f3e79b","#5c53a5"],3:["#f3e79b","#eb7f86","#5c53a5"],4:["#f3e79b","#f8a07e","#ce6693","#5c53a5"],5:["#f3e79b","#fab27f","#eb7f86","#b95e9a","#5c53a5"],6:["#f3e79b","#fabc82","#f59280","#dc6f8e","#ab5b9e","#5c53a5"],7:["#f3e79b","#fac484","#f8a07e","#eb7f86","#ce6693","#a059a0","#5c53a5"],tags:["quantitative"]},Magenta:{2:["#f3cbd3","#6c2167"],3:["#f3cbd3","#ca699d","#6c2167"],4:["#f3cbd3","#dd88ac","#b14d8e","#6c2167"],5:["#f3cbd3","#e498b4","#ca699d","#a24186","#6c2167"],6:["#f3cbd3","#e7a2b9","#d67ba5","#bc5894","#983a81","#6c2167"],7:["#f3cbd3","#eaa9bd","#dd88ac","#ca699d","#b14d8e","#91357d","#6c2167"],tags:["quantitative"]},SunsetDark:{2:["#fcde9c","#7c1d6f"],3:["#fcde9c","#e34f6f","#7c1d6f"],4:["#fcde9c","#f0746e","#dc3977","#7c1d6f"],5:["#fcde9c","#f58670","#e34f6f","#d72d7c","#7c1d6f"],6:["#fcde9c","#f89872","#ec666d","#df4273","#c5287b","#7c1d6f"],7:["#fcde9c","#faa476","#f0746e","#e34f6f","#dc3977","#b9257a","#7c1d6f"],tags:["quantitative"]},ag_Sunset:{2:["#4b2991","#edd9a3"],3:["#4b2991","#ea4f88","#edd9a3"],4:["#4b2991","#c0369d","#fa7876","#edd9a3"],5:["#4b2991","#a52fa2","#ea4f88","#fa9074","#edd9a3"],6:["#4b2991","#932da3","#d43f96","#f7667c","#f89f77","#edd9a3"],7:["#4b2991","#872ca2","#c0369d","#ea4f88","#fa7876","#f6a97a","#edd9a3"],tags:["aggregation"]},BrwnYl:{2:["#ede5cf","#541f3f"],3:["#ede5cf","#c1766f","#541f3f"],4:["#ede5cf","#d39c83","#a65461","#541f3f"],5:["#ede5cf","#daaf91","#c1766f","#95455a","#541f3f"],6:["#ede5cf","#ddba9b","#cd8c7a","#b26166","#8a3c56","#541f3f"],7:["#ede5cf","#e0c2a2","#d39c83","#c1766f","#a65461","#813753","#541f3f"],tags:["quantitative"]},ArmyRose:{2:["#929b4f","#db8195"],3:["#a3ad62","#fdfbe4","#df91a3"],4:["#929b4f","#d9dbaf","#f3d1ca","#db8195"],5:["#879043","#c1c68c","#fdfbe4","#ebb4b8","#d8758b"],6:["#7f883b","#b0b874","#e3e4be","#f6ddd1","#e4a0ac","#d66d85"],7:["#798234","#a3ad62","#d0d3a2","#fdfbe4","#f0c6c3","#df91a3","#d46780"],tags:["diverging"]},Fall:{2:["#3d5941","#ca562c"],3:["#3d5941","#f6edbd","#ca562c"],4:["#3d5941","#b5b991","#edbb8a","#ca562c"],5:["#3d5941","#96a07c","#f6edbd","#e6a272","#ca562c"],6:["#3d5941","#839170","#cecea2","#f1cf9e","#e19464","#ca562c"],7:["#3d5941","#778868","#b5b991","#f6edbd","#edbb8a","#de8a5a","#ca562c"],tags:["diverging"]},Geyser:{2:["#008080","#ca562c"],3:["#008080","#f6edbd","#ca562c"],4:["#008080","#b4c8a8","#edbb8a","#ca562c"],5:["#008080","#92b69e","#f6edbd","#e6a272","#ca562c"],6:["#008080","#7eab98","#ced7b1","#f1cf9e","#e19464","#ca562c"],7:["#008080","#70a494","#b4c8a8","#f6edbd","#edbb8a","#de8a5a","#ca562c"],tags:["diverging"]},Temps:{2:["#009392","#cf597e"],3:["#009392","#e9e29c","#cf597e"],4:["#009392","#9ccb86","#eeb479","#cf597e"],5:["#009392","#71be83","#e9e29c","#ed9c72","#cf597e"],6:["#009392","#52b684","#bcd48c","#edc783","#eb8d71","#cf597e"],7:["#009392","#39b185","#9ccb86","#e9e29c","#eeb479","#e88471","#cf597e"],tags:["diverging"]},TealRose:{2:["#009392","#d0587e"],3:["#009392","#f1eac8","#d0587e"],4:["#009392","#91b8aa","#f1eac8","#dfa0a0","#d0587e"],5:["#009392","#91b8aa","#f1eac8","#dfa0a0","#d0587e"],6:["#009392","#72aaa1","#b1c7b3","#e5b9ad","#d98994","#d0587e"],7:["#009392","#72aaa1","#b1c7b3","#f1eac8","#e5b9ad","#d98994","#d0587e"],tags:["diverging"]},Tropic:{2:["#009B9E","#C75DAB"],3:["#009B9E","#F1F1F1","#C75DAB"],4:["#009B9E","#A7D3D4","#E4C1D9","#C75DAB"],5:["#009B9E","#7CC5C6","#F1F1F1","#DDA9CD","#C75DAB"],6:["#009B9E","#5DBCBE","#C6DFDF","#E9D4E2","#D99BC6","#C75DAB"],7:["#009B9E","#42B7B9","#A7D3D4","#F1F1F1","#E4C1D9","#D691C1","#C75DAB"],tags:["diverging"]},Earth:{2:["#A16928","#2887a1"],3:["#A16928","#edeac2","#2887a1"],4:["#A16928","#d6bd8d","#b5c8b8","#2887a1"],5:["#A16928","#caa873","#edeac2","#98b7b2","#2887a1"],6:["#A16928","#c29b64","#e0cfa2","#cbd5bc","#85adaf","#2887a1"],7:["#A16928","#bd925a","#d6bd8d","#edeac2","#b5c8b8","#79a7ac","#2887a1"],tags:["diverging"]},Antique:{2:["#855C75","#D9AF6B","#7C7C7C"],3:["#855C75","#D9AF6B","#AF6458","#7C7C7C"],4:["#855C75","#D9AF6B","#AF6458","#736F4C","#7C7C7C"],5:["#855C75","#D9AF6B","#AF6458","#736F4C","#526A83","#7C7C7C"],6:["#855C75","#D9AF6B","#AF6458","#736F4C","#526A83","#625377","#7C7C7C"],7:["#855C75","#D9AF6B","#AF6458","#736F4C","#526A83","#625377","#68855C","#7C7C7C"],8:["#855C75","#D9AF6B","#AF6458","#736F4C","#526A83","#625377","#68855C","#9C9C5E","#7C7C7C"],9:["#855C75","#D9AF6B","#AF6458","#736F4C","#526A83","#625377","#68855C","#9C9C5E","#A06177","#7C7C7C"],10:["#855C75","#D9AF6B","#AF6458","#736F4C","#526A83","#625377","#68855C","#9C9C5E","#A06177","#8C785D","#7C7C7C"],11:["#855C75","#D9AF6B","#AF6458","#736F4C","#526A83","#625377","#68855C","#9C9C5E","#A06177","#8C785D","#467378","#7C7C7C"],tags:["qualitative"]},Bold:{2:["#7F3C8D","#11A579","#A5AA99"],3:["#7F3C8D","#11A579","#3969AC","#A5AA99"],4:["#7F3C8D","#11A579","#3969AC","#F2B701","#A5AA99"],5:["#7F3C8D","#11A579","#3969AC","#F2B701","#E73F74","#A5AA99"],6:["#7F3C8D","#11A579","#3969AC","#F2B701","#E73F74","#80BA5A","#A5AA99"],7:["#7F3C8D","#11A579","#3969AC","#F2B701","#E73F74","#80BA5A","#E68310","#A5AA99"],8:["#7F3C8D","#11A579","#3969AC","#F2B701","#E73F74","#80BA5A","#E68310","#008695","#A5AA99"],9:["#7F3C8D","#11A579","#3969AC","#F2B701","#E73F74","#80BA5A","#E68310","#008695","#CF1C90","#A5AA99"],10:["#7F3C8D","#11A579","#3969AC","#F2B701","#E73F74","#80BA5A","#E68310","#008695","#CF1C90","#f97b72","#A5AA99"],11:["#7F3C8D","#11A579","#3969AC","#F2B701","#E73F74","#80BA5A","#E68310","#008695","#CF1C90","#f97b72","#4b4b8f","#A5AA99"],tags:["qualitative"]},Pastel:{2:["#66C5CC","#F6CF71","#B3B3B3"],3:["#66C5CC","#F6CF71","#F89C74","#B3B3B3"],4:["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#B3B3B3"],5:["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#B3B3B3"],6:["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#9EB9F3","#B3B3B3"],7:["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#9EB9F3","#FE88B1","#B3B3B3"],8:["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#9EB9F3","#FE88B1","#C9DB74","#B3B3B3"],9:["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#9EB9F3","#FE88B1","#C9DB74","#8BE0A4","#B3B3B3"],10:["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#9EB9F3","#FE88B1","#C9DB74","#8BE0A4","#B497E7","#B3B3B3"],11:["#66C5CC","#F6CF71","#F89C74","#DCB0F2","#87C55F","#9EB9F3","#FE88B1","#C9DB74","#8BE0A4","#B497E7","#D3B484","#B3B3B3"],tags:["qualitative"]},Prism:{2:["#5F4690","#1D6996","#666666"],3:["#5F4690","#1D6996","#38A6A5","#666666"],4:["#5F4690","#1D6996","#38A6A5","#0F8554","#666666"],5:["#5F4690","#1D6996","#38A6A5","#0F8554","#73AF48","#666666"],6:["#5F4690","#1D6996","#38A6A5","#0F8554","#73AF48","#EDAD08","#666666"],7:["#5F4690","#1D6996","#38A6A5","#0F8554","#73AF48","#EDAD08","#E17C05","#666666"],8:["#5F4690","#1D6996","#38A6A5","#0F8554","#73AF48","#EDAD08","#E17C05","#CC503E","#666666"],9:["#5F4690","#1D6996","#38A6A5","#0F8554","#73AF48","#EDAD08","#E17C05","#CC503E","#94346E","#666666"],10:["#5F4690","#1D6996","#38A6A5","#0F8554","#73AF48","#EDAD08","#E17C05","#CC503E","#94346E","#6F4070","#666666"],11:["#5F4690","#1D6996","#38A6A5","#0F8554","#73AF48","#EDAD08","#E17C05","#CC503E","#94346E","#6F4070","#994E95","#666666"],tags:["qualitative"]},Safe:{2:["#88CCEE","#CC6677","#888888"],3:["#88CCEE","#CC6677","#DDCC77","#888888"],4:["#88CCEE","#CC6677","#DDCC77","#117733","#888888"],5:["#88CCEE","#CC6677","#DDCC77","#117733","#332288","#888888"],6:["#88CCEE","#CC6677","#DDCC77","#117733","#332288","#AA4499","#888888"],7:["#88CCEE","#CC6677","#DDCC77","#117733","#332288","#AA4499","#44AA99","#888888"],8:["#88CCEE","#CC6677","#DDCC77","#117733","#332288","#AA4499","#44AA99","#999933","#888888"],9:["#88CCEE","#CC6677","#DDCC77","#117733","#332288","#AA4499","#44AA99","#999933","#882255","#888888"],10:["#88CCEE","#CC6677","#DDCC77","#117733","#332288","#AA4499","#44AA99","#999933","#882255","#661100","#888888"],11:["#88CCEE","#CC6677","#DDCC77","#117733","#332288","#AA4499","#44AA99","#999933","#882255","#661100","#6699CC","#888888"],tags:["qualitative","colorblind"]},Vivid:{2:["#E58606","#5D69B1","#A5AA99"],3:["#E58606","#5D69B1","#52BCA3","#A5AA99"],4:["#E58606","#5D69B1","#52BCA3","#99C945","#A5AA99"],5:["#E58606","#5D69B1","#52BCA3","#99C945","#CC61B0","#A5AA99"],6:["#E58606","#5D69B1","#52BCA3","#99C945","#CC61B0","#24796C","#A5AA99"],7:["#E58606","#5D69B1","#52BCA3","#99C945","#CC61B0","#24796C","#DAA51B","#A5AA99"],8:["#E58606","#5D69B1","#52BCA3","#99C945","#CC61B0","#24796C","#DAA51B","#2F8AC4","#A5AA99"],9:["#E58606","#5D69B1","#52BCA3","#99C945","#CC61B0","#24796C","#DAA51B","#2F8AC4","#764E9F","#A5AA99"],10:["#E58606","#5D69B1","#52BCA3","#99C945","#CC61B0","#24796C","#DAA51B","#2F8AC4","#764E9F","#ED645A","#A5AA99"],11:["#E58606","#5D69B1","#52BCA3","#99C945","#CC61B0","#24796C","#DAA51B","#2F8AC4","#764E9F","#ED645A","#CC3A8E","#A5AA99"],tags:["qualitative"]}},o={Blues:{tags:["quantitative"]},BrBG:{tags:["diverging"]},Greys:{tags:["quantitative"]},PiYG:{tags:["diverging"]},PRGn:{tags:["diverging"]},Purples:{tags:["quantitative"]},RdYlGn:{tags:["diverging"]},Spectral:{tags:["diverging"]},YlOrBr:{tags:["quantitative"]},YlGn:{tags:["quantitative"]},YlGnBu:{tags:["quantitative"]},YlOrRd:{tags:["quantitative"]}},u=n(75);for(var s in u){var c=u[s],f={};for(var l in c)f[l]=c[l];s in o&&(f.tags=o[s].tags),a["cb_"+s]=f}void 0===(i="function"==typeof(r=a)?r.call(e,n,e,t):r)||(t.exports=i)}()},function(t,e,n){t.exports=n(76)},function(t,e,n){var r,i;void 0===(i="function"==typeof(r={YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]},PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]},Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}})?r.call(e,n,e,t):r)||(t.exports=i)},function(t,e,n){(function(e){"pseudomap"===e.env.npm_package_name&&"test"===e.env.npm_lifecycle_script&&(e.env.TEST_PSEUDOMAP="true"),"function"!=typeof Map||e.env.TEST_PSEUDOMAP?t.exports=n(78):t.exports=Map}).call(this,n(24))},function(t,e){var n=Object.prototype.hasOwnProperty;function r(t){if(!(this instanceof r))throw new TypeError("Constructor PseudoMap requires 'new'");if(this.clear(),t)if(t instanceof r||"function"==typeof Map&&t instanceof Map)t.forEach(function(t,e){this.set(e,t)},this);else{if(!Array.isArray(t))throw new TypeError("invalid argument");t.forEach(function(t){this.set(t[0],t[1])},this)}}function i(t,e){return t===e||t!=t&&e!=e}function a(t,e){for(var r=0,a="_"+e,o=a;n.call(t,o);o=a+r++)if(i(t[o].key,e))return t[o]}t.exports=r,r.prototype.forEach=function(t,e){e=e||this,Object.keys(this._data).forEach(function(n){"size"!==n&&t.call(e,this._data[n].value,this._data[n].key)},this)},r.prototype.has=function(t){return!!a(this._data,t)},r.prototype.get=function(t){var e=a(this._data,t);return e&&e.value},r.prototype.set=function(t,e){!function(t,e,r){for(var a=0,o="_"+e,u=o;n.call(t,u);u=o+a++)if(i(t[u].key,e))return void(t[u].value=r);t.size++,t[u]=new function(t,e,n){this.key=t,this.value=e,this._index=n}(e,r,u)}(this._data,t,e)},r.prototype.delete=function(t){var e=a(this._data,t);e&&(delete this._data[e._index],this._data.size--)},r.prototype.clear=function(){var t=Object.create(null);t.size=0,Object.defineProperty(this,"_data",{value:t,enumerable:!1,configurable:!0,writable:!1})},Object.defineProperty(r.prototype,"size",{get:function(){return this._data.size},set:function(t){},enumerable:!0,configurable:!0}),r.prototype.values=r.prototype.keys=r.prototype.entries=function(){throw new Error("iterators are not implemented in this version")}},function(t,e,n){(function(t,r){var i=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(u(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,a=r.length,o=String(t).replace(i,function(t){if("%%"===t)return"%";if(n>=a)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),s=r[n];n<a;s=r[++n])v(s)||!_(s)?o+=" "+s:o+=" "+u(s);return o},e.deprecate=function(n,i){if(g(t.process))return function(){return e.deprecate(n,i).apply(this,arguments)};if(!0===r.noDeprecation)return n;var a=!1;return function(){if(!a){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),a=!0}return n.apply(this,arguments)}};var a,o={};function u(t,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&e._extend(r,n),g(r.showHidden)&&(r.showHidden=!1),g(r.depth)&&(r.depth=2),g(r.colors)&&(r.colors=!1),g(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=s),f(r,t,r.depth)}function s(t,e){var n=u.styles[e];return n?"["+u.colors[n][0]+"m"+t+"["+u.colors[n][1]+"m":t}function c(t,e){return t}function f(t,n,r){if(t.customInspect&&n&&T(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return m(i)||(i=f(t,i,r)),i}var a=function(t,e){if(g(e))return t.stylize("undefined","undefined");if(m(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(y(e))return t.stylize(""+e,"number");if(p(e))return t.stylize(""+e,"boolean");if(v(e))return t.stylize("null","null")}(t,n);if(a)return a;var o=Object.keys(n),u=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(n)),w(n)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return l(n);if(0===o.length){if(T(n)){var s=n.name?": "+n.name:"";return t.stylize("[Function"+s+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(x(n))return t.stylize(Date.prototype.toString.call(n),"date");if(w(n))return l(n)}var c,_="",E=!1,k=["{","}"];(d(n)&&(E=!0,k=["[","]"]),T(n))&&(_=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(_=" "+RegExp.prototype.toString.call(n)),x(n)&&(_=" "+Date.prototype.toUTCString.call(n)),w(n)&&(_=" "+l(n)),0!==o.length||E&&0!=n.length?r<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=E?function(t,e,n,r,i){for(var a=[],o=0,u=e.length;o<u;++o)C(e,String(o))?a.push(h(t,e,n,r,String(o),!0)):a.push("");return i.forEach(function(i){i.match(/^\d+$/)||a.push(h(t,e,n,r,i,!0))}),a}(t,n,r,u,o):o.map(function(e){return h(t,n,r,u,e,E)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(c,_,k)):k[0]+_+k[1]}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i,a){var o,u,s;if((s=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?u=s.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):s.set&&(u=t.stylize("[Setter]","special")),C(r,i)||(o="["+i+"]"),u||(t.seen.indexOf(s.value)<0?(u=v(n)?f(t,s.value,null):f(t,s.value,n-1)).indexOf("\n")>-1&&(u=a?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n")):u=t.stylize("[Circular]","special")),g(o)){if(a&&i.match(/^\d+$/))return u;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+u}function d(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function v(t){return null===t}function y(t){return"number"==typeof t}function m(t){return"string"==typeof t}function g(t){return void 0===t}function b(t){return _(t)&&"[object RegExp]"===E(t)}function _(t){return"object"==typeof t&&null!==t}function x(t){return _(t)&&"[object Date]"===E(t)}function w(t){return _(t)&&("[object Error]"===E(t)||t instanceof Error)}function T(t){return"function"==typeof t}function E(t){return Object.prototype.toString.call(t)}function k(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(g(a)&&(a=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!o[t])if(new RegExp("\\b"+t+"\\b","i").test(a)){var n=r.pid;o[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else o[t]=function(){};return o[t]},e.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=p,e.isNull=v,e.isNullOrUndefined=function(t){return null==t},e.isNumber=y,e.isString=m,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=g,e.isRegExp=b,e.isObject=_,e.isDate=x,e.isError=w,e.isFunction=T,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(81);var A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[k(t.getHours()),k(t.getMinutes()),k(t.getSeconds())].join(":");return[t.getDate(),A[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=n(82),e._extend=function(t,e){if(!e||!_(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,n(80),n(24))},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e){function n(t){var e=this;if(e instanceof n||(e=new n),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach(function(t){e.push(t)});else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)e.push(arguments[r]);return e}function r(t,e){t.tail=new a(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function i(t,e){t.head=new a(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function a(t,e,n,r){if(!(this instanceof a))return new a(t,e,n,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}t.exports=n,n.Node=a,n.create=n,n.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null},n.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},n.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},n.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)r(this,arguments[t]);return this.length},n.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)i(this,arguments[t]);return this.length},n.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},n.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},n.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;null!==n;r++)t.call(e,n.value,r,this),n=n.next},n.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;null!==n;r--)t.call(e,n.value,r,this),n=n.prev},n.prototype.get=function(t){for(var e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value},n.prototype.getReverse=function(t){for(var e=0,n=this.tail;null!==n&&e<t;e++)n=n.prev;if(e===t&&null!==n)return n.value},n.prototype.map=function(t,e){e=e||this;for(var r=new n,i=this.head;null!==i;)r.push(t.call(e,i.value,this)),i=i.next;return r},n.prototype.mapReverse=function(t,e){e=e||this;for(var r=new n,i=this.tail;null!==i;)r.push(t.call(e,i.value,this)),i=i.prev;return r},n.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=t(n,r.value,i),r=r.next;return n},n.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=t(n,r.value,i),r=r.prev;return n},n.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;null!==n;e++)t[e]=n.value,n=n.next;return t},n.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;null!==n;e++)t[e]=n.value,n=n.prev;return t},n.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var r=new n;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,a=this.head;null!==a&&i<t;i++)a=a.next;for(;null!==a&&i<e;i++,a=a.next)r.push(a.value);return r},n.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var r=new n;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,a=this.tail;null!==a&&i>e;i--)a=a.prev;for(;null!==a&&i>t;i--,a=a.prev)r.push(a.value);return r},n.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this}},function(t,e,n){"use strict";var r=window.URL||window.webkitURL;t.exports=function(t,e){try{try{var n;try{(n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(t),n=n.getBlob()}catch(e){n=new Blob([t])}return new Worker(r.createObjectURL(n))}catch(e){return new Worker("data:application/javascript,"+encodeURIComponent(t))}}catch(t){if(!e)throw Error("Inline worker is not supported");return new Worker(e)}}},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"colorShaderGLSL",function(){return dt}),n.d(r,"filterShaderGLSL",function(){return pt}),n.d(r,"widthShaderGLSL",function(){return vt});var i={};n.r(i),n.d(i,"symbolShaderGLSL",function(){return bt});var a={};n.r(a),n.d(a,"transition",function(){return Ci}),n.d(a,"nin",function(){return Si}),n.d(a,"in",function(){return Mi}),n.d(a,"between",function(){return Ri}),n.d(a,"mul",function(){return Di}),n.d(a,"div",function(){return Ii}),n.d(a,"add",function(){return Fi}),n.d(a,"sub",function(){return Ni}),n.d(a,"pow",function(){return Oi}),n.d(a,"mod",function(){return Pi}),n.d(a,"greaterThan",function(){return Li}),n.d(a,"greaterThanOrEqualTo",function(){return Bi}),n.d(a,"lessThan",function(){return Ui}),n.d(a,"lessThanOrEqualTo",function(){return zi}),n.d(a,"equals",function(){return Vi}),n.d(a,"notEquals",function(){return Gi}),n.d(a,"and",function(){return ji}),n.d(a,"or",function(){return qi}),n.d(a,"gt",function(){return Wi}),n.d(a,"gte",function(){return Yi}),n.d(a,"lt",function(){return Xi}),n.d(a,"lte",function(){return Hi}),n.d(a,"eq",function(){return Zi}),n.d(a,"neq",function(){return Qi}),n.d(a,"blend",function(){return $i}),n.d(a,"buckets",function(){return Ji}),n.d(a,"cielab",function(){return Ki}),n.d(a,"clusterAvg",function(){return ta}),n.d(a,"clusterMax",function(){return ea}),n.d(a,"clusterMin",function(){return na}),n.d(a,"clusterMode",function(){return ra}),n.d(a,"clusterSum",function(){return ia}),n.d(a,"clusterCount",function(){return aa}),n.d(a,"constant",function(){return oa}),n.d(a,"image",function(){return ua}),n.d(a,"svg",function(){return sa}),n.d(a,"hex",function(){return ca}),n.d(a,"hsl",function(){return fa}),n.d(a,"hsla",function(){return la}),n.d(a,"hsv",function(){return ha}),n.d(a,"hsva",function(){return da}),n.d(a,"cubic",function(){return pa}),n.d(a,"ilinear",function(){return va}),n.d(a,"linear",function(){return ya}),n.d(a,"list",function(){return ma}),n.d(a,"namedColor",function(){return ga}),n.d(a,"now",function(){return ba}),n.d(a,"number",function(){return _a}),n.d(a,"opacity",function(){return xa}),n.d(a,"asc",function(){return wa}),n.d(a,"desc",function(){return Ta}),n.d(a,"noOrder",function(){return Ea}),n.d(a,"width",function(){return ka}),n.d(a,"reverse",function(){return Aa}),n.d(a,"property",function(){return Ca}),n.d(a,"prop",function(){return Ca}),n.d(a,"globalQuantiles",function(){return Ma}),n.d(a,"viewportQuantiles",function(){return Sa}),n.d(a,"globalEqIntervals",function(){return Ra}),n.d(a,"viewportEqIntervals",function(){return Da}),n.d(a,"globalStandardDev",function(){return Ia}),n.d(a,"viewportStandardDev",function(){return Fa}),n.d(a,"ramp",function(){return Na}),n.d(a,"rgb",function(){return Oa}),n.d(a,"rgba",function(){return Pa}),n.d(a,"category",function(){return La}),n.d(a,"time",function(){return Ba}),n.d(a,"date",function(){return Ba}),n.d(a,"top",function(){return Ua}),n.d(a,"fade",function(){return za}),n.d(a,"animation",function(){return Va}),n.d(a,"log",function(){return Ga}),n.d(a,"sqrt",function(){return ja}),n.d(a,"sin",function(){return qa}),n.d(a,"cos",function(){return Wa}),n.d(a,"tan",function(){return Ya}),n.d(a,"sign",function(){return Xa}),n.d(a,"abs",function(){return Ha}),n.d(a,"isNaN",function(){return Za}),n.d(a,"not",function(){return Qa}),n.d(a,"floor",function(){return $a}),n.d(a,"ceil",function(){return Ja}),n.d(a,"variable",function(){return Ka}),n.d(a,"var",function(){return Ka}),n.d(a,"viewportAvg",function(){return to}),n.d(a,"viewportMax",function(){return eo}),n.d(a,"viewportMin",function(){return no}),n.d(a,"viewportSum",function(){return ro}),n.d(a,"viewportCount",function(){return io}),n.d(a,"viewportPercentile",function(){return ao}),n.d(a,"viewportHistogram",function(){return oo}),n.d(a,"viewportFeatures",function(){return uo}),n.d(a,"globalAvg",function(){return so}),n.d(a,"globalMax",function(){return co}),n.d(a,"globalMin",function(){return fo}),n.d(a,"globalSum",function(){return lo}),n.d(a,"globalCount",function(){return ho}),n.d(a,"globalPercentile",function(){return po}),n.d(a,"zoom",function(){return vo}),n.d(a,"scaled",function(){return yo}),n.d(a,"zoomrange",function(){return mo}),n.d(a,"placement",function(){return go}),n.d(a,"translate",function(){return bo}),n.d(a,"rotate",function(){return _o}),n.d(a,"alphaNormalize",function(){return xo}),n.d(a,"HOLD",function(){return wo}),n.d(a,"TRUE",function(){return To}),n.d(a,"FALSE",function(){return Eo}),n.d(a,"PI",function(){return ko}),n.d(a,"E",function(){return Ao}),n.d(a,"BICYCLE",function(){return Co}),n.d(a,"BUILDING",function(){return Mo}),n.d(a,"BUS",function(){return So}),n.d(a,"CAR",function(){return Ro}),n.d(a,"CIRCLE",function(){return Do}),n.d(a,"CIRCLE_OUTLINE",function(){return Io}),n.d(a,"CROSS",function(){return Fo}),n.d(a,"FLAG",function(){return No}),n.d(a,"HOUSE",function(){return Oo}),n.d(a,"MARKER",function(){return Po}),n.d(a,"MARKER_OUTLINE",function(){return Lo}),n.d(a,"PLUS",function(){return Bo}),n.d(a,"SQUARE",function(){return Uo}),n.d(a,"SQUARE_OUTLINE",function(){return zo}),n.d(a,"STAR",function(){return Vo}),n.d(a,"STAR_OUTLINE",function(){return Go}),n.d(a,"TRIANGLE",function(){return jo}),n.d(a,"TRIANGLE_OUTLINE",function(){return qo}),n.d(a,"ALIGN_CENTER",function(){return Wo}),n.d(a,"ALIGN_BOTTOM",function(){return Yo}),n.d(a,"palettes",function(){return Tn}),n.d(a,"Asc",function(){return dn}),n.d(a,"Desc",function(){return pn});var o={};n.r(o),n.d(o,"create",function(){return Cu}),n.d(o,"clone",function(){return Mu}),n.d(o,"copy",function(){return Su}),n.d(o,"fromValues",function(){return Ru}),n.d(o,"set",function(){return Du}),n.d(o,"identity",function(){return Iu}),n.d(o,"transpose",function(){return Fu}),n.d(o,"invert",function(){return Nu}),n.d(o,"adjoint",function(){return Ou}),n.d(o,"determinant",function(){return Pu}),n.d(o,"multiply",function(){return Lu}),n.d(o,"translate",function(){return Bu}),n.d(o,"scale",function(){return Uu}),n.d(o,"rotate",function(){return zu}),n.d(o,"rotateX",function(){return Vu}),n.d(o,"rotateY",function(){return Gu}),n.d(o,"rotateZ",function(){return ju}),n.d(o,"fromTranslation",function(){return qu}),n.d(o,"fromScaling",function(){return Wu}),n.d(o,"fromRotation",function(){return Yu}),n.d(o,"fromXRotation",function(){return Xu}),n.d(o,"fromYRotation",function(){return Hu}),n.d(o,"fromZRotation",function(){return Zu}),n.d(o,"fromRotationTranslation",function(){return Qu}),n.d(o,"fromQuat2",function(){return $u}),n.d(o,"getTranslation",function(){return Ju}),n.d(o,"getScaling",function(){return Ku}),n.d(o,"getRotation",function(){return ts}),n.d(o,"fromRotationTranslationScale",function(){return es}),n.d(o,"fromRotationTranslationScaleOrigin",function(){return ns}),n.d(o,"fromQuat",function(){return rs}),n.d(o,"frustum",function(){return is}),n.d(o,"perspective",function(){return as}),n.d(o,"perspectiveFromFieldOfView",function(){return os}),n.d(o,"ortho",function(){return us}),n.d(o,"lookAt",function(){return ss}),n.d(o,"targetTo",function(){return cs}),n.d(o,"str",function(){return fs}),n.d(o,"frob",function(){return ls}),n.d(o,"add",function(){return hs}),n.d(o,"subtract",function(){return ds}),n.d(o,"multiplyScalar",function(){return ps}),n.d(o,"multiplyScalarAndAdd",function(){return vs}),n.d(o,"exactEquals",function(){return ys}),n.d(o,"equals",function(){return ms}),n.d(o,"mul",function(){return gs}),n.d(o,"sub",function(){return bs});var u={};n.r(u),n.d(u,"create",function(){return _s}),n.d(u,"clone",function(){return xs}),n.d(u,"fromValues",function(){return ws}),n.d(u,"copy",function(){return Ts}),n.d(u,"set",function(){return Es}),n.d(u,"add",function(){return ks}),n.d(u,"subtract",function(){return As}),n.d(u,"multiply",function(){return Cs}),n.d(u,"divide",function(){return Ms}),n.d(u,"ceil",function(){return Ss}),n.d(u,"floor",function(){return Rs}),n.d(u,"min",function(){return Ds}),n.d(u,"max",function(){return Is}),n.d(u,"round",function(){return Fs}),n.d(u,"scale",function(){return Ns}),n.d(u,"scaleAndAdd",function(){return Os}),n.d(u,"distance",function(){return Ps}),n.d(u,"squaredDistance",function(){return Ls}),n.d(u,"length",function(){return Bs}),n.d(u,"squaredLength",function(){return Us}),n.d(u,"negate",function(){return zs}),n.d(u,"inverse",function(){return Vs}),n.d(u,"normalize",function(){return Gs}),n.d(u,"dot",function(){return js}),n.d(u,"lerp",function(){return qs}),n.d(u,"random",function(){return Ws}),n.d(u,"transformMat4",function(){return Ys}),n.d(u,"transformQuat",function(){return Xs}),n.d(u,"str",function(){return Hs}),n.d(u,"exactEquals",function(){return Zs}),n.d(u,"equals",function(){return Qs}),n.d(u,"sub",function(){return $s}),n.d(u,"mul",function(){return Js}),n.d(u,"div",function(){return Ks}),n.d(u,"dist",function(){return tc}),n.d(u,"sqrDist",function(){return ec}),n.d(u,"len",function(){return nc}),n.d(u,"sqrLen",function(){return rc}),n.d(u,"forEach",function(){return ic});var s={};n.r(s),n.d(s,"voyager",function(){return If}),n.d(s,"darkmatter",function(){return Ff}),n.d(s,"positron",function(){return Nf});var c=n(7),f=n.n(c),l=n(15),h=n.n(l),d=Math.PI/180,p=6378137,v=p*Math.PI,y=2*v;function m(t){return void 0===t}function g(t){return"string"==typeof t}function b(t){var e=h()(t);return null!==t&&("object"===e||"function"===e)}function _(t){if(t instanceof Date)return t;if("number"==typeof t){var e=t;return(t=new Date(0)).setUTCMilliseconds(e),t}return new Date(t)}function x(t){var e=t.lat*d;return{x:t.lng*d*p,y:Math.log(Math.tan(e/2+Math.PI/4))*p}}var w,T,E={WM_R:v,WM_2R:y,isUndefined:m,isString:g,isNumber:function(t){return"number"==typeof t},isObject:b,castDate:_,isSetsEqual:function(t,e){return t.size===e.size&&f()(t).every(function(t){return e.has(t)})},equalArrays:function(t,e){if(t&&e&&t.length===e.length){for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}},projectToWebMercator:x,computeMapZoom:function(t){var e=t.getBounds(),n=e.getNorthWest(),r=e.getSouthWest();return(x(n).y-x(r).y)/y},computeMapCenter:function(t){var e=x(t.getCenter());return{x:e.x/v,y:e.y/v}},computeMatrixZoom:function(t){return-2*t[15]/t[5]},computeMatrixCenter:function(t){return{x:-(1+2*t[12]/t[0]),y:+(1+2*t[13]/t[5])}}},k=n(1),A=n.n(k),C=n(2),M=n.n(C),S=n(0),R=n.n(S),D=n(3),I=n.n(D),F=n(25),N=function(t){function e(t){var n;if(A()(this,e),!t||!t.message)throw Error("Invalid CartoError, a message is mandatory");return(n=M()(this,R()(e).call(this,t.message))).name="CartoError",n.originalError=t,n}return I()(e,t),e}(n.n(F)()(Error)),O=function(t){function e(t){var n;return A()(this,e),(n=M()(this,R()(e).call(this,{message:t}))).name="CartoValidationError",n}return I()(e,t),e}(N),P={MISSING_REQUIRED:"[Missing required property]:",INCORRECT_TYPE:"[Property with an incorrect type]:",INCORRECT_VALUE:"[Incorrect value]:",TOO_MANY_ARGS:"[Too many arguments]:"};function L(t){B(t),w=t}function B(t){if(m(t))throw new O("".concat(P.MISSING_REQUIRED," 'auth'"));if(!b(t))throw new O("".concat(P.INCORRECT_TYPE," 'auth' property must be an object."));t.username=m(t.username)?t.user:t.username,function(t){if(m(t))throw new O("".concat(P.MISSING_REQUIRED," 'apiKey'"));if(!g(t))throw new O("".concat(P.INCORRECT_TYPE," 'apiKey' property must be a string."));if(""===t)throw new O("".concat(P.INCORRECT_VALUE," 'apiKey' property must be not empty."))}(t.apiKey),function(t){if(m(t))throw new O("".concat(P.MISSING_REQUIRED," 'username'"));if(!g(t))throw new O("".concat(P.INCORRECT_TYPE," 'username' property must be a string."));if(""===t)throw new O("".concat(P.INCORRECT_VALUE," 'username' property must be not empty."))}(t.username)}function U(t){z(t),T=t}function z(t){if(t){if(!b(t))throw new O("".concat(P.INCORRECT_TYPE," 'config' property must be an object."));!function(t){if(!g(t))throw new O("".concat(P.INCORRECT_TYPE," 'serverURL' property must be a string."))}(t.serverURL)}}var V=n(4),G=n.n(V),j={};function q(t,e){var n={};return new Set(Object.keys(t).concat(Object.keys(e))).forEach(function(r){var i=t[r]||[],a=e[r]||[],o=f()(i).concat(f()(a));n[r]=o}),n}function W(t){var e={};return Object.keys(t).sort().forEach(function(n){var r=f()(new Set(t[n].map(function(t){return JSON.stringify(t)})));r.sort(),r=r.map(function(t){return JSON.parse(t)}),e[n]=r}),e}var Y=new RegExp("^_cdb_agg_[a-zA-Z0-9]+_"),X={isAggregated:function(t){return t.startsWith("_cdb_agg_")},getBase:function(t){return t.replace(Y,"")},getAggFN:function(t){var e=t.substr("_cdb_agg_".length);return e.substr(0,e.indexOf("_"))},aggColumn:function(t,e){return"".concat("_cdb_agg_").concat(e,"_").concat(t)}},H={column:X,equals:function(t,e){return!(!t||!e)&&JSON.stringify(W(t))===JSON.stringify(W(e))},union:q,IDENTITY:j,simplify:W},Z=function(){function t(){A()(this,t),this.caches=new WeakMap}return G()(t,[{key:"get",value:function(t,e){if(this.caches.has(t))return this.caches.get(t)[e]}},{key:"set",value:function(t,e,n){if(this.caches.has(t)){this.caches.get(t)[e]=n}else{var r={};r[e]=n,this.caches.set(t,r)}}},{key:"has",value:function(t,e){return void 0!==this.get(t,e)}}]),t}(),Q=function(t){function e(t){var n;return A()(this,e),(n=M()(this,R()(e).call(this,{message:t}))).name="CartoRuntimeError",n}return I()(e,t),e}(N),$={NOT_SUPPORTED:"[Not supported]:",WEB_GL:"[WebGL]:",MVT:"[MVT]:"},J=1,K=new Z,tt=new Z;function et(t,e,n){var r=e+n;if(tt.has(t,r))return tt.get(t,r);var i={},a=nt(t,e,t.VERTEX_SHADER),o=nt(t,n,t.FRAGMENT_SHADER);if(i.program=t.createProgram(),t.attachShader(i.program,a),t.attachShader(i.program,o),t.linkProgram(i.program),t.deleteShader(a),t.deleteShader(o),!t.getProgramParameter(i.program,t.LINK_STATUS))throw new Q("".concat($.WEB_GL," Unable to link the shader program: ").concat(t.getProgramInfoLog(i.program),"."));return i.programID=J++,tt.set(t,r,i),i}function nt(t,e,n){if(K.has(t,e))return K.get(t,e);var r=t.createShader(n);if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var i=t.getShaderInfoLog(r);throw t.deleteShader(r),new Q("".concat($.WEB_GL," An error occurred compiling the shaders: ").concat(i,"\nSource:\n").concat(e))}return K.set(t,e,r),r}var rt=n(48),it=n.n(rt),at=n(47),ot=n.n(at),ut=n(49),st=n.n(ut),ct=n(20),ft=n.n(ct),lt=n(19),ht=n.n(lt),dt={vertexShader:"".concat(ht.a),fragmentShader:"".concat(ft.a).replace("$style_inline","$color_inline").replace("$style_preface","$color_preface")},pt={vertexShader:"".concat(ht.a),fragmentShader:"".concat(ft.a).replace("$style_inline","vec4($filter_inline)").replace("$style_preface","$filter_preface")},vt={vertexShader:"".concat(ht.a),fragmentShader:"".concat(ft.a).replace("$style_inline","vec4(encodeWidth($width_inline), vec2(0.))").replace("$style_preface","".concat(st.a))},yt=n(51),mt=n.n(yt),gt=n(50),bt={vertexShader:"".concat(n.n(gt).a),fragmentShader:"".concat(mt.a)},_t={styler:r,symbolizer:i,AABlender:function t(e){A()(this,t),Object.assign(this,et(e,ot.a,it.a)),this.vertexAttribute=e.getAttribLocation(this.program,"vertex"),this.readTU=e.getUniformLocation(this.program,"aaTex")}},xt=function(){function t(){A()(this,t),this._ids=new Map}return G()(t,[{key:"getID",value:function(t){if(this._ids.has(t))return this._ids.get(t);var e=this._ids.size;return this._ids.set(t,e),e}}]),t}();function wt(t,e,n,r){var i={},a=function(t){return void 0===i[t]&&(i[t]=Object.keys(i).length),"texture2D(propertyTex".concat(i[t],", abs(featureID)).a")},o={},u=new xt;Object.keys(n).forEach(function(t){var e=n[t];e._setUID(u);var r=e._applyToShaderSource(a);o[t+"_preface"]=r.preface,o[t+"_inline"]=r.inline}),o.propertyPreface=Object.keys(i).map(function(t){return"uniform sampler2D propertyTex".concat(i[t],";")}).join("\n");var s=function(t,e,n){var r=e.vertexShader,i=e.fragmentShader;Object.keys(n).forEach(function(t){r=r.replace("$"+t,n[t]),i=i.replace("$"+t,n[t])});var a=et(t,r,i);return a.vertexPositionAttribute=t.getAttribLocation(a.program,"vertexPosition"),a.featureIdAttr=t.getAttribLocation(a.program,"featureID"),a.normalAttr=t.getAttribLocation(a.program,"normal"),a.colorTexture=t.getUniformLocation(a.program,"colorTex"),a.strokeColorTexture=t.getUniformLocation(a.program,"strokeColorTex"),a.strokeWidthTexture=t.getUniformLocation(a.program,"strokeWidthTex"),a.widthTexture=t.getUniformLocation(a.program,"widthTex"),a.orderMinWidth=t.getUniformLocation(a.program,"orderMinWidth"),a.orderMaxWidth=t.getUniformLocation(a.program,"orderMaxWidth"),a.filterTexture=t.getUniformLocation(a.program,"filterTex"),a.normalScale=t.getUniformLocation(a.program,"normalScale"),a.resolution=t.getUniformLocation(a.program,"resolution"),a.matrix=t.getUniformLocation(a.program,"matrix"),a}(t,e,o);return Object.keys(i).map(function(e){i[e]=t.getUniformLocation(s.program,"propertyTex".concat(i[e]))}),Object.values(n).forEach(function(e){e._postShaderCompile(s.program,t)}),s.textureIds||(s.textureIds=new Map),s.textureIds.set(r,i),s._codes=o,s._template=e,s}var Tt=n(6),Et=n.n(Tt),kt=function(t){function e(t){var n;return A()(this,e),(n=M()(this,R()(e).call(this,{message:t}))).name="CartoParsingError",n}return I()(e,t),e}(N);function At(t){return function(t){var e=t.x,n=t.y,r=t.z,i=t.a,a=Mt,o=St,u=Rt,s=function(t){return t>=.008856451679035631?Math.pow(t,.333333333333333):841/108*t+4/29};return{l:116*s(n/o)-16,a:500*(s(e/a)-s(n/o)),b:200*(s(n/o)-s(r/u)),alpha:i}}(function(t){var e=function(t){var e=t.r,n=t.g,r=t.b,i=t.a,a=function(t){return t<=.0404482362771076?t/12.92:Math.pow((t+.055)/1.055,2.4)};return{r:a(e),g:a(n),b:a(r),a:i}}(t),n=e.r,r=e.g,i=e.b,a=e.a;return{x:.41239558896741424*n+.3575834307637148*r+.18049264738170157*i,y:.21258623078559555*n+.7151703037034108*r+.07220049864333623*i,z:.019297215491746945*n+.11918386458084854*r+.9504971251315798*i,a:a}}(t))}function Ct(t){return function(t){var e=t.x,n=t.y,r=t.z,i=t.a,a=jt(3.2406*e-1.5372*n-.4986*r,0,1),o=jt(-.9689*e+1.8758*n+.0415*r,0,1),u=jt(.0557*e-.204*n+1.057*r,0,1);return function(t){var e=t.r,n=t.g,r=t.b,i=t.a,a=function(t){return t<=.0031306684425005883?12.92*t:1.055*Math.pow(t,.4166666666666667)-.055};return{r:a(e),g:a(n),b:a(r),a:i}}({r:a,g:o,b:u,a:i})}(function(t){var e=t.l,n=t.a,r=t.b,i=t.alpha,a=function(t){return t>=.20689655172413793?t*t*t:108/841*(t-4/29)};return{x:Mt*a((e+16)/116+n/500),y:St*a((e+16)/116),z:Rt*a((e+16)/116-r/200),a:i}}(t))}var Mt=.950456,St=1,Rt=1.088754;function Dt(t,e,n){if(t.length>e)throw new O("".concat(P.TOO_MANY_ARGS," Expression '").concat(n,"' accepts ").concat(e," arguments, but ").concat(t.length," were passed."))}function It(t){return Wt(t)?_a(t):"string"==typeof t?La(t):Array.isArray(t)?ma(t):t}function Ft(t){var e=/^#?([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i.exec(t);if(e)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:1};if(e=/^#?([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i.exec(t))return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:parseInt(e[4]+e[4],16)/255};if(e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t))return{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16),a:1};if(e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t))return{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16),a:parseInt(e[4],16)/255};throw new kt("Invalid hexadecimal color")}function Nt(t){return{1:"first",2:"second",3:"third",4:"fourth"}[t]||String(t)}function Ot(t,e,n){return"".concat(t,"(): invalid ").concat(Nt(n+1)," parameter '").concat(e,"'")}function Pt(t,e,n,r){if(!(r instanceof Yt))throw new O("".concat(P.INCORRECT_TYPE," ").concat(Ot(t,e,n),"\n        '").concat(r,'\' is not of type "carto.expressions.Base"'))}function Lt(t,e,n,r,i){if(Pt(t,e,n,i),Array.isArray(r)){if(!r.some(function(t){return i.type===t}))throw new O("".concat(P.INCORRECT_TYPE," ").concat(Ot(t,e,n),"\n            expected type was one of ").concat(r.join(),", actual type was '").concat(i.type,"'"))}else i.type!==r&&function(t,e,n,r,i){throw new O("".concat(P.INCORRECT_TYPE," ").concat(Ot(t,e,n),"\n    expected type was '").concat(r,"', actual type was '").concat(i,"'"))}(t,e,n,r,i.type)}function Bt(t,e,n,r,i){Pt(t,e,n,i),i.isA(r)||function(t,e,n,r){throw new O("".concat(P.INCORRECT_TYPE," ").concat(Ot(t,e,n),"\n    expected type was instance of '").concat(r.name,"'"))}(t,e,n,r)}function Ut(t,e,n,r){Wt(r)||function(t,e,n,r){throw new O("".concat(P.INCORRECT_TYPE," ").concat(Ot(t,e,n),"\n    type of '").concat(r,"' is ").concat(h()(r),", 'number' was expected"))}(t,e,n,r)}function zt(t,e,n,r){"string"!=typeof r&&function(t,e,n,r){throw new O("".concat(P.INCORRECT_TYPE," ").concat(Ot(t,e,n),"\n    expected type was 'string', but ").concat(r,"' is not a string"))}(t,e,n,r)}function Vt(t,e,n,r){Array.isArray(r)||function(t,e,n,r){throw new O("".concat(P.INCORRECT_TYPE," ").concat(Ot(t,e,n),"\n    '").concat(r,"' is not an array"))}(t,e,n,r)}function Gt(t,e,n,r){if(r.isFeatureDependent())throw new O("".concat(P.INCORRECT_VALUE," ").concat(Ot(t,e,n),"\n        parameter cannot be feature dependent"))}function jt(t,e,n){return Math.min(Math.max(t,e),n)}function qt(t,e,n){return"number"==typeof t?t*(1-n)+e*n:function(t,e,n){var r=At({r:t.r/255,g:t.g/255,b:t.b/255,a:t.a}),i=At({r:e.r/255,g:e.g/255,b:e.b/255,a:e.a}),a=Ct({l:(1-n)*r.l+n*i.l,a:(1-n)*r.a+n*i.a,b:(1-n)*r.b+n*i.b,alpha:(1-n)*r.alpha+n*i.alpha});return{r:Math.round(255*a.r),g:Math.round(255*a.g),b:Math.round(255*a.b),a:a.a}}(t,e,n)}function Wt(t){return Number.isFinite(t)||t===1/0||t===-1/0||Number.isNaN(t)}var Yt=function(){function t(e){A()(this,t),this._initializeChildren(e),this._addParentToChildren(),this.preface="",this._shaderBindings=new Map,this.expressionName=function(t){if(t.toUpperCase()===t)return t.toLowerCase();return t.charAt(0).toLowerCase()+t.slice(1)}(this.constructor.name)}return G()(t,[{key:"eval",value:function(t){throw new Q("Unimplemented")}},{key:"toString",value:function(){return"".concat(this.expressionName,"(").concat(this._getChildren().map(function(t){return t.toString()}).join(", "),")")}},{key:"isAnimated",value:function(){return this._getChildren().some(function(t){return t.isAnimated()})}},{key:"blendTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;t=It(t);var n=this.parent,r=$i(this,t,Ci(e));return n.replaceChild(this,r),r.notify(),t}},{key:"isA",value:function(t){return this instanceof t}},{key:"notify",value:function(){this.parent.notify()}},{key:"accumViewportAgg",value:function(t){this._getChildren().forEach(function(e){return e.accumViewportAgg(t)})}},{key:"loadImages",value:function(){return Promise.all(this._getChildren().map(function(t){return t.loadImages()}))}},{key:"_bindMetadata",value:function(t){this._getChildren().forEach(function(e){return e._bindMetadata(t)})}},{key:"_initializeChildren",value:function(t){Array.isArray(t)?this._initializeChildrenArray(t):this._initializeChildrenObject(t)}},{key:"_initializeChildrenArray",value:function(t){var e=this;if(this.maxParameters&&this.maxParameters<t.length)throw new O("".concat(P.TOO_MANY_ARGS," Extra parameters, got ").concat(t.length," but maximum is ").concat(this.maxParameters));this.childrenNames=[],t.map(function(t,n){var r="".concat(t.type,"-").concat(n);e.childrenNames.push(r),e[r]=It(t)})}},{key:"_initializeChildrenObject",value:function(t){var e=this;if(this.childrenNames=Object.keys(t),this.maxParameters&&this.maxParameters<this.childrenNames.length)throw new O("".concat(P.TOO_MANY_ARGS," Extra parameters, got ").concat(this.childrenNames.length," but maximum is ").concat(this.maxParameters));Object.keys(t).map(function(n){e[n]=It(t[n])})}},{key:"_addParentToChildren",value:function(){var t=this;this._getChildren().map(function(e){e.parent=t})}},{key:"_setUID",value:function(t){this._uid=t.getID(this),this._getChildren().map(function(e){return e._setUID(t)})}},{key:"_dataReady",value:function(){this._getChildren().map(function(t){return t._dataReady()})}},{key:"isFeatureDependent",value:function(){return this._getChildren().some(function(t){return t.isFeatureDependent()})}},{key:"_prefaceCode",value:function(t){return t?"\n".concat(this._buildGLSLCode(t),"\n"):""}},{key:"_buildGLSLCode",value:function(t){return"\n            #ifndef DEF_".concat(this._uid,"\n            #define DEF_").concat(this._uid,"\n            ").concat(t,"\n            #endif")}},{key:"_getDependencies",value:function(){return this._getChildren().map(function(t){return t._getDependencies()}).reduce(function(t,e){return t.concat(e)},[])}},{key:"_resolveAliases",value:function(t){this._getChildren().map(function(e){return e._resolveAliases(t)})}},{key:"_setGenericGLSL",value:function(t,e){this.inlineMaker=t,this.preface=e||""}},{key:"_applyToShaderSource",value:function(t){var e=this,n=this.childrenNames.map(function(n){return e[n]._applyToShaderSource(t)}),r={};return n.map(function(t,n){r[e.childrenNames[n]]=t.inline}),{preface:this._prefaceCode(n.map(function(t){return t.preface}).reduce(function(t,e){return t+e},"")+this.preface),inline:this.inlineMaker(r,t)}}},{key:"_postShaderCompile",value:function(t,e){var n=this;this.childrenNames.forEach(function(r){return n[r]._postShaderCompile(t,e)})}},{key:"_getBinding",value:function(t){return this._shaderBindings.has(t)||this._shaderBindings.set(t,{}),this._shaderBindings.get(t)}},{key:"_resetViewportAgg",value:function(t){this._getChildren().forEach(function(e){return e._resetViewportAgg(t)})}},{key:"_setTimestamp",value:function(t){var e=this;this.childrenNames.forEach(function(n){return e[n]._setTimestamp(t)})}},{key:"_preDraw",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.childrenNames.forEach(function(e){var r;return(r=t[e])._preDraw.apply(r,n)})}},{key:"replaceChild",value:function(t,e){var n=this;this[this.childrenNames.find(function(e){return n[e]===t})]=e,e.parent=this,e.notify=t.notify}},{key:"_blendFrom",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.default||!t.default){t=It(t);var r=this.parent,i=$i(t,this,Ci(e),n);r.replaceChild(this,i),i.notify()}}},{key:"_getChildren",value:function(){var t=this;return this.childrenNames.map(function(e){return t[e]})}},{key:"_getMinimumNeededSchema",value:function(){return this._getChildren().map(function(t){return t._getMinimumNeededSchema()}).reduce(q,j)}},{key:"value",get:function(){return this.eval()}}]),t}();var Xt=function(t){function e(t){var n;if(A()(this,e),Dt(arguments,1,"transition"),Ut("transition","duration",0,t),t<0){var r=Ot("transition","duration",0);throw new O("".concat(P.INCORRECT_VALUE," ").concat(r," 'duration' must be greater than or equal to 0."))}return(n=M()(this,R()(e).call(this,{}))).aTime=Date.now(),n.bTime=n.aTime+Number(t),n.type="number",n}return I()(e,t),G()(e,[{key:"eval",value:function(){var t=Date.now();return this.mix=(t-this.aTime)/(this.bTime-this.aTime),Math.min(this.mix,1)}},{key:"isAnimated",value:function(){return!this.mix||this.mix<=1}},{key:"_applyToShaderSource",value:function(){return{preface:this._prefaceCode("uniform float anim".concat(this._uid,";\n")),inline:"anim".concat(this._uid)}}},{key:"_postShaderCompile",value:function(t,e){this._getBinding(t).uniformLocation=e.getUniformLocation(t,"anim".concat(this._uid))}},{key:"_preDraw",value:function(t,e,n){var r=Date.now();this.mix=(r-this.aTime)/(this.bTime-this.aTime),this.mix>1?n.uniform1f(this._getBinding(t).uniformLocation,1):n.uniform1f(this._getBinding(t).uniformLocation,this.mix)}}]),e}(Yt),Ht=n(5),Zt=n.n(Ht),Qt=Jt("in",function(t){if(0===t.length)return function(){return"0."};return function(e){return"((".concat(t.map(function(t,n){return"(".concat(e.input," == ").concat(e.list[n],")")}).join(" || "),")? 1.: 0.)")}},function(t,e){return e.some(function(e){return e===t})?1:0});var $t=Jt("nin",function(t){if(0===t.length)return function(){return"1."};return function(e){return"((".concat(t.map(function(t,n){return"(".concat(e.input," != ").concat(e.list[n],")")}).join(" && "),")? 1.: 0.)")}},function(t,e){return e.some(function(e){return e===t})?0:1});function Jt(t,e,n){return function(r){function i(n,r){var a;return A()(this,i),Dt(arguments,2,t),n=It(n),r=It(r),Pt(t,"input",0,n),Pt(t,"list",1,r),(a=M()(this,R()(i).call(this,{input:n,list:r}))).inlineMaker=e(a.list.elems),a.type="number",a}return I()(i,r),G()(i,[{key:"eval",value:function(t){return n(this.input.eval(t),this.list.eval(t))}},{key:"_bindMetadata",value:function(e){Zt()(R()(i.prototype),"_bindMetadata",this).call(this,e),Lt(t,"input",0,"category",this.input),Lt(t,"list",1,"category-list",this.list)}}]),i}(Yt)}var Kt=function(t){function e(t,n,r){var i;return A()(this,e),Dt(arguments,3,"between"),t=It(t),n=It(n),r=It(r),(i=M()(this,R()(e).call(this,{input:t,lowerLimit:n,upperLimit:r}))).type="number",i.inlineMaker=function(t){return"((".concat(t.input," >= ").concat(t.lowerLimit," &&  ").concat(t.input," <= ").concat(t.upperLimit,") ? 1. : 0.)")},i}return I()(e,t),G()(e,[{key:"eval",value:function(t){var e=this.input.eval(t),n=this.lowerLimit.eval(t),r=this.upperLimit.eval(t);return e>=n&&e<=r?1:0}},{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("between","input",0,"number",this.input),Lt("between","lowerLimit",1,"number",this.lowerLimit),Lt("between","upperLimit",2,"number",this.upperLimit)}}]),e}(Yt),te=0,ee=1,ne=2,re=4,ie=8,ae=16,oe=_e("mul",ee|ne|re|ae,function(t,e){return t*e},function(t,e){return"(".concat(t," * ").concat(e,")")}),ue=_e("div",ee|ne|re|ae,function(t,e){return t/e},function(t,e){return"(".concat(t," / ").concat(e,")")}),se=_e("add",ee|re|ae,function(t,e){return t+e},function(t,e){return"(".concat(t," + ").concat(e,")")}),ce=_e("sub",ee|re|ae,function(t,e){return t-e},function(t,e){return"(".concat(t," - ").concat(e,")")}),fe=_e("mod",ee,function(t,e){return t%e},function(t,e){return"mod(".concat(t,", ").concat(e,")")}),le=_e("pow",ee,function(t,e){return Math.pow(t,e)},function(t,e){return"pow(".concat(t,", ").concat(e,")")}),he=_e("greaterThan",ee,function(t,e){return t>e?1:0},function(t,e){return"(".concat(t,">").concat(e,"? 1.:0.)")}),de=_e("greaterThanOrEqualTo",ee,function(t,e){return t>=e?1:0},function(t,e){return"(".concat(t,">=").concat(e,"? 1.:0.)")}),pe=_e("lessThan",ee,function(t,e){return t<e?1:0},function(t,e){return"(".concat(t,"<").concat(e,"? 1.:0.)")}),ve=_e("lessThanOrEqualTo",ee,function(t,e){return t<=e?1:0},function(t,e){return"(".concat(t,"<=").concat(e,"? 1.:0.)")}),ye=_e("equals",ee|ie,function(t,e){return t===e?1:0},function(t,e){return"(".concat(t,"==").concat(e,"? 1.:0.)")}),me=_e("notEquals",ee|ie,function(t,e){return t!==e?1:0},function(t,e){return"(".concat(t,"!=").concat(e,"? 1.:0.)")}),ge=_e("or",ee,function(t,e){return Math.min(t+e,1)},function(t,e){return"min(".concat(t," + ").concat(e,", 1.)")}),be=_e("and",ee,function(t,e){return Math.min(t*e,1)},function(t,e){return"min(".concat(t," * ").concat(e,", 1.)")});function _e(t,e,n,r){return function(i){function a(e,i){var o;if(A()(this,a),Dt(arguments,2,t),Number.isFinite(e)&&Number.isFinite(i))return M()(o,_a(n(e,i)));var u=function(t,e){if(t.type&&e.type)return"number"===t.type&&"number"===e.type?ee:"number"===t.type&&"color"===e.type?ne:"color"===t.type&&"number"===e.type?ne:"color"===t.type&&"color"===e.type?re:"category"===t.type&&"category"===e.type?ie:"image"===t.type&&"color"===e.type||"image"===t.type&&"color"===e.type||"image"===t.type&&"image"===e.type||"color"===t.type&&"image"===e.type?ae:te;if(!t.type&&!e.type)return;var n=t.type||e.type;if("color"===n)return ne}(e=It(e),i=It(i));return(o=M()(this,R()(a).call(this,{a:e,b:i}))).expressionName=t,o.type=xe(u),o.inlineMaker=function(t){return r(t.a,t.b)},o}return I()(a,i),G()(a,[{key:"eval",value:function(t){return n(this.a.eval(t),this.b.eval(t))}},{key:"_bindMetadata",value:function(n){Zt()(R()(a.prototype),"_bindMetadata",this).call(this,n);var r=[this.a,this.b],i=r[0],o=r[1],u=function(t,e){return t.type&&e.type?"number"===t.type&&"number"===e.type?ee:"number"===t.type&&"color"===e.type?ne:"color"===t.type&&"number"===e.type?ne:"color"===t.type&&"color"===e.type?re:"category"===t.type&&"category"===e.type?ie:"image"===t.type&&"color"===e.type||"image"===t.type&&"color"===e.type||"image"===t.type&&"image"===e.type||"color"===t.type&&"image"===e.type?ae:te:void 0}(i,o);if(u===te||!(u&e))throw new O("".concat(P.INCORRECT_TYPE," ").concat(t,"(): invalid parameter types\n'x' type was ").concat(i.type,", 'y' type was ").concat(o.type));this.type=xe(u)}},{key:"value",get:function(){return this.eval()}}]),a}(Yt)}function xe(t){switch(t){case ee:return"number";case ne:case re:return"color";case ie:return"number";case ae:return"image";default:return}}var we=function(t){function e(t,n,r,i){var a;A()(this,e),Dt(arguments,4,"blend"),t=It(t),n=It(n),r=It(r),Pt("blend","a",0,t),Pt("blend","b",1,n),Pt("blend","mix",2,r),t.type&&n.type&&Te(t,n);var o=r;return i&&(r=i(r)),(a=M()(this,R()(e).call(this,{a:t,b:n,mix:r}))).originalMix=o,t.type&&n.type&&(a.type=t.type),a.inlineMaker=function(t){return"mix(".concat(t.a,", ").concat(t.b,", clamp(").concat(t.mix,", 0., 1.))")},a}return I()(e,t),G()(e,[{key:"eval",value:function(t){var e=jt(this.mix.eval(t),0,1);return qt(this.a.eval(t),this.b.eval(t),e)}},{key:"replaceChild",value:function(t,n){t===this.mix&&(this.originalMix=n),Zt()(R()(e.prototype),"replaceChild",this).call(this,t,n)}},{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Te(this.a,this.b),Lt("blend","mix",2,"number",this.mix),this.type=this.a.type}},{key:"_preDraw",value:function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=Zt()(R()(e.prototype),"_preDraw",this)).call.apply(t,[this].concat(r)),this.originalMix.isA(Xt)&&!this.originalMix.isAnimated()&&(this.parent.replaceChild(this,this.b),this.notify())}}]),e}(Yt);function Te(t,e){if(t.type!==e.type||!["number","color","image","placement"].includes(t.type))throw new O("".concat(P.INCORRECT_TYPE," blend(): invalid parameter types\n\t'a' type was '").concat(t.type,"'\n\t'b' type was '").concat(e.type,"'"))}var Ee="DEFAULT_RAMP_OTHERS",ke=-1,Ae={othersLabel:"CARTO_VL_OTHERS",samples:10},Ce=function(t){function e(t,n){var r;A()(this,e),Dt(arguments,2,"buckets");var i={input:t=It(t),list:n=It(n)};return(r=M()(this,R()(e).call(this,i))).numCategories=null,r.numCategoriesWithoutOthers=null,r.type="category",r}return I()(e,t),G()(e,[{key:"eval",value:function(t){var e=this.input.eval(t),n=this.numCategoriesWithoutOthers-1||1;if("category"===this.input.type){for(var r=0;r<this.list.elems.length;r++)if(e===this.list.elems[r].eval(t))return r/n;return ke}for(var i=0;i<this.list.elems.length;i++)if(e<this.list.elems[i].eval(t))return i/n;return 1}},{key:"_bindMetadata",value:function(t){var n=this;if(Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),"number"!==this.input.type&&"category"!==this.input.type)throw new O("".concat(P.INCORRECT_TYPE," buckets(): invalid first parameter type\n\t'input' type was ").concat(this.input.type));Lt("buckets","list",1,["number-list","category-list"],this.list),this.list.elems.map(function(t,e){if(n.input.type!==t.type)throw new O("".concat(P.INCORRECT_TYPE," buckets(): invalid ").concat(Nt(e+1)," parameter type")+"\n\texpected type was ".concat(n.input.type,"\n\tactual type was ").concat(t.type));if("number"!==t.type&&"category"!==t.type)throw new O("".concat(P.INCORRECT_TYPE," buckets(): invalid ").concat(Nt(e+1)," parameter type\n\ttype was ").concat(t.type))}),this.numCategories=this.list.elems.length+1,this.numCategoriesWithoutOthers="category"===this.input.type?this.numCategories-1:this.numCategories}},{key:"_applyToShaderSource",value:function(t){var e=this,n={};this.childrenNames.map(function(n){return e[n]._applyToShaderSource(t)}).map(function(t,r){n[e.childrenNames[r]]=t});var r="buckets".concat(this._uid),i="category"===this.input.type?"==":"<",a=this.numCategoriesWithoutOthers-1||1,o=this.list.elems.map(function(t,e){return"".concat(e>0?"else":""," if (x").concat(i,"(").concat(n.list.inline[e],")){\n                return ").concat(e,"./").concat(a.toFixed(20),";\n            }")}).join(""),u="float ".concat(r,"(float x){\n            ").concat(o,"\n            return ").concat("category"===this.input.type?"(-1.)":(this.numCategories-1).toFixed(20),";\n        }");return{preface:this._prefaceCode(n.input.preface+n.list.preface+u),inline:"".concat(r,"(").concat(n.input.inline,")")}}},{key:"_getLegendData",value:function(t){var e=this.toString(),n=this.list.elems.map(function(t){return t.eval()});return{data:"number"===this.input.type?function(t){for(var e=[],n=0;n<=t.length;n++){var r=n-1>=0?t[n-1]:Number.NEGATIVE_INFINITY,i=n<t.length?t[n]:Number.POSITIVE_INFINITY,a=[r,i],o=n/t.length;e.push({key:a,value:o})}return e}(n):function(t,e){var n=t.length-1,r=t.map(function(t,e){var r=t,i=e/n;return{key:r,value:i}});return r.push({key:e.othersLabel,value:ke}),r}(n,t),name:e}}}]),e}(Yt);var Me=function(t){function e(t){var n;return A()(this,e),Dt(arguments,1,"category"),zt("category","categoryName",0,t),(n=M()(this,R()(e).call(this,{}))).expr=t,n.type="category",n}return I()(e,t),G()(e,[{key:"eval",value:function(){return this.expr}},{key:"isAnimated",value:function(){return!1}},{key:"_bindMetadata",value:function(t){this._metadata=t}},{key:"_applyToShaderSource",value:function(){return{preface:this._prefaceCode("uniform float cat".concat(this._uid,";\n")),inline:"cat".concat(this._uid)}}},{key:"_postShaderCompile",value:function(t,e){this._getBinding(t).uniformLocation=e.getUniformLocation(t,"cat".concat(this._uid))}},{key:"_preDraw",value:function(t,e,n){var r=this._metadata.categoryToID.get(this.expr);n.uniform1f(this._getBinding(t).uniformLocation,r)}},{key:"value",get:function(){return this.expr}}]),e}(Yt),Se=n(17),Re=n.n(Se),De=function(t){function e(t,n,r){var i;return A()(this,e),Dt(arguments,3,"cielab"),t=It(t),n=It(n),r=It(r),Pt("cielab","l",0,t),Pt("cielab","a",1,n),Pt("cielab","b",2,r),(i=M()(this,R()(e).call(this,{l:t,a:n,b:r}))).type="color",i._setGenericGLSL(function(t){return"cielabToSRGBA(vec4(".concat(t.l,", ").concat(t.a,", ").concat(t.b,", 1.))")},Re.a),i}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("cielab","l",0,"number",this.l),Lt("cielab","a",1,"number",this.a),Lt("cielab","b",2,"number",this.b)}}]),e}(Yt),Ie=n(14),Fe=n.n(Ie),Ne=n(11),Oe=n.n(Ne),Pe=function(t){function e(t){var n;if(A()(this,e),Dt(arguments,1,"property"),zt("property","name",0,t),""===t)throw new O("".concat(P.INCORRECT_VALUE," property(): invalid parameter, zero-length string"));return(n=M()(this,R()(e).call(this,{}))).name=t,n.expressionName=t,Zt()(R()(e.prototype),"_setGenericGLSL",Oe()(n)).call(Oe()(n),function(t,e){return e(n.name)}),n}return I()(e,t),G()(e,[{key:"isFeatureDependent",value:function(){return!0}},{key:"eval",value:function(t){if(!t)throw new O("".concat(P.MISSING_REQUIRED," A property needs to be evaluated in a 'feature'."));return t[this.name]&&t[this.name]===Number.MIN_SAFE_INTEGER?Number.NaN:t[this.name]}},{key:"toString",value:function(){return"$".concat(this.expressionName)}},{key:"_bindMetadata",value:function(t){var e=t.properties[this.name];if(!e)throw new O("".concat(P.MISSING_REQUIRED," Property '").concat(this.name,"' does not exist"));this._metadata=t,this.type=e.type,"category"!==this.type||this.numCategories||Object.defineProperty(this,"numCategories",{get:function(){return e.categories.length}})}},{key:"_applyToShaderSource",value:function(t){return{preface:"",inline:t(this.name)}}},{key:"_getMinimumNeededSchema",value:function(){return Fe()({},this.name,[{type:"unaggregated"}])}},{key:"value",get:function(){return this.eval()}},{key:"categories",get:function(){return"category"===this.type?this._metadata.properties[this.name].categories:void 0}}]),e}(Yt),Le=function(t){function e(t){var n,r=t.property,i=t.expressionName,a=t.aggName,o=t.aggType;return A()(this,e),Pt(i,"property",0,r),(n=M()(this,R()(e).call(this,{property:r})))._aggName=a,n._expressionName=i,n.type=o,n}return I()(e,t),G()(e,[{key:"eval",value:function(t){return t[X.aggColumn(this.property.name,this._aggName)]}},{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Bt(this._expressionName,"property",0,Pe,this.property),Lt(this._expressionName,"property",0,this.type,this.property)}},{key:"_resolveAliases",value:function(){}},{key:"_applyToShaderSource",value:function(t){return{preface:"",inline:"".concat(t(X.aggColumn(this.property.name,this._aggName)))}}},{key:"_postShaderCompile",value:function(){}},{key:"_getMinimumNeededSchema",value:function(){return Fe()({},this.property.name,[{type:"aggregated",op:this._aggName}])}},{key:"name",get:function(){return this.property.name}},{key:"aggName",get:function(){return this._aggName}},{key:"numCategories",get:function(){return this.property.numCategories}},{key:"categories",get:function(){return this.property.categories}}]),e}(Yt),Be=function(t){function e(t){return A()(this,e),Dt(arguments,1,"clusterAvg"),M()(this,R()(e).call(this,{property:t,expressionName:"clusterAvg",aggName:"avg",aggType:"number"}))}return I()(e,t),e}(Le),Ue=function(t){function e(t){return A()(this,e),Dt(arguments,1,"clusterMax"),M()(this,R()(e).call(this,{property:t,expressionName:"clusterMax",aggName:"max",aggType:"number"}))}return I()(e,t),e}(Le),ze=function(t){function e(t){return A()(this,e),Dt(arguments,1,"clusterMin"),M()(this,R()(e).call(this,{property:t,expressionName:"clusterMin",aggName:"min",aggType:"number"}))}return I()(e,t),e}(Le),Ve=function(t){function e(t){return A()(this,e),Dt(arguments,1,"clusterMode"),M()(this,R()(e).call(this,{property:t,expressionName:"clusterMode",aggName:"mode",aggType:"category"}))}return I()(e,t),e}(Le),Ge=function(t){function e(t){return A()(this,e),Dt(arguments,1,"clusterSum"),M()(this,R()(e).call(this,{property:t,expressionName:"clusterSum",aggName:"sum",aggType:"number"}))}return I()(e,t),e}(Le),je=function(t){function e(){var t;return A()(this,e),Dt(arguments,0,"clusterCount"),(t=M()(this,R()(e).call(this,{}))).type="number",t._hasClusterFeatureCount=!1,t}return I()(e,t),G()(e,[{key:"eval",value:function(t){return Number(t._cdb_feature_count)||1}},{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),this._hasClusterFeatureCount=void 0!==t.properties._cdb_feature_count}},{key:"_applyToShaderSource",value:function(t){return{preface:"",inline:this._hasClusterFeatureCount?t("_cdb_feature_count"):"1."}}}]),e}(Yt),qe=function(t){function e(t){var n;return A()(this,e),Dt(arguments,1,"constant"),Ut("constant","x",0,t),(n=M()(this,R()(e).call(this,{}))).expr=t,n.type="number",n.inlineMaker=function(){return"(".concat(t.toFixed(20),")")},n}return I()(e,t),G()(e,[{key:"toString",value:function(){return this.expr}},{key:"eval",value:function(){return this.expr}},{key:"value",get:function(){return this.eval()}}]),e}(Yt),We=function(t){function e(t){var n;A()(this,e),Dt(arguments,1,"hex"),zt("hex","hexadecimalColor",0,t),(n=M()(this,R()(e).call(this,{}))).type="color";try{n.color=Ft(t)}catch(t){var r=Ot("hex","hexadecimalColor",0);throw new O("".concat(P.INCORRECT_VALUE," ").concat(r," \nInvalid hexadecimal color string"))}return n.hexadecimalColor=t,n.inlineMaker=function(){return"vec4(".concat((n.color.r/255).toFixed(4),", ").concat((n.color.g/255).toFixed(4),", ").concat((n.color.b/255).toFixed(4),", ").concat(n.color.a.toFixed(4),")")},n}return I()(e,t),G()(e,[{key:"toString",value:function(){return this.hexadecimalColor}},{key:"eval",value:function(){return this.color}},{key:"value",get:function(){return this.eval()}}]),e}(Yt),Ye=n(12),Xe=n.n(Ye),He=Qe("hsl",!1),Ze=Qe("hsla",!0);function Qe(t,e){return function(r){function i(n,r,a,o){var u;A()(this,i),Dt(arguments,4,"hsla");var s=[n,r,a,o].map(It),c=Xe()(s,4);n=c[0],r=c[1],a=c[2],o=c[3];var f={h:n,s:r,l:a};return e&&(Pt(t,"a",3,o),f.a=o),Pt(t,"h",0,n),Pt(t,"s",1,r),Pt(t,"l",2,a),(u=M()(this,R()(i).call(this,f))).type="color",u}return I()(i,r),G()(i,[{key:"eval",value:function(t){var n=this,r=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"category"===e.type?e.eval(t)/(n?e.numCategories+1:e.numCategories):e.eval(t)};return function(r,i,a){var o={r:Math.abs(6*r-3)-1,g:2-Math.abs(6*r-2),b:2-Math.abs(6*r-4),a:e?n.a.eval(t):1},u=(1-Math.abs(2*a-1))*i;return o.r=jt(o.r,0,1),o.g=jt(o.g,0,1),o.b=jt(o.b,0,1),o.r=255*((o.r-.5)*u+a),o.g=255*((o.g-.5)*u+a),o.b=255*((o.b-.5)*u+a),o}(jt(r(this.h,!0),0,1),jt(r(this.s),0,1),jt(r(this.l),0,1))}},{key:"_bindMetadata",value:function(t){var r=this;Zt()(R()(i.prototype),"_bindMetadata",this).call(this,t),n("h",0,this.h),n("s",1,this.s),n("l",2,this.l),e&&Lt("hsla","a",3,"number",this.a);var a=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"category"===t.type?"/".concat(e?t.numCategories+1:t.numCategories,"."):""};Zt()(R()(i.prototype),"_setGenericGLSL",this).call(this,function(t){return"vec4(HSLtoRGB(vec3(\n                    ".concat(t.h).concat(a(r.h,!0),",\n                    clamp(").concat(t.s).concat(a(r.s),", 0., 1.),\n                    clamp(").concat(t.l).concat(a(r.l),", 0., 1.)\n                )), ").concat(e?"clamp(".concat(t.a,", 0., 1.)"):"1.",")")},"\n    #ifndef HSL2RGB\n    #define HSL2RGB\n    vec3 HSLtoRGB(vec3 HSL) {\n      float R = abs(HSL.x * 6. - 3.) - 1.;\n      float G = 2. - abs(HSL.x * 6. - 2.);\n      float B = 2. - abs(HSL.x * 6. - 4.);\n      float C = (1. - abs(2. * HSL.z - 1.)) * HSL.y;\n      vec3 RGB = clamp(vec3(R,G,B), 0., 1.);\n      return (RGB - 0.5) * C + HSL.z;\n    }\n    #endif\n    ")}},{key:"value",get:function(){return this.eval()}}]),i}(Yt);function n(e,n,r){if(Pt(t,e,n,r),"number"!==r.type&&"category"!==r.type&&void 0!==r.type)throw new O("".concat(P.INCORRECT_TYPE," ").concat(t,"(): invalid parameter\n\t").concat(e," type was: '").concat(r.type,"'"))}}var $e=Ke("hsv",!1),Je=Ke("hsva",!0);function Ke(t,e){return function(r){function i(n,r,a,o){var u;A()(this,i),Dt(arguments,e?4:3,t);var s={h:n=It(n),s:r=It(r),v:a=It(a)};return e&&(o=It(o),Pt(t,"a",3,o),s.a=o),Pt(t,"h",0,n),Pt(t,"s",1,r),Pt(t,"v",2,a),(u=M()(this,R()(i).call(this,s))).type="color",u}return I()(i,r),G()(i,[{key:"eval",value:function(t){var n=this,r=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"category"===e.type?e.eval(t)/(n?e.numCategories+1:e.numCategories):e.eval(t)};return function(r,i,a){var o={r:Math.abs(6*r-3)-1,g:2-Math.abs(6*r-2),b:2-Math.abs(6*r-4),a:e?jt(n.a.eval(t),0,1):1};return o.r=jt(o.r,0,1),o.g=jt(o.g,0,1),o.b=jt(o.b,0,1),o.r=((o.r-1)*i+1)*a*255,o.g=((o.g-1)*i+1)*a*255,o.b=((o.b-1)*i+1)*a*255,o}(jt(r(this.h,!0),0,1),jt(r(this.s),0,1),jt(r(this.v),0,1))}},{key:"_bindMetadata",value:function(t){var r=this;Zt()(R()(i.prototype),"_bindMetadata",this).call(this,t),n("h",0,this.h),n("s",1,this.s),n("v",2,this.v),e&&Lt("hsva","a",3,"number",this.a);var a=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"category"===t.type?"/".concat(e?t.numCategories+1:t.numCategories,"."):""};Zt()(R()(i.prototype),"_setGenericGLSL",this).call(this,function(t){return"vec4(HSVtoRGB(vec3(\n                    ".concat(t.h).concat(a(r.h,!0),",\n                    clamp(").concat(t.s).concat(a(r.s),", 0.,1.),\n                    clamp(").concat(t.v).concat(a(r.v),", 0.,1.)\n                )), ").concat(e?"clamp(".concat(t.a,", 0.,1.)"):"1.",")")},"\n    #ifndef HSV2RGB\n    #define HSV2RGB\n    vec3 HSVtoRGB(vec3 HSV) {\n      float R = abs(HSV.x * 6. - 3.) - 1.;\n      float G = 2. - abs(HSV.x * 6. - 2.);\n      float B = 2. - abs(HSV.x * 6. - 4.);\n      vec3 RGB = clamp(vec3(R,G,B), 0., 1.);\n      return ((RGB - 1.) * HSV.y + 1.) * HSV.z;\n    }\n    #endif\n    ")}},{key:"value",get:function(){return this.eval()}}]),i}(Yt);function n(e,n,r){if(Pt(t,e,n,r),"number"!==r.type&&"category"!==r.type&&void 0!==r.type)throw new O("".concat(P.INCORRECT_TYPE," ").concat(t,"(): invalid parameter\n\t").concat(e," type was: '").concat(r.type,"'"))}}var tn=function(t){function e(){return A()(this,e),M()(this,R()(e).apply(this,arguments))}return I()(e,t),e}(nn("iLinear",function(t){return t},void 0,function(t){return t})),en=function(t){function e(){return A()(this,e),M()(this,R()(e).apply(this,arguments))}return I()(e,t),e}(nn("cubic",function(t){return"cubicEaseInOut(".concat(t,")")},"\n    #ifndef CUBIC\n    #define CUBIC\n    float cubicEaseInOut(float p){\n        if (p < 0.5) {\n            return 4. * p * p * p;\n        }else {\n            float f = ((2. * p) - 2.);\n            return 0.5 * f * f * f + 1.;\n        }\n    }\n    #endif\n",function(t){return t}));nn("bounceEaseIn",function(t){return"BounceEaseIn(".concat(t,")")},"\n    #ifndef BOUNCE_EASE_IN\n    #define BOUNCE_EASE_IN\n    float BounceEaseIn_BounceEaseOut(float p)\n    {\n        if(p < 4./11.0)\n        {\n            return (121. * p * p)/16.0;\n        }\n        else if(p < 8./11.0)\n        {\n            return (363./40.0 * p * p) - (99./10.0 * p) + 17./5.0;\n        }\n        else if(p < 9./10.0)\n        {\n            return (4356./361.0 * p * p) - (35442./1805.0 * p) + 16061./1805.0;\n        }\n        else\n        {\n            return (54./5.0 * p * p) - (513./25.0 * p) + 268./25.0;\n        }\n    }\n    float BounceEaseIn(float p)\n    {\n        return 1. - BounceEaseOut(1. - p);\n    }\n    #endif\n\n",function(t){return t});function nn(t,e,n,r){var i=function(i){function a(e){return A()(this,a),Dt(arguments,1,t),e=It(e),M()(this,R()(a).call(this,{m:e}))}return I()(a,i),G()(a,[{key:"eval",value:function(t){return r(this.m.eval(t))}},{key:"_bindMetadata",value:function(t){if(Zt()(R()(a.prototype),"_bindMetadata",this).call(this,t),"number"!==this.m.type)throw new O("".concat(P.INCORRECT_TYPE," Blending cannot be performed by '").concat(this.m.type,"'"));this.type="number",this._setGenericGLSL(function(t){return e(t.m)},n)}}]),a}(Yt);return i.type="interpolator",i}var rn=function(t){function e(t,n,r){var i;return A()(this,e),Dt(arguments,3,"linear"),t=It(t),void 0===n&&void 0===r&&(n=fo(t),r=co(t)),n=It(n),r=It(r),Pt("linear","input",0,t),Pt("linear","min",1,n),Pt("linear","max",2,r),(i=M()(this,R()(e).call(this,{input:t,min:n,max:r}))).type="number",i}return I()(e,t),G()(e,[{key:"eval",value:function(t){if("date"===this.input.type){var e=this.input.eval(t),n=this.min.eval().getTime(),r=this.max.eval().getTime(),i=this._metadata,a=i.properties[this.input.name].min.getTime(),o=i.properties[this.input.name].max.getTime()-a,u=(n-a)/o;return(e-u)/((r-a)/o-u)}var s=this.input.eval(t),c=this.min.eval(t);return(s-c)/(this.max.eval(t)-c)}},{key:"_bindMetadata",value:function(t){if(Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),"date"===this.input.type){var n=this.min.eval().getTime(),r=this.max.eval().getTime();this._metadata=t;var i=t.properties[this.input.name].min.getTime(),a=t.properties[this.input.name].max.getTime()-i,o=(n-i)/a,u=(r-i)/a;this.inlineMaker=function(t){return"((".concat(t.input,"-(").concat(o.toFixed(20),"))/(").concat((u-o).toFixed(20),"))")}}else Lt("linear","input",0,"number",this.input),Lt("linear","min",1,"number",this.min),Lt("linear","max",2,"number",this.max),this.inlineMaker=function(t){return"((".concat(t.input,"-").concat(t.min,")/(").concat(t.max,"-").concat(t.min,"))")}}},{key:"_getLegendData",value:function(t){for(var e=this.min.eval(),n=this.max.eval(),r=1/(t.samples-1),i=this.toString(),a=[],o=0;a.length<t.samples;o+=r){var u=jt(o,0,1),s=o*(n-e)+e;a.push({key:s,value:u})}return{data:a,min:e,max:n,name:i}}}]),e}(Yt),an=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","transparent","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],on=function(t){function e(t){var n;if(A()(this,e),Dt(arguments,1,"namedColor"),zt("namedColor","colorName",0,t),!an.includes(t.toLowerCase())){var r=Ot("namedColor","colorName",0);throw new O("".concat(P.INCORRECT_VALUE," ").concat(r,"\nInvalid color name:  '").concat(t,"'"))}return(n=M()(this,R()(e).call(this,{}))).type="color",n.name=t,n.expressionName=t,n.color=function(t){if(un[t])return un[t];var e=document.createElement("div");e.style.backgroundColor=t,document.body.appendChild(e);var n=getComputedStyle(e).backgroundColor;document.body.removeChild(e);var r=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/.exec(n),i={r:Number(r[1]),g:Number(r[2]),b:Number(r[3]),a:r[4]||1};return un[t]=i,i}(n.name),n.inlineMaker=function(){return"vec4(".concat((n.color.r/255).toFixed(4),", ").concat((n.color.g/255).toFixed(4),", ").concat((n.color.b/255).toFixed(4),", ").concat(1..toFixed(4),")")},n}return I()(e,t),G()(e,[{key:"eval",value:function(){return this.color}},{key:"toString",value:function(){return this.expressionName}},{key:"value",get:function(){return this.eval()}}]),e}(Yt),un={};var sn=n(13),cn=n.n(sn),fn=function(t){function e(){var t;return A()(this,e),Dt(arguments,0,"now"),(t=M()(this,R()(e).call(this,{now:_a(0)}))).type="number",cn()(R()(e.prototype),"inlineMaker",function(t){return t.now},Oe()(t),!0),t}return I()(e,t),G()(e,[{key:"eval",value:function(){return this.now.expr}},{key:"isAnimated",value:function(){return!0}},{key:"_setTimestamp",value:function(t){this.now.expr=t}},{key:"value",get:function(){return this.eval()}}]),e}(Yt),ln=function(t){function e(t){var n;return A()(this,e),Dt(arguments,1,"number"),Ut("number","x",0,t),(n=M()(this,R()(e).call(this,{}))).expr=t,n.type="number",n}return I()(e,t),G()(e,[{key:"eval",value:function(){return this.expr}},{key:"toString",value:function(){return"".concat(this.expr)}},{key:"isAnimated",value:function(){return!1}},{key:"_applyToShaderSource",value:function(){return{preface:this._prefaceCode("uniform float number".concat(this._uid,";")),inline:"number".concat(this._uid)}}},{key:"_postShaderCompile",value:function(t,e){this._getBinding(t).uniformLocation=e.getUniformLocation(t,"number".concat(this._uid))}},{key:"_preDraw",value:function(t,e,n){n.uniform1f(this._getBinding(t).uniformLocation,this.expr)}},{key:"value",get:function(){return this.eval()}}]),e}(Yt),hn=function(t){function e(t,n){var r;return A()(this,e),Dt(arguments,2,"opacity"),Number.isFinite(n)&&(n=_a(n)),Pt("opacity","input",0,t),Pt("opacity","alpha",1,n),(r=M()(this,R()(e).call(this,{input:t,alpha:n}))).inlineMaker=function(t){return"vec4((".concat(t.input,").rgb, ").concat(t.alpha,")")},r}return I()(e,t),G()(e,[{key:"eval",value:function(t){var e=this.input.eval(t),n=this.alpha.eval(t);return e.a=n,e}},{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("opacity","input",0,["color","image"],this.input),Lt("opacity","alpha",1,"number",this.alpha),this.type=this.input.type}},{key:"value",get:function(){return this.eval()}}]),e}(Yt),dn=function(t){function e(t){var n;return A()(this,e),Dt(arguments,1,"asc"),n=M()(this,R()(e).call(this,{})),Bt("asc","by",0,yn,t),n.type="orderer",n}return I()(e,t),e}(Yt),pn=function(t){function e(t){var n;return A()(this,e),Dt(arguments,1,"desc"),n=M()(this,R()(e).call(this,{})),Bt("desc","by",0,yn,t),n.type="orderer",n}return I()(e,t),e}(Yt),vn=function(t){function e(){var t;return A()(this,e),Dt(arguments,0,"noOrder"),(t=M()(this,R()(e).call(this,{}))).type="orderer",t}return I()(e,t),e}(Yt),yn=function(t){function e(){var t;return A()(this,e),Dt(arguments,1,"width"),(t=M()(this,R()(e).call(this,{}))).type="propertyReference",t}return I()(e,t),e}(Yt),mn=n(22),gn=_n("rgb",!1),bn=_n("rgba",!0);function _n(t,e){return function(n){function r(n,i,a,o){var u;A()(this,r),Dt(arguments,4,"rgba");var s=[n,i,a,o].map(It),c=Xe()(s,4);n=c[0],i=c[1],a=c[2],o=c[3],Pt(t,"r",0,n),Pt(t,"g",1,i),Pt(t,"b",2,a);var f={r:n,g:i,b:a};return e&&(Pt(t,"a",3,o),f.a=o),(u=M()(this,R()(r).call(this,f))).type="color",u.inlineMaker=function(t){return"vec4(".concat(t.r,"/255., ").concat(t.g,"/255., ").concat(t.b,"/255., ").concat(e?t.a:"1.",")")},u}return I()(r,n),G()(r,[{key:"eval",value:function(t){return{r:this.r.eval(t),g:this.g.eval(t),b:this.b.eval(t),a:e?this.a.eval(t):1}}},{key:"_bindMetadata",value:function(n){Zt()(R()(r.prototype),"_bindMetadata",this).call(this,n),Lt(t,"r",0,"number",this.r),Lt(t,"g",1,"number",this.g),Lt(t,"b",2,"number",this.b),e&&Lt("rgba","a",3,"number",this.a)}},{key:"value",get:function(){return this.eval()}}]),r}(Yt)}var xn=function(t){function e(t,n){var r;return A()(this,e),(r=M()(this,R()(e).call(this,{}))).type="palette",r.childType="color",r.name=t,r.subPalettes=new Proxy(n,{get:function(t,e){if("symbol"!==h()(e)&&Number.isSafeInteger(Number(e))&&Array.isArray(t[e]))return t[e].map(Ft)}}),r.expressionName=t,r.tags=n.tags,r}return I()(e,t),G()(e,[{key:"getColors",value:function(t){var e=this._getBestSubPalette(t);return this.isQualitative()?{colors:e,othersColor:e.pop()}:{colors:e,othersColor:null}}},{key:"toString",value:function(){return this.expressionName}},{key:"_getBestSubPalette",value:function(t){t=t<=2?2:t;var e=this.getLongestSubPalette();return(t<e.length?f()(this.subPalettes[t]):f()(e)).map(function(t){return new bn(oa(t.r),oa(t.g),oa(t.b),oa(t.a))})}},{key:"getLongestSubPalette",value:function(){for(var t=this.subPalettes,e=20;e>=0;e--)if(t[e])return t[e]}},{key:"isQualitative",value:function(){return this.tags.includes("qualitative")}},{key:"isQuantitative",value:function(){return this.tags.includes("quantitative")}}]),e}(Yt),wn={};Object.keys(mn).map(function(t){wn["".concat(t.toUpperCase())]=new xn(t,mn[t])});var Tn=wn,En=function(t){function e(t){var n;return A()(this,e),(n=M()(this,R()(e).call(this,t.name,t.subPalettes))).type="palette",n._originalPalette=t,n.tags=t.tags,n.subPalettes=new Proxy(t.subPalettes,{get:function(t,e){return Number.isFinite(Number(e))&&Array.isArray(t[e])?n._reversePalette(t[e]):t[e]}}),n}return I()(e,t),G()(e,[{key:"getLongestSubPalette",value:function(){return this._reversePalette(this._originalPalette.getLongestSubPalette())}},{key:"_reversePalette",value:function(t){if(this.isQualitative()){var e=f()(t),n=e.pop();return f()(e.reverse()).concat([n])}return f()(t).reverse()}}]),e}(xn),kn=function(t){function e(t){var n;if(A()(this,e),n=M()(this,R()(e).call(this,{array:t})),Pt("reverseList","array",0,t),n.array.elems){var r=n.array.elems[0].type;n.type="".concat(r,"-list")}return n}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){this.array._bindMetadata(t),Lt("reverse","array",0,["palette","number-list","category-list","color-list","time-list","image-list"],this.array),this.type=this.array.type,this.childType=this.array.childType,Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t)}},{key:"eval",value:function(t){return this.elems.map(function(e){return e.eval(t)})}},{key:"elems",get:function(){return f()(this.array.elems).reverse()}},{key:"value",get:function(){return this.elems.map(function(t){return t.value})}}]),e}(Yt);var An=0,Cn=function(t){function e(t,n){var r;if(A()(this,e),n<=1)throw new RangeError("The number of 'buckets' must be >=2, but ".concat(n," was used."));var i=function(t,e){for(var n=[],r=0;r<e-1;r++)t["arg".concat(r)]=_a(0),n.push(t["arg".concat(r)]);return n}(t,n);return(r=M()(this,R()(e).call(this,t))).classifierUID=An++,r.numCategories=n,r.numCategoriesWithoutOthers=n,r.breakpoints=i,r.type="category",r}return I()(e,t),G()(e,[{key:"toString",value:function(){return"".concat(this.expressionName,"(").concat(this.input.toString(),", ").concat(this.numCategories,")")}},{key:"eval",value:function(t){var e=this.input.eval(t),n=this.breakpoints.findIndex(function(t){return e<=t.expr}),r=this.numCategories-1||1;return-1===n?1:n/r}},{key:"getBreakpointList",value:function(){return this._genBreakpoints(),this.breakpoints.map(function(t){return t.expr})}},{key:"_genBreakpoints",value:function(){}},{key:"_applyToShaderSource",value:function(t){var e=this,n=this.childrenNames.map(function(n){return e[n]._applyToShaderSource(t)}),r={};n.map(function(t,n){r[e.childrenNames[n]]=t.inline});var i="classifier".concat(this.classifierUID),a=this.numCategories-1||1,o=this.breakpoints.map(function(t,e){return"".concat(e>0?"else":""," if (x<(").concat(r["arg".concat(e)],")){\n                return ").concat((e/a).toFixed(20),";\n            }")}).join(""),u="float ".concat(i,"(float x){\n            ").concat(o,"\n            return 1.;\n        }");return{preface:this._prefaceCode(n.map(function(t){return t.preface}).reduce(function(t,e){return t+e},"")+u),inline:"".concat(i,"(").concat(r.input,")")}}},{key:"_preDraw",value:function(t,n,r){this._genBreakpoints(),Zt()(R()(e.prototype),"_preDraw",this).call(this,t,n,r)}},{key:"_getLegendData",value:function(){for(var t=this.getBreakpointList(),e=t.length,n=this.toString(),r=[],i=0;i<=e;i++){var a=[t[i-1]||Number.NEGATIVE_INFINITY,t[i]||Number.POSITIVE_INFINITY],o=i/e;r.push({key:a,value:o})}return{name:n,data:r}}}]),e}(Yt);var Mn=function(t){function e(t,n){return A()(this,e),Dt(arguments,2,"globalEqIntervals"),Bt("globalEqIntervals","input",0,Pe,t&&(t.property||t)),Ut("globalEqIntervals","buckets",1,n),M()(this,R()(e).call(this,{input:t},n))}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){var n=this;Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Pt("globalEqIntervals","input",0,this.input),Lt("globalEqIntervals","input",0,"number",this.input);var r=t.properties[this.input.name],i=r.min,a=r.max;this.min=i,this.max=a,this.breakpoints.map(function(t,e){var r=(e+1)/n.numCategories;t.expr=i+(a-i)*r})}}]),e}(Cn),Sn=function(t){function e(t,n){return A()(this,e),Dt(arguments,2,"globalQuantiles"),Bt("globalQuantiles","input",0,Pe,t&&(t.property||t)),Ut("globalQuantiles","buckets",1,n),M()(this,R()(e).call(this,{input:t},n))}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){var n=this;Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Pt("globalQuantiles","input",0,this.input),Lt("globalQuantiles","input",0,"number",this.input);var r=t.sample.map(function(t){return t[n.input.name]});r.sort(function(t,e){return t-e}),this.breakpoints.map(function(t,e){var i=(e+1)/n.numCategories;t.expr=r[Math.floor(i*r.length)]})}}]),e}(Cn),Rn=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e/t.length},Dn=function(t){function e(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(A()(this,e),Dt(arguments,3,"globalStandardDev"),Bt("globalStandardDev","input",0,Pe,t&&(t.property||t)),Ut("globalStandardDev","buckets",1,n),Ut("globalStandardDev","classSize",2,i),i<=0)throw new RangeError("The 'classSize must be > 0.0, but '".concat(i,"' was used."));return(r=M()(this,R()(e).call(this,{input:t},n)))._classSize=i,r._sample=[],r}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){var n=this;Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Pt("globalStandardDev","input",0,this.input),Lt("globalStandardDev","input",0,"number",this.input);var r=t.sample.map(function(t){return t[n.input.name]}),i=In(Rn(r),function(t){var e=Rn(t),n=Rn(function(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r]-e;n.push(i*i)}return n}(t,e));return Math.sqrt(n)}(r),this.numCategories,this._classSize);this.breakpoints.forEach(function(t,e){t.expr=i[e]})}}]),e}(Cn);function In(t,e,n,r){var i,a=[],o=[],u=n%2==0?0:1;do{var s=u*(e*r);a.push(t+s),o.push(t-s),(i=f()(new Set(a.concat(o)))).sort(function(t,e){return t-e}),u++}while(i.length<n-1);return i}var Fn=function(t){function e(t,n){A()(this,e),Dt(arguments,2,"viewportEqIntervals"),Ut("viewportEqIntervals","buckets",1,n);var r={input:t,_min:no(t),_max:eo(t)};return M()(this,R()(e).call(this,r,n))}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("viewportEqIntervals","input",0,["number"],this.input)}},{key:"_genBreakpoints",value:function(){var t=this,e=this._min.eval(),n=this._max.eval();this.breakpoints.map(function(r,i){var a=(i+1)/t.numCategories;r.expr=e+(n-e)*a})}}]),e}(Cn),Nn=function(t){function e(t,n){A()(this,e),Dt(arguments,2,"viewportQuantiles"),Ut("viewportQuantiles","buckets",1,n);var r={input:t,_histogram:oo(t)};return M()(this,R()(e).call(this,r,n))}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("viewportQuantiles","input",0,["number"],this.input)}},{key:"_genBreakpoints",value:function(){var t=this,e=this._histogram.value,n=e.length,r=e[0].x[0],i=e[n-1].x[1],a=0,o=e.map(function(t){var e=t.y;return a+=e}),u=0,s=o[n-1],c=[];this.breakpoints.map(function(e,a){for(;u<n&&!(o[u]>(a+1)/t.numCategories*s);u++);var f=u/n*(i-r)+r;c.push(f),e.expr=f})}}]),e}(Cn),On=function(t){function e(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(A()(this,e),Dt(arguments,3,"viewportStandardDev"),Ut("viewportStandardDev","buckets",1,n),Ut("viewportStandardDev","classSize",2,i),i<=0)throw new RangeError("The 'classSize' must be > 0.0, but '".concat(i,"' was used."));var a={input:t,_histogram:oo(t)};return(r=M()(this,R()(e).call(this,a,n)))._classSize=i,r}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("viewportStandardDev","input",0,["number"],this.input)}},{key:"_genBreakpoints",value:function(){var t=this._averageFrom(this._histogram.value),e=In(t,this._standardDevFrom(this._histogram.value,t),this.numCategories,this._classSize);this.breakpoints.forEach(function(t,n){t.expr=e[n]})}},{key:"_averageFrom",value:function(t){var e=0,n=0;return t.forEach(function(t){var r=t.x,i=t.y;e+=i;var a=(r[0]+r[1])/2;n+=a*i}),n/e}},{key:"_standardDevFrom",value:function(t,e){var n=0,r=0;t.forEach(function(t){var i=t.x,a=t.y;n+=a;var o=(i[0]+i[1])/2-e;r+=a*o*o});var i=r/n;return Math.sqrt(i)}}]),e}(Cn),Pn=n(18),Ln=n.n(Pn),Bn=n(26),Un=n.n(Bn),zn=n(27),Vn=n.n(zn),Gn=n(28),jn=n.n(Gn),qn=n(29),Wn=n.n(qn),Yn=n(30),Xn=n.n(Yn),Hn=n(31),Zn=n.n(Hn),Qn=n(32),$n=n.n(Qn),Jn=n(33),Kn=n.n(Jn),tr=n(34),er=n.n(tr),nr=n(35),rr=n.n(nr),ir=n(36),ar=n.n(ir),or=n(37),ur=n.n(or),sr=n(38),cr=n.n(sr),fr=n(39),lr=n.n(fr),hr=n(40),dr=n.n(hr),pr=n(41),vr=n.n(pr),yr=n(42),mr=n.n(yr),gr=n(43),br=n.n(gr),_r={bicycle:Un.a,building:Vn.a,bus:jn.a,car:Wn.a,circle:Xn.a,circleOutline:Zn.a,cross:$n.a,house:Kn.a,flag:er.a,marker:rr.a,markerOutline:ar.a,plus:ur.a,square:cr.a,squareOutline:lr.a,star:dr.a,starOutline:vr.a,triangle:mr.a,triangleOutline:br.a},xr=256,wr=function(t){function e(t){var n;return A()(this,e),Dt(arguments,1,"categoryIndex"),Pt("categoryIndex","property",0,t=It(t)),(n=M()(this,R()(e).call(this,{property:t})))._numTranslatedCategories=null,n.type="category",n._translatePixels=new Float32Array(xr*xr),n._translateArray=[],n._numTranslatedCategories=0,n._numTranslatedCategoriesGL=0,n}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("categoryIndex","property",0,"category",this.property),this._metadata=t,this._calcTranslated()}},{key:"eval",value:function(t){var e=this.property.eval(t),n=this._metadata.categoryToID.get(e);return this._translateArray[n]}},{key:"_preDraw",value:function(t,e,n){n.activeTexture(n.TEXTURE0+e.freeTexUnit),this._numTranslatedCategoriesGL!==this.numCategories?(this._numTranslatedCategoriesGL=this.numCategories,this._calcTranslated(),this._translateTexture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this._translateTexture),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,xr,xr,0,n.ALPHA,n.FLOAT,this._translatePixels),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)):n.bindTexture(n.TEXTURE_2D,this._translateTexture),n.uniform1i(this._getBinding(t).texRampTranslateLoc,e.freeTexUnit),e.freeTexUnit++}},{key:"_applyToShaderSource",value:function(t){var e=xr.toFixed(20),n=this.property._applyToShaderSource(t);return{inline:"ramp_translate".concat(this._uid,"(").concat(n.inline,")"),preface:"\n                    uniform sampler2D texRampTranslate".concat(this._uid,";\n                    float ramp_translate").concat(this._uid,"(float s){\n                        vec2 v = vec2(mod(s, ").concat(e,"), floor(s / ").concat(e,"));\n                        return texture2D(texRampTranslate").concat(this._uid,", v/").concat(e,").a;\n                    }")}}},{key:"_postShaderCompile",value:function(t,e){this._getBinding(t).texRampTranslateLoc=e.getUniformLocation(t,"texRampTranslate".concat(this._uid))}},{key:"_calcTranslated",value:function(){var t=this._metadata.properties[this.property.name],e=this.numCategories;if(this._numTranslatedCategories!==e){this._numTranslatedCategories=e;for(var n=0;n<e;n++){var r=this._metadata.categoryToID.get(t.categories[n].name),i=n/(e-1),a={x:r%xr,y:Math.floor(r/xr)};this._translatePixels[xr*a.y+a.x]=i,this._translateArray.push(i)}}}},{key:"_getLegendData",value:function(){for(var t=this._metadata.properties[this.property.name].categories,e=t.length,n=e-1,r=[],i=0;i<e;i++){var a=t[i].name,o=i/n;r.push({key:a,value:o})}return{data:r}}},{key:"numCategories",get:function(){return this._metadata.properties[this.property.name].categories.length}},{key:"numCategoriesWithoutOthers",get:function(){return this.numCategories}}]),e}(Yt),Tr=function(t){function e(){return A()(this,e),M()(this,R()(e).apply(this,arguments))}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),this.numImages=this.elems.length,this._getChildren().forEach(function(t,e){return Lt("imageArray","imageArray[".concat(e,"]"),0,"image",t)})}},{key:"eval",value:function(t){return this.elems.map(function(e){return e.eval(t)})}},{key:"_applyToShaderSource",value:function(){return{preface:this._prefaceCode("\n                uniform sampler2D atlas".concat(this._uid,";\n\n                vec4 atlas").concat(this._uid,"Fn(vec2 imageUV, float category) {\n                    return texture2D(atlas").concat(this._uid,", imageUV/16. + vec2(mod(category, 16.), floor(category/16.))/16. ).rgba;\n                }\n            ")),inline:"atlas".concat(this._uid,"Fn")}}},{key:"_postShaderCompile",value:function(t,e){this._getBinding(t).texLoc=e.getUniformLocation(t,"atlas".concat(this._uid))}},{key:"_preDraw",value:function(t,e,n){this.init=!0;for(var r=0;r<this.numImages;r++){var i=this["image-".concat(r)];this.init=this.init&&i.canvas}if(this.init&&!this.texture){n.activeTexture(n.TEXTURE0+e.freeTexUnit),this.texture=n.createTexture(),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.bindTexture(n.TEXTURE_2D,this.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,4096,4096,0,n.RGBA,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);for(var a=0,o=0,u=0;u<this.numImages;u++){var s=this["image-".concat(u)];n.texSubImage2D(n.TEXTURE_2D,0,a,o,n.RGBA,n.UNSIGNED_BYTE,s.canvas),(a+=256)+256>4096&&(a=0,o+=256)}n.generateMipmap(n.TEXTURE_2D)}this.texture&&(n.activeTexture(n.TEXTURE0+e.freeTexUnit),n.bindTexture(n.TEXTURE_2D,this.texture),n.uniform1i(this._getBinding(t).texLoc,e.freeTexUnit),e.freeTexUnit++)}}]),e}(Yt),Er=function(t){function e(t){var n;return A()(this,e),Dt(arguments,1,"image"),zt("image","url",0,t),(n=M()(this,R()(e).call(this,{}))).type="image",n.canvas=null,n.url=t,n._promise=new Promise(function(t,e){n.image=new window.Image,n.image.onload=function(){n.canvas=function(t){var e=document.createElement("canvas");e.width=256,e.height=256;var n=e.getContext("2d"),r=Math.max(t.width,t.height),i=t.width/r*256,a=t.height/r*256;return n.drawImage(t,1+(256-i)/2,1+(256-a)/2,i-2,a-2),e}(n.image),n.image=null,t()},n.image.onerror=e,n.image.crossOrigin="anonymous",n.image.src=n.url}),n}return I()(e,t),G()(e,[{key:"loadImages",value:function(){return this.count=this.count+1||1,this._promise}},{key:"eval",value:function(){return this.url}},{key:"_free",value:function(t){this.texture&&t.deleteTexture(this.texture)}},{key:"_applyToShaderSource",value:function(){return{preface:this._prefaceCode("uniform sampler2D texSprite".concat(this._uid,";")),inline:"texture2D(texSprite".concat(this._uid,", imageUV).rgba")}}},{key:"_postShaderCompile",value:function(t,e){this._getBinding(t)._texLoc=e.getUniformLocation(t,"texSprite".concat(this._uid))}},{key:"_preDraw",value:function(t,e,n){!this.init&&this.canvas&&(this.init=!0,n.activeTexture(n.TEXTURE0+e.freeTexUnit),this.texture=n.createTexture(),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.bindTexture(n.TEXTURE_2D,this.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this.canvas),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.generateMipmap(n.TEXTURE_2D),this.canvas=null),this.texture&&(n.activeTexture(n.TEXTURE0+e.freeTexUnit),n.bindTexture(n.TEXTURE_2D,this.texture),n.uniform1i(this._getBinding(t)._texLoc,e.freeTexUnit),e.freeTexUnit++)}}]),e}(Yt);var kr=function(t){function e(t){return A()(this,e),Dt(arguments,1,"svg"),M()(this,R()(e).call(this,"data:image/svg+xml,".concat(encodeURIComponent(t))))}return I()(e,t),e}(Er),Ar=new kr(_r.circle),Cr=function(t){function e(){return A()(this,e),M()(this,R()(e).apply(this,arguments))}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){Yt.prototype._bindMetadata.call(this,t),this.type=this.palette.childType,Lt("ramp","input",0,"category",this.input),Bt("ramp","palette",1,Tr,this.palette),this.others===Ee?this.others=Ar:Lt("ramp","others",2,"image",this.others),this.input.isA(Pe)&&(this.input=new wr(this.input),this.input._bindMetadata(t)),this.others._bindMetadata(t),this.childrenNames.push("others")}},{key:"eval",value:function(t){var e=this.input.eval(t);return this._calcEval(e)}},{key:"_calcEval",value:function(t){var e=Math.round(t*(this.input.numCategoriesWithoutOthers-1));return this.palette.eval()[e]||this.others.eval()}},{key:"getLegendData",value:function(t){var e=this,n=Object.assign({},Ae,t),r=this.input.type,i=this.input._getLegendData(n),a=i.data.map(function(t){var n=t.key,r=t.value;return{key:n,value:r=e._calcEval(r)}});return Ln()({type:r},i,{data:a})}},{key:"_applyToShaderSource",value:function(t){var e=this.input._applyToShaderSource(t),n=this.palette._applyToShaderSource(t),r=this.others._applyToShaderSource(t);return{preface:this._prefaceCode("\n                uniform float rampImageMultiplier".concat(this._uid,";\n\n                ").concat(e.preface,"\n                ").concat(n.preface,"\n                ").concat(r.preface,"\n\n                vec4 rampImage").concat(this._uid,"(vec2 imageUV, float index){\n                    if (index == ").concat("(-1.)","){\n                        return ").concat(r.inline,";\n                    }\n                    return ").concat(n.inline,"(imageUV, rampImageMultiplier").concat(this._uid,"*index);\n                }\n            ")),inline:"rampImage".concat(this._uid,"(imageUV, ").concat(e.inline,")")}}},{key:"_postShaderCompile",value:function(t,n){Zt()(R()(e.prototype),"_postShaderCompile",this).call(this,t,n),this._getBinding(t)._multiplierLoc=n.getUniformLocation(t,"rampImageMultiplier".concat(this._uid))}},{key:"_preDraw",value:function(t,n,r){Zt()(R()(e.prototype),"_preDraw",this).call(this,t,n,r),r.uniform1f(this._getBinding(t)._multiplierLoc,this.input.numCategoriesWithoutOthers-1)}}]),e}(Yt),Mr=function(t){function e(){return A()(this,e),M()(this,R()(e).apply(this,arguments))}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){var n=new qe(1),r=new on("gray");Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),this.type=this.palette.childType,this.others===Ee?(this.others="number-list"===this.palette.type?n:r,this.others._bindMetadata(t)):(this.others._bindMetadata(t),Lt("ramp","others",2,this.palette.childType,this.others)),(this.input.isA(Pe)||this.input.isA(Le))&&(this.input="number"===this.input.type?new rn(this.input):new wr(this.input),this.input._bindMetadata(t)),Lt("ramp","input",0,["number","category"],this.input),this.childrenNames.push("others"),this._metadata=t}},{key:"eval",value:function(t){var e=this.input.eval(t);return this._calcEval(e,t)}},{key:"_calcEval",value:function(t,e){var n=this._getPalette(),r=n.palette,i=n.others,a=this.palette.isA(xn)?r.map(function(t){return t.eval(e)}):this.palette.eval(e);if(t===ke)return i.eval(e);var o=a.length-1,u=Math.floor(t*o),s=Math.ceil(t*o),c=function(t){return t-Math.floor(t)}(t*o);return qt(a[u],a[s],c)}},{key:"getLegendData",value:function(t){var e=this,n=Object.assign({},Ae,t),r=this.input.type,i=this.input._getLegendData(n),a=i.data.map(function(t){var n=t.key,r=t.value;return{key:n,value:r=e._calcEval(r,void 0)}});return Ln()({type:r},i,{data:a})}},{key:"_applyToShaderSource",value:function(t){var e=this.input._applyToShaderSource(t),n=this._getPalette(),r=n.palette,i=n.others,a=r.map(function(e){return e._applyToShaderSource(t)}),o=i._applyToShaderSource(t),u="number-list"===this.palette.type?function(t){return Sr(t.map(function(t){return t.inline}))}(a):function(t){return"cielabToSRGBA(".concat(Sr(t.map(function(t){return"sRGBAToCieLAB(".concat(t.inline,")")})),")")}(a),s="number-list"===this.palette.type?"float":"vec4",c="ramp_color".concat(this._uid,"(").concat(e.inline,")");return{preface:this._prefaceCode("\n            ".concat(e.preface,"\n            ").concat(Re.a,"\n            ").concat(a.map(function(t){return t.preface}).join("\n"),"\n            ").concat(o.preface,"\n\n            ").concat(s," ramp_color").concat(this._uid,"(float x){\n                return x==").concat("(-1.)","\n                    ? ").concat(o.inline,"\n                    : ").concat(u,";\n            }")),inline:c}}},{key:"_getPalette",value:function(){return this.palette.isA(xn)?this._getColorPalette():{palette:this.palette.elems,others:this.others}}},{key:"_getColorPalette",value:function(){var t=this.palette.getColors(this.input.numCategoriesWithoutOthers);return{palette:t.colors,others:this._defaultOthers&&t.othersColor?t.othersColor:this.others}}}]),e}(Yt);function Sr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t[e];return e===t.length-1?n:function(t,e,n,r){var i=(n/(r-1)).toFixed(20),a=(1/(r-1)).toFixed(20),o="clamp((x - ".concat(i,")/").concat(a,", 0., 1.)");return"mix(".concat(t,", ").concat(e,", ").concat(o,")")}(n,Sr(t,e+1),e,t.length)}var Rr=function(t){function e(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ee;return A()(this,e),Dt(arguments,3,"ramp"),t=It(t),n=It(n),Pt("ramp","input",0,t),Pt("ramp","palette",1,n),i!==Ee&&Pt("ramp","others",2,i=It(i)),(r=M()(this,R()(e).call(this,{input:t,palette:n}))).palette=n,r.others=i,r._defaultOthers=i===Ee,r}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){switch(Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),this.palette.type){case"image-list":Object.setPrototypeOf(this,Cr.prototype);break;default:Object.setPrototypeOf(this,Mr.prototype)}return this._bindMetadata(t)}}]),e}(Yt),Dr=function(t){function e(){return A()(this,e),M()(this,R()(e).apply(this,arguments))}return I()(e,t),G()(e,[{key:"eval",value:function(t){return this.elems.map(function(e){return e.eval(t)})}},{key:"_applyToShaderSource",value:function(t){var e=this.elems.map(function(e){return e._applyToShaderSource(t)});return{preface:e.map(function(t){return t.preface}).join("\n"),inline:e.map(function(t){return t.inline})}}},{key:"value",get:function(){return this.elems.map(function(t){return t.value})}}]),e}(Yt),Ir=function(t){function e(){return A()(this,e),M()(this,R()(e).apply(this,arguments))}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),this._getChildren().forEach(function(t,e){return Lt("ListTransformation","ListTransformation[".concat(e,"]"),0,"transformation",t)}),this.type="transformation"}},{key:"eval",value:function(t){return this.elems.map(function(e){return e.eval(t)})}},{key:"_applyToShaderSource",value:function(t){var e=this.elems.map(function(e){return e._applyToShaderSource(t)});return{preface:this._prefaceCode("\n                ".concat(e.map(function(t){return t.preface}).join("\n"),"\n\n                vec2 listTransform").concat(this._uid,"(vec2 p) {\n                    ").concat(e.map(function(t){return"p = ".concat(t.inline,"(p);")}).join("\n"),"\n                    return p;\n                }\n            ")),inline:"listTransform".concat(this._uid)}}}]),e}(Yt),Fr=["number","category","color","time","image","transformation"],Nr=function(t){function e(t){var n;if(A()(this,e),Dt(arguments,1,"list"),!t)throw new O("".concat(P.MISSING_REQUIRED," list(): invalid parameters: must receive at least one argument."));if(Array.isArray(t)||(t=[t]),!(t=t.map(It)).length)throw new O("".concat(P.MISSING_REQUIRED," list(): invalid parameters: must receive at least one argument."));return t.map(function(t,e){Pt("list","item[".concat(e,"]"),e,t)}),(n=M()(this,R()(e).call(this,t))).elems=t,n}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){var n=this;if(Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),this._setTypes(),-1===Fr.indexOf(this.childType))throw new O("".concat(P.INCORRECT_TYPE," list(): invalid parameters type: ").concat(this.childType,"."));switch(this.elems.map(function(t,e){if(Pt("list","item[".concat(e,"]"),e,t),t.type!==n.childType)throw new O("".concat(P.INCORRECT_TYPE," list(): invalid ").concat(Nt(e+1)," parameter type, invalid argument type combination."))}),this.elems[0].type){case"image":Object.setPrototypeOf(this,Tr.prototype);break;case"transformation":Object.setPrototypeOf(this,Ir.prototype);break;default:Object.setPrototypeOf(this,Dr.prototype)}return this._bindMetadata(t)}},{key:"_setTypes",value:function(){this.childType=this.elems[0].type,this.type="".concat(this.childType,"-list")}}]),e}(Yt),Or=function(t){function e(t){var n;return A()(this,e),Dt(arguments,1,"time"),(n=M()(this,R()(e).call(this,{}))).type="time",n.date=_(t),n.inlineMaker=function(){},n}return I()(e,t),G()(e,[{key:"eval",value:function(){return this.date}},{key:"isAnimated",value:function(){return!1}},{key:"value",get:function(){return this.eval()}}]),e}(Yt),Pr=16,Lr=function(t){function e(t,n){var r;A()(this,e),Dt(arguments,2,"top"),n=It(n),Bt("top","property",0,Pe,t);for(var i={property:t,buckets:n},a=0;a<Pr;a++)i["_top".concat(a)]=_a(0);return(r=M()(this,R()(e).call(this,i))).type="category",r}return I()(e,t),G()(e,[{key:"eval",value:function(t){var e=this._metadata.properties[this.property.name],n=f()(e.categories).sort(function(t,e){return e.frequency-t.frequency}),r=this.property.eval(t),i=n.findIndex(function(t){return t.name===r}),a=this.numCategoriesWithoutOthers-1||1;return i>=this.numBuckets||-1===i?ke:i/a}},{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("top","property",0,"category",this.property),Gt("top","buckets",1,this.buckets),Lt("top","buckets",1,"number",this.buckets),this._metadata=t,this._textureBuckets=null}},{key:"_applyToShaderSource",value:function(t){var e=this,n={};return this.childrenNames.forEach(function(r){n[r]=e[r]._applyToShaderSource(t)}),{preface:this._prefaceCode(Object.values(n).map(function(t){return t.preface}).join("")+"\n            uniform float numCategoriesWithoutOthers".concat(this._uid,";\n\n            float top").concat(this._uid,"(float id){\n                float r;\n                if (").concat(n._top0.inline," == id){\n                    r = 0.;\n                } else if (").concat(n._top1.inline," == id){\n                    r = 1.;\n                } else if (").concat(n._top2.inline," == id){\n                    r = 2.;\n                } else if (").concat(n._top3.inline," == id){\n                    r = 3.;\n                } else if (").concat(n._top4.inline," == id){\n                    r = 4.;\n                } else if (").concat(n._top5.inline," == id){\n                    r = 5.;\n                } else if (").concat(n._top6.inline," == id){\n                    r = 6.;\n                } else if (").concat(n._top7.inline," == id){\n                    r = 7.;\n                } else if (").concat(n._top8.inline," == id){\n                    r = 8.;\n                } else if (").concat(n._top9.inline," == id){\n                    r = 9.;\n                } else if (").concat(n._top10.inline," == id){\n                    r = 10.;\n                } else if (").concat(n._top11.inline," == id){\n                    r = 11.;\n                } else if (").concat(n._top12.inline," == id){\n                    r = 12.;\n                } else if (").concat(n._top13.inline," == id){\n                    r = 13.;\n                } else if (").concat(n._top14.inline," == id){\n                    r = 14.;\n                } else if (").concat(n._top15.inline," == id){\n                    r = 15.;\n                }else{\n                    return ").concat("(-1.)",";\n                }\n                return r/(numCategoriesWithoutOthers").concat(this._uid,"-1.);\n            }")),inline:"top".concat(this._uid,"(").concat(n.property.inline,")")}}},{key:"_postShaderCompile",value:function(t,n){this._numCategoriesLoc=n.getUniformLocation(t,"numCategoriesWithoutOthers".concat(this._uid)),Zt()(R()(e.prototype),"_postShaderCompile",this).call(this,t,n)}},{key:"_preDraw",value:function(t,n,r){for(var i=this,a=this.numBuckets,o=this._metadata.properties[this.property.name],u=f()(o.categories).sort(function(t,e){return e.frequency-t.frequency}),s=0;s<Pr;s++)this["_top".concat(s)].expr=Number.POSITIVE_INFINITY;u.forEach(function(t,e){e<a&&(i["_top".concat(e)].expr=i._metadata.categoryToID.get(t.name))}),r.uniform1f(this._numCategoriesLoc,this.numCategoriesWithoutOthers),Zt()(R()(e.prototype),"_preDraw",this).call(this,t,n,r)}},{key:"_getLegendData",value:function(){var t=this._metadata.properties[this.property.name],e=f()(t.categories).sort(function(t,e){return e.frequency-t.frequency}),n=this.numBuckets,r=[],i=this.toString(),a=this.numCategoriesWithoutOthers-1||1;return e.forEach(function(t,e){if(e<n){var i=t.name,o=e/a;r.push({key:i,value:o})}}),r.push({key:"CARTO_VL_OTHERS",value:ke}),{name:i,data:r}}},{key:"numCategories",get:function(){return this.numBuckets+1}},{key:"numCategoriesWithoutOthers",get:function(){return this.numCategories-1}},{key:"numBuckets",get:function(){var t=Math.round(this.buckets.eval());if(t>this.property.numCategories&&(t=this.property.numCategories),t>Pr){var e=this.buckets.eval();setTimeout(function(){throw new O("".concat(P.INCORRECT_VALUE," top() function has a limit of ").concat(Pr," buckets but '").concat(e,"' buckets were specified."))}),t=0}return t}}]),e}(Yt),Br=.15,Ur=void 0,zr=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ur,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ur;A()(this,e),Dt(arguments,2,"fade");var i=It(n===Ur?Br:n),a=r===Ur?i:It(r);return Pt("fade","param1",0,i),Pt("fade","param2",1,a),(t=M()(this,R()(e).call(this,{fadeIn:i,fadeOut:a}))).type="fade",t.inlineMaker=function(t){return{in:t.fadeIn,out:t.fadeOut}},t}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("fade","param1",0,"number",this.fadeIn),Lt("fade","param2",1,"number",this.fadeOut)}}]),e}(Yt),Vr=new Set,Gr=new Set,jr=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new zr;A()(this,e),Dt(arguments,3,"animation"),r=It(r);var a=t=It(t);t.isA(Pe)&&(t=ya(t,fo(t),co(t)));var o=_a(0);return(n=M()(this,R()(e).call(this,{_input:t,progress:o,fade:i,duration:r}))).type="number",n._originalInput=a,n._paused=!1,n.preface="\n        #ifndef ANIMATION\n        #define ANIMATION\n\n        float animation(float _input, float progress, float duration, float fadeIn, float fadeOut){\n            float x = 0.;\n\n            // Check for NaN\n            if (_input <= 0.0 || 0.0 <= _input){\n                x = 1. - clamp(abs(_input - progress) * duration / (_input > progress ? fadeIn: fadeOut), 0., 1.);\n            }\n\n            return x;\n        }\n\n        #endif\n    ",n.inlineMaker=function(t){return"animation(".concat(t._input,", ").concat(t.progress,", ").concat(t.duration,", ").concat(t.fade.in,", ").concat(t.fade.out,")")},n}return I()(e,t),G()(e,[{key:"isAnimated",value:function(){return!this.paused}},{key:"_dataReady",value:function(){if(Vr.has(this)&&(Vr.delete(this),Gr.add(this)),Gr.has(this)){if((Vr=new Set(f()(Vr).filter(function(t){for(;t.parent;)t=t.parent;return!!t._getRootExpressions}))).size>0)return;f()(Gr.values()).map(function(t){"default"===t._paused&&t.play()}),Gr.clear()}}},{key:"_postShaderCompile",value:function(t,n){Vr.add(this),this._paused||(this._paused="default"),Zt()(R()(e.prototype),"_postShaderCompile",this).call(this,t,n)}},{key:"_setTimestamp",value:function(t){if(Zt()(R()(e.prototype),"_setTimestamp",this).call(this,t),!this._paused||void 0!==this._lastTime){var n=0,r=1/this.duration.value;void 0!==this._lastTime&&(n=t-this._lastTime),this._lastTime=t,this._paused||(this.progress.expr=(this.progress.expr+r*n)%1)}}},{key:"eval",value:function(t){var e=this._input.eval(t);if(Number.isNaN(e))return 0;var n=this.progress.value,r=this.duration.value,i=this.fade.fadeIn.eval(t),a=this.fade.fadeOut.eval(t);return 1-jt(Math.abs(e-n)*r/(e>n?i:a),0,1)}},{key:"getProgressValue",value:function(){var t=this.progress.eval(),e=this._input.min.eval(),n=this._input.max.eval();if(!(e instanceof Date))return t*(n-e)+e;var r=e.getTime(),i=n.getTime();return new Date((1-t)*r+i*t)}},{key:"setTimestamp",value:function(t){var e=_(t),n=this._input.min.eval(),r=this._input.max.eval();if(e.getTime()<n)throw new RangeError("animation.setTimestamp requires the date parameter to be higher than the lower limit");if(e.getTime()>r)throw new RangeError("animation.setTimestamp requires the date parameter to be lower than the higher limit");this.progress.expr=(e.getTime()-n)/(r-n)}},{key:"getProgressPct",value:function(){return this.progress.value}},{key:"setProgressPct",value:function(t){if((t=Number.parseFloat(t))<0||t>1)throw new TypeError("animation.setProgressPct requires a number between 0 and 1 as parameter but got: ".concat(t));this.progress.expr=t}},{key:"pause",value:function(){this._paused=!0}},{key:"play",value:function(){this._paused=!1}},{key:"stop",value:function(){this.progress.expr=0,this._paused=!0}},{key:"_bindMetadata",value:function(t){this._originalInput._bindMetadata(t),this.duration._bindMetadata(t),Lt("animation","input",0,["number","date"],this._originalInput),Lt("animation","duration",1,"number",this.duration),Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("animation","input",0,"number",this._input),Lt("animation","fade",2,"fade",this.fade),Gt("animation","duration",1,this.duration)}}]),e}(Yt),qr=ei("log",function(t){return Math.log(t)},function(t){return"log(".concat(t,")")}),Wr=ei("sqrt",function(t){return Math.sqrt(t)},function(t){return"sqrt(".concat(t,")")}),Yr=ei("sin",function(t){return Math.sin(t)},function(t){return"sin(".concat(t,")")}),Xr=ei("cos",function(t){return Math.cos(t)},function(t){return"cos(".concat(t,")")}),Hr=ei("tan",function(t){return Math.tan(t)},function(t){return"tan(".concat(t,")")}),Zr=ei("sign",function(t){return Math.sign(t)},function(t){return"sign(".concat(t,")")}),Qr=ei("abs",function(t){return Math.abs(t)},function(t){return"abs(".concat(t,")")}),$r=ei("isNaN",function(t){return Number.isNaN(t)?1:0},function(t){return"((".concat(t," == ").concat(Number.MIN_SAFE_INTEGER.toFixed(20),") ? 1. : 0.)")}),Jr=ei("not",function(t){return 1-t},function(t){return"(1.0 - ".concat(t,")")}),Kr=ei("floor",function(t){return Math.floor(t)},function(t){return"floor(".concat(t,")")}),ti=ei("ceil",function(t){return Math.ceil(t)},function(t){return"ceil(".concat(t,")")});function ei(t,e,n){return function(r){function i(e){var r;return A()(this,i),Dt(arguments,1,t),e=It(e),(r=M()(this,R()(i).call(this,{a:e}))).type="number",r.expressionName=t,r.inlineMaker=function(t){return n(t.a)},r}return I()(i,r),G()(i,[{key:"eval",value:function(t){return e(this.a.eval(t))}},{key:"_bindMetadata",value:function(e){if(Zt()(R()(i.prototype),"_bindMetadata",this).call(this,e),Lt(t,"x",0,"number",this.a),"number"!==this.a.type)throw new O("".concat(P.INCORRECT_TYPE," Unary operation cannot be performed to '").concat(this.a.type,"'"))}},{key:"value",get:function(){return this.eval()}}]),i}(Yt)}var ni=function(t){function e(){return A()(this,e),M()(this,R()(e).call(this,{}))}return I()(e,t),e}(Yt);var ri=function(t){function e(t){var n,r=t.property;return A()(this,e),(n=M()(this,R()(e).call(this,{property:It(r),_impostor:_a(0)})))._isViewport=!0,n.type="number",n.inlineMaker=function(t){return t._impostor},n}return I()(e,t),G()(e,[{key:"isFeatureDependent",value:function(){return!1}},{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t)}},{key:"_getMinimumNeededSchema",value:function(){return this.property._getMinimumNeededSchema()}},{key:"_preDraw",value:function(){var t;this._impostor.expr=this.eval();for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=Zt()(R()(e.prototype),"_preDraw",this)).call.apply(t,[this].concat(r))}}]),e}(Yt),ii=function(t){function e(t){var n;return A()(this,e),Dt(arguments,1,"viewportAvg"),(n=M()(this,R()(e).call(this,{property:t})))._sum=0,n._count=0,n}return I()(e,t),G()(e,[{key:"eval",value:function(){return this.value}},{key:"accumViewportAgg",value:function(t){var e=this.property.eval(t);Number.isNaN(e)||(this._count++,this._sum+=e)}},{key:"_resetViewportAgg",value:function(){this._sum=0,this._count=0}},{key:"value",get:function(){return this._sum/this._count}}]),e}(ri),ai=function(t){function e(t){var n;return A()(this,e),Dt(arguments,1,"viewportMax"),(n=M()(this,R()(e).call(this,{property:t})))._value=Number.NEGATIVE_INFINITY,n}return I()(e,t),G()(e,[{key:"eval",value:function(){return this.value}},{key:"accumViewportAgg",value:function(t){var e=this.property.eval(t);Number.isNaN(e)||(this._value=Math.max(this._value,e))}},{key:"_resetViewportAgg",value:function(){this._value=Number.NEGATIVE_INFINITY}},{key:"value",get:function(){return this._value}}]),e}(ri),oi=function(t){function e(t){var n;return A()(this,e),Dt(arguments,1,"viewportMin"),(n=M()(this,R()(e).call(this,{property:t})))._value=Number.POSITIVE_INFINITY,n}return I()(e,t),G()(e,[{key:"eval",value:function(){return this.value}},{key:"accumViewportAgg",value:function(t){var e=this.property.eval(t);Number.isNaN(e)||(this._value=Math.min(this._value,e))}},{key:"_resetViewportAgg",value:function(){this._value=Number.POSITIVE_INFINITY}},{key:"value",get:function(){return this._value}}]),e}(ri),ui=function(t){function e(t){var n;return A()(this,e),Dt(arguments,1,"viewportSum"),(n=M()(this,R()(e).call(this,{property:t})))._value=0,n}return I()(e,t),G()(e,[{key:"eval",value:function(){return this.value}},{key:"accumViewportAgg",value:function(t){var e=this.property.eval(t);Number.isNaN(e)||(this._value=this._value+e)}},{key:"_resetViewportAgg",value:function(){this._value=0}},{key:"value",get:function(){return this._value}}]),e}(ri),si=function(t){function e(){var t;return A()(this,e),Dt(arguments,1,"viewportCount"),(t=M()(this,R()(e).call(this,{property:_a(0)})))._value=0,t}return I()(e,t),G()(e,[{key:"eval",value:function(){return this.value}},{key:"accumViewportAgg",value:function(){this._value++}},{key:"_resetViewportAgg",value:function(){this._value=0}},{key:"value",get:function(){return this._value}}]),e}(ri),ci=function(t){function e(t,n){var r;return A()(this,e),Dt(arguments,2,"viewportPercentile"),(r=M()(this,R()(e).call(this,{property:t,_impostor:_a(0)})))._isViewport=!0,r.percentile=It(n),r.type="number",cn()(R()(e.prototype),"inlineMaker",function(t){return t.impostor},Oe()(r),!0),r}return I()(e,t),G()(e,[{key:"eval",value:function(t){if(null===this._value){var e=jt(function(t,e){return Math.floor(t/100*e)}(this.percentile.eval(t),this._array.length),0,this._array.length-1);this._array.sort(function(t,e){return t-e}),this._value=this._array[e]}return this._value}},{key:"_getMinimumNeededSchema",value:function(){return this.property._getMinimumNeededSchema()}},{key:"_resetViewportAgg",value:function(){this._value=null,this._array=[]}},{key:"accumViewportAgg",value:function(t){var e=this.property.eval(t);this._array.push(e)}},{key:"_preDraw",value:function(){var t;this.impostor.expr=this.eval();for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=Zt()(R()(e.prototype),"_preDraw",this)).call.apply(t,[this].concat(r))}},{key:"value",get:function(){return this.eval()}}]),e}(ri);var fi=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return A()(this,e),Dt(arguments,3,"viewportHistogram"),(n=M()(this,R()(e).call(this,{x:It(t),weight:It(r)}))).type="histogram",n._size=i,n._isViewport=!0,n.inlineMaker=function(){return null},n}return I()(e,t),G()(e,[{key:"accumViewportAgg",value:function(t){var e=this.x.eval(t);if(void 0!==e){var n=this.weight.eval(t),r=this._histogram.get(e)||0;this._histogram.set(e,r+n)}}},{key:"eval",value:function(){return null===this._cached?this._histogram?(this._cached="number"===this.x.type?function(t,e){for(var n=f()(t),r=n.length,i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=0;o<r;o++){var u=n[o][0];i=Math.min(i,u),a=Math.max(a,u)}for(var s=Array(e).fill(0),c=a-i,l=e-1,h=0;h<r;h++){var d=n[h][0],p=n[h][1],v=Math.min(Math.floor(e*(d-i)/c),l);s[v]+=p}return s.map(function(t,n){return{x:[i+n/e*c,i+(n+1)/e*c],y:t}})}(this._histogram,this._size):function(t){return f()(t).map(function(t){var e=Xe()(t,2),n=e[0],r=e[1];return{x:n,y:r}}).sort(li)}(this._histogram),this._cached):null:this._cached}},{key:"getJoinedValues",value:function(t){return Vt("viewportHistogram.getJoinedValues","values",0,t),t.length?this.value.map(function(e){var n=t.find(function(t){return t.key===e.x});return{frequency:e.y,key:e.x,value:-1!==n?n.value:null}}):[]}},{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),this._metadata=t}},{key:"_resetViewportAgg",value:function(t){t&&this._bindMetadata(t),this._cached=null,this._histogram=new Map}}]),e}(Yt);function li(t,e){return e.y-t.y==0?t.x.localeCompare(e.x):e.y-t.y}var hi=function(t){function e(t){var n,r=t.property,i=t.name,a=t.type;return A()(this,e),(n=M()(this,R()(e).call(this,{_value:_a(0)}))).property=It(r),n._name=i,n.type=a,cn()(R()(e.prototype),"inlineMaker",function(t){return t._value},Oe()(n),!0),n}return I()(e,t),G()(e,[{key:"isFeatureDependent",value:function(){return!1}},{key:"eval",value:function(){return this._value.expr}},{key:"_bindMetadata",value:function(t){if(Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),this.property._bindMetadata(t),void 0===t.properties[this.property.name][this._name])throw new O("".concat(P.MISSING_REQUIRED," Metadata ").concat(this._name," for property ").concat(this.property.name," is not defined"));this._value.expr=t.properties[this.property.name][this._name]}},{key:"_getMinimumNeededSchema",value:function(){return Fe()({},this.property.name,[])}},{key:"value",get:function(){return this._value.expr}}]),e}(Yt),di=function(t){function e(t){return A()(this,e),Dt(arguments,1,"globalAvg"),M()(this,R()(e).call(this,{property:t,name:"avg",type:"number"}))}return I()(e,t),e}(hi),pi=function(t){function e(t){return A()(this,e),Dt(arguments,1,"globalCount"),M()(this,R()(e).call(this,{property:t,name:"count",type:"number"}))}return I()(e,t),e}(hi),vi=function(t){function e(t){return A()(this,e),Dt(arguments,1,"globalMax"),M()(this,R()(e).call(this,{property:t,name:"max",type:"number"}))}return I()(e,t),e}(hi),yi=function(t){function e(t){return A()(this,e),Dt(arguments,1,"globalMin"),M()(this,R()(e).call(this,{property:t,name:"min",type:"number"}))}return I()(e,t),e}(hi),mi=function(t){function e(t){return A()(this,e),Dt(arguments,1,"globalSum"),M()(this,R()(e).call(this,{property:t,name:"sum"}))}return I()(e,t),e}(hi),gi=function(t){function e(t,n){var r;if(A()(this,e),Dt(arguments,2,"globalPercentile"),!Number.isFinite(n))throw new O("".concat(P.INCORRECT_TYPE," 'percentile' must be a fixed literal number"));return(r=M()(this,R()(e).call(this,{_value:_a(0)}))).property=t,r.percentile=n,r}return I()(e,t),G()(e,[{key:"isFeatureDependent",value:function(){return!1}},{key:"_bindMetadata",value:function(t){var n=this;Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),this.property._bindMetadata(t),this.type="number",cn()(R()(e.prototype),"inlineMaker",function(t){return t._value},this,!0);var r=t.sample.map(function(t){return t[n.property.name]});r.sort(function(t,e){return t-e});var i=this.percentile/100;this._value.expr=r[Math.floor(i*r.length)]}},{key:"_getMinimumNeededSchema",value:function(){return this.property._getMinimumNeededSchema()}},{key:"value",get:function(){return this._value.expr}}]),e}(Yt),bi=function(t){function e(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return A()(this,e),r=r.map(function(t){return It(t)}),(t=M()(this,R()(e).call(this,function(t){var e=0,n={};return t.forEach(function(t){n["p"+ ++e]=t}),n}(r)))).expr=[],t.type="featureList",t._isViewport=!0,t._requiredProperties=r,t._FeatureProxy=null,t}return I()(e,t),G()(e,[{key:"_applyToShaderSource",value:function(){throw new Q("'viewportFeatures' cannot be used in visualizations.")}},{key:"isFeatureDependent",value:function(){return!1}},{key:"eval",value:function(){return this.expr}},{key:"_resetViewportAgg",value:function(){if(!this._FeatureProxy){if(!this._requiredProperties.every(function(t){return t.isA(Pe)}))throw new O("".concat(P.INCORRECT_TYPE," viewportFeatures arguments can only be properties"));var t=Object.keys(H.simplify(this._getMinimumNeededSchema()));this._FeatureProxy=this.genViewportFeatureClass(t)}this.expr=[]}},{key:"accumViewportAgg",value:function(t){this.expr.push(new this._FeatureProxy(t))}},{key:"genViewportFeatureClass",value:function(t){var e=function t(e){A()(this,t),this._feature=e};return t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this._feature[t]}})}),e}},{key:"value",get:function(){return this.expr}}]),e}(Yt);var _i=function(t){function e(){var t;return A()(this,e),Dt(arguments,0,"zoom"),(t=M()(this,R()(e).call(this,{zoom:_a(0)}))).type="number",cn()(R()(e.prototype),"inlineMaker",function(t){return t.zoom},Oe()(t),!0),t}return I()(e,t),G()(e,[{key:"eval",value:function(){return this.zoom.expr}},{key:"_preDraw",value:function(t,e,n){this.zoom.expr=e.zoomLevel,this.zoom._preDraw(t,e,n)}}]),e}(Yt),xi=function(t){function e(t,n){var r;return A()(this,e),Dt(arguments,2,"placement"),t=It(t),n=It(n),(r=M()(this,R()(e).call(this,{x:t,y:n}))).inlineMaker=function(t){return"vec2(".concat(t.x,", ").concat(t.y,")")},r.type="placement",r}return I()(e,t),G()(e,[{key:"eval",value:function(t){return[this.x.eval(t),this.y.eval(t)]}},{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("placement","x",0,"number",this.x),Lt("placement","y",1,"number",this.y)}}]),e}(Yt),wi=function(t){function e(t){var n;return A()(this,e),t=It(t),n=M()(this,R()(e).call(this,{})),Pt("zoomrange","zoomBreakpointList",0,t),n.zoomBreakpointList=t,n.type="number",n.inlineMaker=function(t){return t._impostor},n}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){if(this.zoomBreakpointList._bindMetadata(t),Lt("zoomrange","zoomBreakpointList",0,"number-list",this.zoomBreakpointList),this.zoomBreakpointList.elems.length<2)throw new O("".concat(P.INCORRECT_VALUE," zoomrange() function must receive a list with at least two elements."));var n=f()(this.zoomBreakpointList.elems);this._impostor=function t(e,n,r){if(1===e.length)return 1;var i=e[0];var a=e[1];e.shift();return $i(n/r,t(e,n+1,r),ya(Oi(2,vo()),Oi(2,i),Oi(2,a)))}(n,0,n.length-1),this.childrenNames.push("_impostor"),Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t)}},{key:"eval",value:function(t){return this._impostor.eval(t)}}]),e}(Yt);var Ti=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return A()(this,e),t=It(t),r=It(r),(n=M()(this,R()(e).call(this,{scale:Ii(Di(t,0),Oi(2,r))}))).type="number",n.inlineMaker=function(t){return t.scale},n}return I()(e,t),G()(e,[{key:"eval",value:function(){return this.scale.eval()}},{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("scaled","width",0,"number",this.scale.a.a),Lt("scaled","zoomlevel",1,"number",this.scale.b)}},{key:"_preDraw",value:function(t,n,r){this.scale.a.b.expr=Math.pow(2,n.zoomLevel),Zt()(R()(e.prototype),"_preDraw",this).call(this,t,n,r)}}]),e}(Yt),Ei=function(t){function e(t,n){var r;return A()(this,e),Dt(arguments,2,"alphaNormalize"),Pt("alphaNormalize","input",0,t),Pt("alphaNormalize","normalizer",1,n),(r=M()(this,R()(e).call(this,{_impostor:xa(t,Ii(n,co(n)))})))._input=t,r._normalizer=n,r.type="color",r.inlineMaker=function(t){return t._impostor},r}return I()(e,t),G()(e,[{key:"_bindMetadata",value:function(t){this._input._bindMetadata(t),this._normalizer._bindMetadata(t),Lt("alphaNormalize","input",0,"color",this._input),Lt("alphaNormalize","normalizer",1,"number",this._normalizer),Bt("alphaNormalize","normalizer",1,Pe,this._normalizer),Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t)}},{key:"eval",value:function(t){return this._impostor.eval(t)}},{key:"value",get:function(){return this.eval()}}]),e}(Yt),ki=function(t){function e(t,n){var r;return A()(this,e),Dt(arguments,2,"translate"),t=It(t),n=It(n),(r=M()(this,R()(e).call(this,{x:t,y:n}))).type="transformation",r}return I()(e,t),G()(e,[{key:"_applyToShaderSource",value:function(t){var e=this.x._applyToShaderSource(t),n=this.y._applyToShaderSource(t);return{preface:this._prefaceCode("\n                ".concat(e.preface,"\n                ").concat(n.preface,"\n\n                vec2 translate").concat(this._uid,"(vec2 p){\n                    return p+vec2(").concat(e.inline,", ").concat(n.inline,");\n                }")),inline:"translate".concat(this._uid)}}},{key:"eval",value:function(t){return[this.x.eval(t),this.y.eval(t)]}},{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("translate","x",0,"number",this.x),Lt("translate","y",1,"number",this.y)}}]),e}(Yt),Ai=function(t){function e(t){var n;return A()(this,e),Dt(arguments,1,"rotate"),t=It(t),(n=M()(this,R()(e).call(this,{angle:t}))).type="transformation",n}return I()(e,t),G()(e,[{key:"_applyToShaderSource",value:function(t){var e=this.angle._applyToShaderSource(t);return{preface:this._prefaceCode("\n                ".concat(e.preface,"\n\n                #ifndef DEGREES_TO_RADIANS\n                #define DEGREES_TO_RADIANS\n                float degreesToRadians(float degrees){\n                    return degrees/360.*2.*3.14159265359;\n                }\n                #endif\n                \n                vec2 rotate").concat(this._uid,"(vec2 p){\n                    float angle = degreesToRadians(").concat(e.inline,");\n                    mat2 M = mat2(cos(angle), -sin(angle),\n                                  sin(angle),  cos(angle));\n                    return M * p;\n                }")),inline:"rotate".concat(this._uid)}}},{key:"eval",value:function(t){return[0,0]}},{key:"_bindMetadata",value:function(t){Zt()(R()(e.prototype),"_bindMetadata",this).call(this,t),Lt("rotate","angle",0,"number",this.angle)}}]),e}(Yt),Ci=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Xt,e)},Mi=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Qt,e)},Si=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()($t,e)},Ri=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Kt,e)},Di=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(oe,e)},Ii=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(ue,e)},Fi=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(se,e)},Ni=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(ce,e)},Oi=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(le,e)},Pi=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(fe,e)},Li=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(he,e)},Bi=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(de,e)},Ui=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(pe,e)},zi=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(ve,e)},Vi=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(ye,e)},Gi=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(me,e)},ji=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(be,e)},qi=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(ge,e)},Wi=Li,Yi=Bi,Xi=Ui,Hi=zi,Zi=Vi,Qi=Gi,$i=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(we,e)},Ji=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Ce,e)},Ki=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(De,e)},ta=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Be,e)},ea=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Ue,e)},na=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(ze,e)},ra=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Ve,e)},ia=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Ge,e)},aa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(je,e)},oa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(qe,e)},ua=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Er,e)},sa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(kr,e)},ca=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(We,e)},fa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(He,e)},la=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Ze,e)},ha=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()($e,e)},da=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Je,e)},pa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(en,e)},va=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(tn,e)},ya=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(rn,e)},ma=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Nr,e)},ga=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(on,e)},ba=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(fn,e)},_a=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(ln,e)},xa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(hn,e)},wa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(dn,e)},Ta=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(pn,e)},Ea=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(vn,e)},ka=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(yn,e)},Aa=function(t){return Dt(arguments,1,"reverse"),"palette"===(t=It(t)).type?new En(t):new kn(t)},Ca=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Pe,e)},Ma=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Sn,e)},Sa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Nn,e)},Ra=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Mn,e)},Da=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Fn,e)},Ia=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Dn,e)},Fa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(On,e)},Na=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Rr,e)},Oa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(gn,e)},Pa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(bn,e)},La=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Me,e)},Ba=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Or,e)},Ua=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Lr,e)},za=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(zr,e)},Va=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(jr,e)},Ga=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(qr,e)},ja=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Wr,e)},qa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Yr,e)},Wa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Xr,e)},Ya=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Hr,e)},Xa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Zr,e)},Ha=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Qr,e)},Za=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()($r,e)},Qa=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Jr,e)},$a=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Kr,e)},Ja=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(ti,e)},Ka=function(){return function(t){if(Dt(arguments,1,"variable"),zt("variable","name",0,t),""===t)throw new O("".concat(P.INCORRECT_VALUE," variable(): invalid parameter, zero-length string"));var e,n=function(n){if(!n[t])throw new O("".concat(P.MISSING_REQUIRED," variable() with name '").concat(t,"' doesn't exist"));e=n[t]},r=function(){return[e]},i={set:function(t,n,r){if("parent"===n)t[n]=r;else if("notify"===n)t[n]=r;else{if(!e||!e[n])return!1;e[n]=r}return!0},get:function(t,i){return"parent"===i?t[i]:"_resolveAliases"===i?n:"_getDependencies"===i?r:"notify"===i?t[i]:"blendTo"===i?t[i]:e&&e[i]?function(t){return t&&"[object Function]"==={}.toString.call(t)}(e[i])?e[i].bind(e):e[i]:t[i]}};return new Proxy(new ni,i)}.apply(void 0,arguments)},to=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(ii,e)},eo=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(ai,e)},no=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(oi,e)},ro=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(ui,e)},io=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(si,e)},ao=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(ci,e)},oo=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(fi,e)},uo=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(bi,e)},so=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(di,e)},co=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(vi,e)},fo=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(yi,e)},lo=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(mi,e)},ho=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(pi,e)},po=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(gi,e)},vo=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(_i,e)},yo=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Ti,e)},mo=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(wi,e)},go=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(xi,e)},bo=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(ki,e)},_o=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Ai,e)},xo=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Et()(Ei,e)},wo=new qe(Number.MAX_SAFE_INTEGER),To=new qe(1),Eo=new qe(0),ko=new qe(Math.PI),Ao=new qe(Math.E),Co=new kr(_r.bicycle),Mo=new kr(_r.building),So=new kr(_r.bus),Ro=new kr(_r.car),Do=new kr(_r.circle),Io=new kr(_r.circleOutline),Fo=new kr(_r.cross),No=new kr(_r.flag),Oo=new kr(_r.house),Po=new kr(_r.marker),Lo=new kr(_r.markerOutline),Bo=new kr(_r.plus),Uo=new kr(_r.square),zo=new kr(_r.squareOutline),Vo=new kr(_r.star),Go=new kr(_r.starOutline),jo=new kr(_r.triangle),qo=new kr(_r.triangleOutline),Wo=new xi(oa(0),oa(0)),Yo=new xi(oa(0),oa(1)),Xo=n(9),Ho=n.n(Xo),Zo=[],Qo={};Object.keys(a).filter(function(t){return t[0]===t[0].toLowerCase()}).map(function(t){Qo[t.toLocaleLowerCase()]=a[t]}),Qo.true=To,Qo.false=Eo,Qo.align_center=Wo,Qo.align_bottom=Yo,Qo.pi=ko,Qo.e=Ao,Qo.hold=wo,Qo.bicycle=Co,Qo.building=Mo,Qo.bus=So,Qo.car=Ro,Qo.circle=Do,Qo.circle_outline=Io,Qo.cross=Fo,Qo.flag=No,Qo.house=Oo,Qo.marker=Po,Qo.marker_outline=Lo,Qo.plus=Bo,Qo.square=Uo,Qo.square_outline=zo,Qo.star=Vo,Qo.star_outline=Go,Qo.triangle=jo,Qo.triangle_outline=qo;var $o=Yt.prototype.blendTo;function Jo(t){eu();var e=It(tu(Ho()(t)));return nu(),e}function Ko(t,e){if(":"!==e.operator)throw new kt("Invalid syntax.");e.left.name.length&&"@"===e.left.name[0]&&(e.left.name="__cartovl_variable_"+e.left.name.substr(1));var n=e.left.name;if(!n)throw new kt("Invalid syntax.");if(n.startsWith("__cartovl_variable_")){if((n=e.left.name.substr("__cartovl_variable_".length))in t.variables)throw new kt("Variable '".concat(n,"' is already defined."));t.variables[n]=It(tu(e.right))}else{if(n in t)throw new kt("Property '".concat(n,"' is already defined."));var r=tu(e.right);t[n]="resolution"===n?r:It(r)}}function tu(t){if("CallExpression"===t.type)return function(t){var e=t.callee.name.toLowerCase();if(Zo.includes(e))return t.arguments.map(function(t){return tu(t)})[0];var n=t.arguments.map(function(t){return tu(t)});if(Qo[e])return Qo[e].apply(Qo,f()(n));throw new kt("Invalid function name '".concat(t.callee.name,"'."))}(t);if("Literal"===t.type)return t.value;if("ArrayExpression"===t.type)return t.elements.map(function(t){return tu(t)});if("BinaryExpression"===t.type)return function(t){var e=tu(t.left),n=tu(t.right);switch(t.operator.toLowerCase()){case"*":return Di(e,n);case"/":return Ii(e,n);case"+":return Fi(e,n);case"-":return Ni(e,n);case"%":return Pi(e,n);case"^":return Oi(e,n);case">":return Li(e,n);case">=":return Bi(e,n);case"<":return Ui(e,n);case"<=":return zi(e,n);case"==":return Vi(e,n);case"!=":return Gi(e,n);case"and":return ji(e,n);case"or":return qi(e,n);case"in":return Mi(e,n);case"nin":return Si(e,n);default:throw new kt("Invalid binary operator '".concat(t.operator,"'."))}}(t);if("UnaryExpression"===t.type)return function(t){switch(t.operator){case"-":return Di(-1,tu(t.argument));case"+":return tu(t.argument);default:throw new kt("Invalid unary operator '".concat(t.operator,"'."))}}(t);if("Identifier"===t.type)return function(t){if(t.name.length&&"@"===t.name[0]&&(t.name="__cartovl_variable_"+t.name.substr(1)),t.name.startsWith("__cartovl_variable_"))return Ka(t.name.substr("__cartovl_variable_".length));if("#"===t.name[0])return new We(t.name);if("$"===t.name[0])return Ca(t.name.substring(1));if(Tn[t.name.toUpperCase()])return Tn[t.name.toUpperCase()];if(Qo[t.name.toLowerCase()])return Qo[t.name.toLowerCase()];if(an.includes(t.name.toLowerCase()))return new on(t.name.toLowerCase());throw new kt("Invalid expression '".concat(JSON.stringify(t),"'."))}(t);throw new kt("Invalid expression '".concat(JSON.stringify(t),"'."))}function eu(){Ho.a.addBinaryOp(":",0),Ho.a.addBinaryOp("^",11),Ho.a.addBinaryOp("or",1),Ho.a.addBinaryOp("OR",1),Ho.a.addBinaryOp("and",2),Ho.a.addBinaryOp("AND",2),Ho.a.addBinaryOp("in",13),Ho.a.addBinaryOp("IN",1),Ho.a.addBinaryOp("nin",13),Ho.a.addBinaryOp("NIN",13),Ho.a.addIdentifierChar("@"),Ho.a.addIdentifierChar("#"),Ho.a.removeLiteral("true"),Ho.a.removeLiteral("false")}function nu(){Ho.a.removeBinaryOp("in"),Ho.a.removeBinaryOp("IN"),Ho.a.removeBinaryOp("nin"),Ho.a.removeBinaryOp("NIN"),Ho.a.removeBinaryOp("and"),Ho.a.removeBinaryOp("AND"),Ho.a.removeBinaryOp("or"),Ho.a.removeBinaryOp("OR"),Ho.a.removeBinaryOp("^"),Ho.a.removeBinaryOp(":"),Ho.a.removeIdentifierChar("@"),Ho.a.removeIdentifierChar("#"),Ho.a.addLiteral("true"),Ho.a.addLiteral("false")}Yt.prototype.blendTo=function(t){"string"==typeof t&&(t=Jo(t));for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return $o.bind(this).apply(void 0,[t].concat(n))};var ru=n(52),iu=n.n(ru),au=n(53),ou=n.n(au),uu=n(54),su=n.n(uu),cu=n(55),fu=n.n(cu),lu=n(56),hu=n.n(lu),du=n(57),pu=n.n(du),vu=["color","width","strokeColor","strokeWidth","order","filter","symbol","symbolPlacement","transform","resolution","variables"],yu=function(){function t(e){var n=this;A()(this,t);var r=this._getVizDefinition(e);this._checkVizSpec(r),Object.keys(r).forEach(function(t){n._defineProperty(t,r[t])}),Object.keys(r).includes("variables")||this._defineProperty("variables",{}),this.updated=!0,this._changeCallback=null,this._updateRootExpressionList(),this._updateRootExpressions(),this._resolveAliases(),this._validateAliasDAG()}return G()(t,[{key:"loadImages",value:function(){return Promise.all(this._getRootExpressions().map(function(t){return t.loadImages()}))}},{key:"_defineProperty",value:function(t,e){var n=this;if(vu.includes(t)){Object.defineProperty(this,t,{get:function(){return n["_"+t]},set:function(e){"resolution"!==t&&(e=It(e)),n["_"+t]=e,n._changed()}});var r=e;if("variables"===t){var i=!1;r=new Proxy({},{get:function(t,e){return t[e]},set:function(t,e,r){return r=It(r),t[e]=r,n["__cartovl_variable_"+e]=r,i&&n._changed(),!0}}),Object.keys(e).map(function(t){r[t]=e[t]}),i=!0}this["_"+t]=r}}},{key:"_getRootExpressions",value:function(){return this._rootExpressions}},{key:"_getRootStyleExpressions",value:function(){return this._rootStyleExpressions}},{key:"_updateRootExpressions",value:function(){var t=this;this._getRootExpressions().forEach(function(e){e.parent=t,e.notify=t._changed.bind(t)})}},{key:"isAnimated",value:function(){return this._getRootStyleExpressions().some(function(t){return t.isAnimated()})}},{key:"onChange",value:function(t){this._changeCallback=t}},{key:"_changed",value:function(){this._updateRootExpressionList(),this._resolveAliases(),this._validateAliasDAG(),this._changeCallback&&this._changeCallback(this)}},{key:"_updateRootExpressionList",value:function(){this._rootExpressions=[this.color,this.width,this.strokeColor,this.strokeWidth,this.order,this.filter,this.symbol,this.symbolPlacement,this.transform].concat(f()(Object.values(this.variables))),this._rootStyleExpressions=[this.color,this.width,this.strokeColor,this.strokeWidth,this.order,this.filter,this.symbol,this.symbolPlacement,this.transform]}},{key:"getMinimumNeededSchema",value:function(){return this._getRootExpressions().filter(function(t){return t&&t._getMinimumNeededSchema}).map(function(t){return t._getMinimumNeededSchema()}).reduce(H.union,H.IDENTITY)}},{key:"setDefaultsIfRequired",value:function(t){if(this._geomType=t,!this._appliedDefaults){var e=this._getDefaultGeomStyle(t);e&&(this._appliedDefaults=!0,this.color.default&&(this.color=e.COLOR_EXPRESSION()),this.width.default&&(this.width=e.WIDTH_EXPRESSION()),this.strokeColor.default&&(this.strokeColor=e.STROKE_COLOR_EXPRESSION()),this.strokeWidth.default&&(this.strokeWidth=e.STROKE_WIDTH_EXPRESSION()),this._updateRootExpressions())}}},{key:"_getDefaultGeomStyle",value:function(t){return"point"===t?{COLOR_EXPRESSION:function(){return mu(ca("#EE4D5A"))},WIDTH_EXPRESSION:function(){return mu(_a(7))},STROKE_COLOR_EXPRESSION:function(){return mu(ca("#FFF"))},STROKE_WIDTH_EXPRESSION:function(){return mu(_a(1))}}:"line"===t?{COLOR_EXPRESSION:function(){return mu(ca("#4CC8A3"))},WIDTH_EXPRESSION:function(){return mu(_a(1.5))},STROKE_COLOR_EXPRESSION:function(){return mu(ca("#FFF"))},STROKE_WIDTH_EXPRESSION:function(){return mu(_a(1))}}:"polygon"===t?{COLOR_EXPRESSION:function(){return mu(ca("#826DBA"))},WIDTH_EXPRESSION:function(){return mu(_a(1))},STROKE_COLOR_EXPRESSION:function(){return mu(ca("#FFF"))},STROKE_WIDTH_EXPRESSION:function(){return mu(_a(1))}}:void 0}},{key:"_resolveAliases",value:function(){var t=this;this._getRootExpressions().forEach(function(e){e._resolveAliases(t.variables)})}},{key:"_validateAliasDAG",value:function(){for(var t=new Set,e=new Set,n=function n(r){if(!t.has(r)){if(e.has(r))throw new Q("Viz contains a circular dependency");e.add(r),r._getDependencies().forEach(n),t.add(r)}},r=this._getRootExpressions().map(function(t){return t._getDependencies()}).reduce(function(t,e){return f()(t).concat(f()(e))},[]);r.length;)n(r.pop())}},{key:"compileShaders",value:function(t,e){this._getRootExpressions().forEach(function(t){return t._bindMetadata(e)}),function(t){var e={color:"color",strokeColor:"color",width:"number",strokeWidth:"number",order:"orderer",filter:"number",symbol:"image",symbolPlacement:"placement",transform:"transformation"};Object.keys(e).forEach(function(n){var r=t[n].type,i=e[n];if(r!==i)throw new O("".concat(P.INCORRECT_TYPE," Viz property '").concat(n,"': must be of type '").concat(i,"' but it was of type '").concat(r,"'"))})}(this),this.colorShader=wt(t,_t.styler.colorShaderGLSL,{color:this.color},this),this.widthShader=wt(t,_t.styler.widthShaderGLSL,{width:this.width},this),this.strokeColorShader=wt(t,_t.styler.colorShaderGLSL,{color:this.strokeColor},this),this.strokeWidthShader=wt(t,_t.styler.widthShaderGLSL,{width:this.strokeWidth},this),this.filterShader=wt(t,_t.styler.filterShaderGLSL,{filter:this.filter},this),this.symbol.default||(this.symbolShader=wt(t,_t.symbolizer.symbolShaderGLSL,{symbol:this.symbol,symbolPlacement:this.symbolPlacement,transform:this.transform},this)),this._geomType&&"point"!==this._geomType||(this.pointShader=wt(t,{vertexShader:iu.a,fragmentShader:ou.a},{transform:this.transform},this)),this._geomType&&"line"!==this._geomType||(this.lineShader=wt(t,{vertexShader:su.a,fragmentShader:fu.a},{transform:this.transform},this)),this._geomType&&"polygon"!==this._geomType||(this.polygonShader=wt(t,{vertexShader:hu.a,fragmentShader:pu.a},{transform:this.transform},this))}},{key:"replaceChild",value:function(t,e){var n=this;if(Object.values(this.variables).includes(t)){var r=Object.keys(this.variables).find(function(e){return n.variables[e]===t});this.variables[r]=e,e.parent=this,e.notify=t.notify}else if(t===this.color)this.color=e,e.parent=this,e.notify=t.notify;else if(t===this.width)this.width=e,e.parent=this,e.notify=t.notify;else if(t===this.strokeColor)this.strokeColor=e,e.parent=this,e.notify=t.notify;else if(t===this.strokeWidth)this.strokeWidth=e,e.parent=this,e.notify=t.notify;else if(t===this.filter)this.filter=e,e.parent=this,e.notify=t.notify;else if(t===this.symbol)this.symbol=e,e.parent=this,e.notify=t.notify;else if(t===this.symbolPlacement)this.symbolPlacement=e,e.parent=this,e.notify=t.notify;else{if(t!==this.transform)throw new Q("No child found");this.transform=e,e.parent=this,e.notify=t.notify}}},{key:"_getVizDefinition",value:function(t){if(E.isUndefined(t))return this._setDefaults({});if(E.isObject(t))return this._setDefaults(t);if(E.isString(t))return this._setDefaults(function(t){eu();var e=Ho()(function(t){for(var e={singleQuote:!1,doubleQuote:!1,blockComment:!1,lineComment:!1,escape:0},n=0,r=(t=("_"+t+"_").split("")).length;n<r;n++)if(e.singleQuote)"\\"===t[n]?e.escape++:"'"===t[n]&&e.escape%2==0&&(e.singleQuote=!1,e.escape=0);else if(e.doubleQuote)"\\"===t[n]?e.escape++:'"'===t[n]&&e.escape%2==0&&(e.doubleQuote=!1,e.escape=0);else if(e.blockComment)"*"===t[n]&&"/"===t[n+1]&&(t[n+1]="",e.blockComment=!1),t[n]="";else if(e.lineComment)"\n"!==t[n+1]&&"\r"!==t[n+1]||(e.lineComment=!1),n+1<r&&(t[n]="");else if(e.doubleQuote='"'===t[n],e.singleQuote="'"===t[n],"/"===t[n]){if("*"===t[n+1]){t[n]="",e.blockComment=!0;continue}if("/"===t[n+1]){t[n]="",e.lineComment=!0;continue}}return t.join("").slice(1,-1)}(t)),n={variables:{}};return"Compound"===e.type?e.body.map(function(t){return Ko(n,t)}):Ko(n,e),nu(),n}(t));throw new O("".concat(P.INCORRECT_VALUE," viz 'definition' should be a vizSpec object or a valid viz string."))}},{key:"_setDefaults",value:function(t){if(E.isUndefined(t.color)){var e=Pa(0,0,0,0);t.color=E.isUndefined(t.symbol)?mu(Oa(0,0,0)):e}return E.isUndefined(t.width)&&(t.width=mu(_a(1))),E.isUndefined(t.strokeColor)&&(t.strokeColor=mu(Oa(0,0,0))),E.isUndefined(t.strokeWidth)&&(t.strokeWidth=mu(_a(0))),E.isUndefined(t.order)&&(t.order=mu(Ea())),E.isUndefined(t.filter)&&(t.filter=mu(oa(1))),E.isUndefined(t.resolution)&&(t.resolution=1),E.isUndefined(t.symbol)&&(t.symbol=mu(new kr(_r.circle))),E.isUndefined(t.symbolPlacement)&&(t.symbolPlacement=mu(new xi(oa(0),oa(1)))),E.isUndefined(t.transform)&&(t.transform=mu(new ki(oa(0),oa(0)))),t.variables=t.variables||{},t}},{key:"_checkVizSpec",value:function(t){if(t.width=It(t.width),t.strokeWidth=It(t.strokeWidth),t.symbolPlacement=It(t.symbolPlacement),t.transform=It(t.transform),t.symbol=It(t.symbol),t.filter=It(t.filter),!E.isNumber(t.resolution))throw new O("".concat(P.INCORRECT_TYPE," 'resolution' property must be a number."));if(t.resolution<=0)throw new O("".concat(P.INCORRECT_VALUE," 'resolution' must be greater than ").concat(0,"."));if(t.resolution>=256)throw new O("".concat(P.INCORRECT_VALUE," 'resolution' must be less than ").concat(256,"."));for(var e in["color","strokeColor","width","strokeWidth","order","filter","symbol","symbolPlacement","transform"].forEach(function(e){if(!(t[e]instanceof Yt))throw new O("".concat(P.INCORRECT_TYPE," '").concat(e,"' parameter is not a valid viz Expresion."))}),t)-1===vu.indexOf(e)&&console.warn("Property '".concat(e,"' is not supported"))}},{key:"toString",value:function(){var t=this,e=Object.keys(this.variables).map(function(e){return"@".concat(e,": ").concat(t.variables[e].toString(),"\n")});return"color: ".concat(this.color.toString(),"\n            strokeColor: ").concat(this.strokeColor.toString(),"\n            width: ").concat(this.width.toString(),"\n            strokeWidth: ").concat(this.strokeWidth.toString(),"\n            filter: ").concat(this.filter.toString(),"\n            order: ").concat(this.order.toString(),"\n            symbol: ").concat(this.symbol.toString(),"\n            symbolPlacement: ").concat(this.symbolPlacement.toString(),"\n            offset: ").concat(this.offset.toString(),"\n            ").concat(e).replace(/ {4}/g,"")}},{key:"geometryType",get:function(){return this._geomType}}]),t}();function mu(t){return t.default=!0,t}var gu=function(t){return t=t||Object.create(null),{on:function(e,n){(t[e]||(t[e]=[])).push(n)},off:function(e,n){t[e]&&t[e].splice(t[e].indexOf(n)>>>0,1)},emit:function(e,n){(t[e]||[]).slice().map(function(t){t(n)}),(t["*"]||[]).slice().map(function(t){t(e,n)})}}},bu=n(8),_u=n.n(bu),xu=n(10),wu=n.n(xu),Tu=function t(){A()(this,t)},Eu=1e-6,ku="undefined"!=typeof Float32Array?Float32Array:Array,Au=Math.random;Math.PI;function Cu(){var t=new ku(16);return ku!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Mu(t){var e=new ku(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Su(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ru(t,e,n,r,i,a,o,u,s,c,f,l,h,d,p,v){var y=new ku(16);return y[0]=t,y[1]=e,y[2]=n,y[3]=r,y[4]=i,y[5]=a,y[6]=o,y[7]=u,y[8]=s,y[9]=c,y[10]=f,y[11]=l,y[12]=h,y[13]=d,y[14]=p,y[15]=v,y}function Du(t,e,n,r,i,a,o,u,s,c,f,l,h,d,p,v,y){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=u,t[7]=s,t[8]=c,t[9]=f,t[10]=l,t[11]=h,t[12]=d,t[13]=p,t[14]=v,t[15]=y,t}function Iu(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Fu(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Nu(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=e[9],h=e[10],d=e[11],p=e[12],v=e[13],y=e[14],m=e[15],g=n*u-r*o,b=n*s-i*o,_=n*c-a*o,x=r*s-i*u,w=r*c-a*u,T=i*c-a*s,E=f*v-l*p,k=f*y-h*p,A=f*m-d*p,C=l*y-h*v,M=l*m-d*v,S=h*m-d*y,R=g*S-b*M+_*C+x*A-w*k+T*E;return R?(R=1/R,t[0]=(u*S-s*M+c*C)*R,t[1]=(i*M-r*S-a*C)*R,t[2]=(v*T-y*w+m*x)*R,t[3]=(h*w-l*T-d*x)*R,t[4]=(s*A-o*S-c*k)*R,t[5]=(n*S-i*A+a*k)*R,t[6]=(y*_-p*T-m*b)*R,t[7]=(f*T-h*_+d*b)*R,t[8]=(o*M-u*A+c*E)*R,t[9]=(r*A-n*M-a*E)*R,t[10]=(p*w-v*_+m*g)*R,t[11]=(l*_-f*w-d*g)*R,t[12]=(u*k-o*C-s*E)*R,t[13]=(n*C-r*k+i*E)*R,t[14]=(v*b-p*x-y*g)*R,t[15]=(f*x-l*b+h*g)*R,t):null}function Ou(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=e[9],h=e[10],d=e[11],p=e[12],v=e[13],y=e[14],m=e[15];return t[0]=u*(h*m-d*y)-l*(s*m-c*y)+v*(s*d-c*h),t[1]=-(r*(h*m-d*y)-l*(i*m-a*y)+v*(i*d-a*h)),t[2]=r*(s*m-c*y)-u*(i*m-a*y)+v*(i*c-a*s),t[3]=-(r*(s*d-c*h)-u*(i*d-a*h)+l*(i*c-a*s)),t[4]=-(o*(h*m-d*y)-f*(s*m-c*y)+p*(s*d-c*h)),t[5]=n*(h*m-d*y)-f*(i*m-a*y)+p*(i*d-a*h),t[6]=-(n*(s*m-c*y)-o*(i*m-a*y)+p*(i*c-a*s)),t[7]=n*(s*d-c*h)-o*(i*d-a*h)+f*(i*c-a*s),t[8]=o*(l*m-d*v)-f*(u*m-c*v)+p*(u*d-c*l),t[9]=-(n*(l*m-d*v)-f*(r*m-a*v)+p*(r*d-a*l)),t[10]=n*(u*m-c*v)-o*(r*m-a*v)+p*(r*c-a*u),t[11]=-(n*(u*d-c*l)-o*(r*d-a*l)+f*(r*c-a*u)),t[12]=-(o*(l*y-h*v)-f*(u*y-s*v)+p*(u*h-s*l)),t[13]=n*(l*y-h*v)-f*(r*y-i*v)+p*(r*h-i*l),t[14]=-(n*(u*y-s*v)-o*(r*y-i*v)+p*(r*s-i*u)),t[15]=n*(u*h-s*l)-o*(r*h-i*l)+f*(r*s-i*u),t}function Pu(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],u=t[6],s=t[7],c=t[8],f=t[9],l=t[10],h=t[11],d=t[12],p=t[13],v=t[14],y=t[15];return(e*o-n*a)*(l*y-h*v)-(e*u-r*a)*(f*y-h*p)+(e*s-i*a)*(f*v-l*p)+(n*u-r*o)*(c*y-h*d)-(n*s-i*o)*(c*v-l*d)+(r*s-i*u)*(c*p-f*d)}function Lu(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],h=e[9],d=e[10],p=e[11],v=e[12],y=e[13],m=e[14],g=e[15],b=n[0],_=n[1],x=n[2],w=n[3];return t[0]=b*r+_*u+x*l+w*v,t[1]=b*i+_*s+x*h+w*y,t[2]=b*a+_*c+x*d+w*m,t[3]=b*o+_*f+x*p+w*g,b=n[4],_=n[5],x=n[6],w=n[7],t[4]=b*r+_*u+x*l+w*v,t[5]=b*i+_*s+x*h+w*y,t[6]=b*a+_*c+x*d+w*m,t[7]=b*o+_*f+x*p+w*g,b=n[8],_=n[9],x=n[10],w=n[11],t[8]=b*r+_*u+x*l+w*v,t[9]=b*i+_*s+x*h+w*y,t[10]=b*a+_*c+x*d+w*m,t[11]=b*o+_*f+x*p+w*g,b=n[12],_=n[13],x=n[14],w=n[15],t[12]=b*r+_*u+x*l+w*v,t[13]=b*i+_*s+x*h+w*y,t[14]=b*a+_*c+x*d+w*m,t[15]=b*o+_*f+x*p+w*g,t}function Bu(t,e,n){var r=n[0],i=n[1],a=n[2],o=void 0,u=void 0,s=void 0,c=void 0,f=void 0,l=void 0,h=void 0,d=void 0,p=void 0,v=void 0,y=void 0,m=void 0;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*a+e[12],t[13]=e[1]*r+e[5]*i+e[9]*a+e[13],t[14]=e[2]*r+e[6]*i+e[10]*a+e[14],t[15]=e[3]*r+e[7]*i+e[11]*a+e[15]):(o=e[0],u=e[1],s=e[2],c=e[3],f=e[4],l=e[5],h=e[6],d=e[7],p=e[8],v=e[9],y=e[10],m=e[11],t[0]=o,t[1]=u,t[2]=s,t[3]=c,t[4]=f,t[5]=l,t[6]=h,t[7]=d,t[8]=p,t[9]=v,t[10]=y,t[11]=m,t[12]=o*r+f*i+p*a+e[12],t[13]=u*r+l*i+v*a+e[13],t[14]=s*r+h*i+y*a+e[14],t[15]=c*r+d*i+m*a+e[15]),t}function Uu(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function zu(t,e,n,r){var i,a,o,u,s,c,f,l,h,d,p,v,y,m,g,b,_,x,w,T,E,k,A,C,M=r[0],S=r[1],R=r[2],D=Math.sqrt(M*M+S*S+R*R);return D<Eu?null:(M*=D=1/D,S*=D,R*=D,i=Math.sin(n),o=1-(a=Math.cos(n)),u=e[0],s=e[1],c=e[2],f=e[3],l=e[4],h=e[5],d=e[6],p=e[7],v=e[8],y=e[9],m=e[10],g=e[11],b=M*M*o+a,_=S*M*o+R*i,x=R*M*o-S*i,w=M*S*o-R*i,T=S*S*o+a,E=R*S*o+M*i,k=M*R*o+S*i,A=S*R*o-M*i,C=R*R*o+a,t[0]=u*b+l*_+v*x,t[1]=s*b+h*_+y*x,t[2]=c*b+d*_+m*x,t[3]=f*b+p*_+g*x,t[4]=u*w+l*T+v*E,t[5]=s*w+h*T+y*E,t[6]=c*w+d*T+m*E,t[7]=f*w+p*T+g*E,t[8]=u*k+l*A+v*C,t[9]=s*k+h*A+y*C,t[10]=c*k+d*A+m*C,t[11]=f*k+p*A+g*C,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Vu(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],o=e[5],u=e[6],s=e[7],c=e[8],f=e[9],l=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+c*r,t[5]=o*i+f*r,t[6]=u*i+l*r,t[7]=s*i+h*r,t[8]=c*i-a*r,t[9]=f*i-o*r,t[10]=l*i-u*r,t[11]=h*i-s*r,t}function Gu(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],u=e[2],s=e[3],c=e[8],f=e[9],l=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-c*r,t[1]=o*i-f*r,t[2]=u*i-l*r,t[3]=s*i-h*r,t[8]=a*r+c*i,t[9]=o*r+f*i,t[10]=u*r+l*i,t[11]=s*r+h*i,t}function ju(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],u=e[2],s=e[3],c=e[4],f=e[5],l=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+c*r,t[1]=o*i+f*r,t[2]=u*i+l*r,t[3]=s*i+h*r,t[4]=c*i-a*r,t[5]=f*i-o*r,t[6]=l*i-u*r,t[7]=h*i-s*r,t}function qu(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Wu(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Yu(t,e,n){var r,i,a,o=n[0],u=n[1],s=n[2],c=Math.sqrt(o*o+u*u+s*s);return c<Eu?null:(o*=c=1/c,u*=c,s*=c,r=Math.sin(e),a=1-(i=Math.cos(e)),t[0]=o*o*a+i,t[1]=u*o*a+s*r,t[2]=s*o*a-u*r,t[3]=0,t[4]=o*u*a-s*r,t[5]=u*u*a+i,t[6]=s*u*a+o*r,t[7]=0,t[8]=o*s*a+u*r,t[9]=u*s*a-o*r,t[10]=s*s*a+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Xu(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Hu(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Zu(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Qu(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],u=r+r,s=i+i,c=a+a,f=r*u,l=r*s,h=r*c,d=i*s,p=i*c,v=a*c,y=o*u,m=o*s,g=o*c;return t[0]=1-(d+v),t[1]=l+g,t[2]=h-m,t[3]=0,t[4]=l-g,t[5]=1-(f+v),t[6]=p+y,t[7]=0,t[8]=h+m,t[9]=p-y,t[10]=1-(f+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function $u(t,e){var n=new ku(3),r=-e[0],i=-e[1],a=-e[2],o=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=r*r+i*i+a*a+o*o;return l>0?(n[0]=2*(u*o+f*r+s*a-c*i)/l,n[1]=2*(s*o+f*i+c*r-u*a)/l,n[2]=2*(c*o+f*a+u*i-s*r)/l):(n[0]=2*(u*o+f*r+s*a-c*i),n[1]=2*(s*o+f*i+c*r-u*a),n[2]=2*(c*o+f*a+u*i-s*r)),Qu(t,e,n),t}function Ju(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Ku(t,e){var n=e[0],r=e[1],i=e[2],a=e[4],o=e[5],u=e[6],s=e[8],c=e[9],f=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(a*a+o*o+u*u),t[2]=Math.sqrt(s*s+c*c+f*f),t}function ts(t,e){var n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t}function es(t,e,n,r){var i=e[0],a=e[1],o=e[2],u=e[3],s=i+i,c=a+a,f=o+o,l=i*s,h=i*c,d=i*f,p=a*c,v=a*f,y=o*f,m=u*s,g=u*c,b=u*f,_=r[0],x=r[1],w=r[2];return t[0]=(1-(p+y))*_,t[1]=(h+b)*_,t[2]=(d-g)*_,t[3]=0,t[4]=(h-b)*x,t[5]=(1-(l+y))*x,t[6]=(v+m)*x,t[7]=0,t[8]=(d+g)*w,t[9]=(v-m)*w,t[10]=(1-(l+p))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ns(t,e,n,r,i){var a=e[0],o=e[1],u=e[2],s=e[3],c=a+a,f=o+o,l=u+u,h=a*c,d=a*f,p=a*l,v=o*f,y=o*l,m=u*l,g=s*c,b=s*f,_=s*l,x=r[0],w=r[1],T=r[2],E=i[0],k=i[1],A=i[2],C=(1-(v+m))*x,M=(d+_)*x,S=(p-b)*x,R=(d-_)*w,D=(1-(h+m))*w,I=(y+g)*w,F=(p+b)*T,N=(y-g)*T,O=(1-(h+v))*T;return t[0]=C,t[1]=M,t[2]=S,t[3]=0,t[4]=R,t[5]=D,t[6]=I,t[7]=0,t[8]=F,t[9]=N,t[10]=O,t[11]=0,t[12]=n[0]+E-(C*E+R*k+F*A),t[13]=n[1]+k-(M*E+D*k+N*A),t[14]=n[2]+A-(S*E+I*k+O*A),t[15]=1,t}function rs(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,u=r+r,s=i+i,c=n*o,f=r*o,l=r*u,h=i*o,d=i*u,p=i*s,v=a*o,y=a*u,m=a*s;return t[0]=1-l-p,t[1]=f+m,t[2]=h-y,t[3]=0,t[4]=f-m,t[5]=1-c-p,t[6]=d+v,t[7]=0,t[8]=h+y,t[9]=d-v,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function is(t,e,n,r,i,a,o){var u=1/(n-e),s=1/(i-r),c=1/(a-o);return t[0]=2*a*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*s,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(i+r)*s,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*c,t[15]=0,t}function as(t,e,n,r,i){var a=1/Math.tan(e/2),o=void 0;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function os(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(o+u),c=2/(i+a);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-u)*s*.5,t[9]=(i-a)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function us(t,e,n,r,i,a,o){var u=1/(e-n),s=1/(r-i),c=1/(a-o);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*u,t[13]=(i+r)*s,t[14]=(o+a)*c,t[15]=1,t}function ss(t,e,n,r){var i=void 0,a=void 0,o=void 0,u=void 0,s=void 0,c=void 0,f=void 0,l=void 0,h=void 0,d=void 0,p=e[0],v=e[1],y=e[2],m=r[0],g=r[1],b=r[2],_=n[0],x=n[1],w=n[2];return Math.abs(p-_)<Eu&&Math.abs(v-x)<Eu&&Math.abs(y-w)<Eu?Iu(t):(f=p-_,l=v-x,h=y-w,i=g*(h*=d=1/Math.sqrt(f*f+l*l+h*h))-b*(l*=d),a=b*(f*=d)-m*h,o=m*l-g*f,(d=Math.sqrt(i*i+a*a+o*o))?(i*=d=1/d,a*=d,o*=d):(i=0,a=0,o=0),u=l*o-h*a,s=h*i-f*o,c=f*a-l*i,(d=Math.sqrt(u*u+s*s+c*c))?(u*=d=1/d,s*=d,c*=d):(u=0,s=0,c=0),t[0]=i,t[1]=u,t[2]=f,t[3]=0,t[4]=a,t[5]=s,t[6]=l,t[7]=0,t[8]=o,t[9]=c,t[10]=h,t[11]=0,t[12]=-(i*p+a*v+o*y),t[13]=-(u*p+s*v+c*y),t[14]=-(f*p+l*v+h*y),t[15]=1,t)}function cs(t,e,n,r){var i=e[0],a=e[1],o=e[2],u=r[0],s=r[1],c=r[2],f=i-n[0],l=a-n[1],h=o-n[2],d=f*f+l*l+h*h;d>0&&(f*=d=1/Math.sqrt(d),l*=d,h*=d);var p=s*h-c*l,v=c*f-u*h,y=u*l-s*f;return(d=p*p+v*v+y*y)>0&&(p*=d=1/Math.sqrt(d),v*=d,y*=d),t[0]=p,t[1]=v,t[2]=y,t[3]=0,t[4]=l*y-h*v,t[5]=h*p-f*y,t[6]=f*v-l*p,t[7]=0,t[8]=f,t[9]=l,t[10]=h,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function fs(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function ls(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function hs(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function ds(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function ps(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function vs(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function ys(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function ms(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=t[9],h=t[10],d=t[11],p=t[12],v=t[13],y=t[14],m=t[15],g=e[0],b=e[1],_=e[2],x=e[3],w=e[4],T=e[5],E=e[6],k=e[7],A=e[8],C=e[9],M=e[10],S=e[11],R=e[12],D=e[13],I=e[14],F=e[15];return Math.abs(n-g)<=Eu*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(r-b)<=Eu*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-_)<=Eu*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(a-x)<=Eu*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(o-w)<=Eu*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(u-T)<=Eu*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(s-E)<=Eu*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(c-k)<=Eu*Math.max(1,Math.abs(c),Math.abs(k))&&Math.abs(f-A)<=Eu*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(l-C)<=Eu*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(h-M)<=Eu*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(d-S)<=Eu*Math.max(1,Math.abs(d),Math.abs(S))&&Math.abs(p-R)<=Eu*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(v-D)<=Eu*Math.max(1,Math.abs(v),Math.abs(D))&&Math.abs(y-I)<=Eu*Math.max(1,Math.abs(y),Math.abs(I))&&Math.abs(m-F)<=Eu*Math.max(1,Math.abs(m),Math.abs(F))}var gs=Lu,bs=ds;function _s(){var t=new ku(4);return ku!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function xs(t){var e=new ku(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function ws(t,e,n,r){var i=new ku(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function Ts(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Es(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function ks(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function As(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function Cs(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function Ms(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function Ss(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Rs(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Ds(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Is(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Fs(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Ns(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Os(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function Ps(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+a*a)}function Ls(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return n*n+r*r+i*i+a*a}function Bs(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}function Us(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function zs(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function Vs(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function Gs(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=a*o),t}function js(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function qs(t,e,n,r){var i=e[0],a=e[1],o=e[2],u=e[3];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=o+r*(n[2]-o),t[3]=u+r*(n[3]-u),t}function Ws(t,e){var n,r,i,a,o,u;e=e||1;do{o=(n=2*Au()-1)*n+(r=2*Au()-1)*r}while(o>=1);do{u=(i=2*Au()-1)*i+(a=2*Au()-1)*a}while(u>=1);var s=Math.sqrt((1-o)/u);return t[0]=e*n,t[1]=e*r,t[2]=e*i*s,t[3]=e*a*s,t}function Ys(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,t}function Xs(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],u=n[1],s=n[2],c=n[3],f=c*r+u*a-s*i,l=c*i+s*r-o*a,h=c*a+o*i-u*r,d=-o*r-u*i-s*a;return t[0]=f*c+d*-o+l*-s-h*-u,t[1]=l*c+d*-u+h*-o-f*-s,t[2]=h*c+d*-s+f*-u-l*-o,t[3]=e[3],t}function Hs(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Zs(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Qs(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=e[0],u=e[1],s=e[2],c=e[3];return Math.abs(n-o)<=Eu*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-u)<=Eu*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-s)<=Eu*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(a-c)<=Eu*Math.max(1,Math.abs(a),Math.abs(c))}var $s=As,Js=Cs,Ks=Ms,tc=Ps,ec=Ls,nc=Bs,rc=Us,ic=function(){var t=_s();return function(e,n,r,i,a,o){var u=void 0,s=void 0;for(n||(n=4),r||(r=0),s=i?Math.min(i*n+r,e.length):e.length,u=r;u<s;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],a(t,t,o),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}(),ac=Object.freeze({VISIBLE:"visible",HIDDEN:"none"}),oc=Date.now(),uc=1024,sc=function(){function t(e){if(A()(this,t),e){if(this.gl=e.getContext("webgl"),!this.gl)throw new Q("".concat($.WEB_GL," WebGL 1 is unsupported"));this._initGL(this.gl)}this._center={x:0,y:0},this._zoom=1,this.RTT_WIDTH=uc,this.dataframes=[]}return G()(t,[{key:"initialize",value:function(t){this._initGL(t)}},{key:"setCenter",value:function(t){this._center.x=t.x,this._center.y=t.y}},{key:"setZoom",value:function(t){this._zoom=t}},{key:"getBounds",value:function(){var t=this._zoom*this._getAspect(),e=this._zoom;return[this._center.x-t,this._center.y-e,this._center.x+t,this._center.y+e]}},{key:"_initGL",value:function(t){if(this.gl=t,!t.getExtension("OES_texture_float"))throw new Q("".concat($.WEB_GL," WebGL extension 'OES_texture_float' is unsupported"));var e=t.getParameter(t.MAX_RENDERBUFFER_SIZE);if(e<uc)throw new Q("".concat($.WEB_GL," WebGL parameter 'gl.MAX_RENDERBUFFER_SIZE' is below the requirement: ").concat(e," < ").concat(uc));this._initShaders(),this.auxFB=t.createFramebuffer(),this.bigTriangleVBO=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.bigTriangleVBO);var n=new Float32Array([10,-10,0,10,-10,-10]);t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW),this.zeroTex=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.zeroTex),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),this._AATex=t.createTexture(),this._AAFB=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,this.zeroTex)}},{key:"_getAspect",value:function(){return this.gl?this.gl.canvas.width/this.gl.canvas.height:1}},{key:"_runViewportAggregations",value:function(t){var e=this,n=t.getActiveDataframes(),r=t.viz,i=this._getViewportExpressions(r._getRootExpressions());if(i.length){var a=n.length?n[0].metadata:null;i.forEach(function(t){return t._resetViewportAgg(a)});var o=i.length,u=new Set;n.forEach(function(t){for(var n=0;n<t.numFeatures;n++){var s=t.properties[a.idProperty][n];if(!u.has(s)&&t.inViewport(n,r)){u.add(s);var c=e._featureFromDataFrame(t,n,a);if(!(r.filter.eval(c)<.5))for(var f=0;f<o;f++)i[f].accumViewportAgg(c)}}})}}},{key:"_getViewportExpressions",value:function(t){var e=[];return t.map(function t(n){n._isViewport?e.push(n):n._getChildren().map(t)}),e}},{key:"_featureFromDataFrame",value:function(t,e,n){return t.getFeature(e)}},{key:"renderLayer",value:function(t,e){var n=this;this.drawMetadata=e;var r=t.getActiveDataframes(),i=t.viz,a=this.gl;if(this._updateDataframeMatrices(r),this._runViewportAggregations(t),r.length){i._getRootExpressions().map(function(t){return t._dataReady()}),a.enable(a.CULL_FACE),a.disable(a.BLEND),a.disable(a.DEPTH_TEST),a.disable(a.STENCIL_TEST),a.depthMask(!1),a.bindFramebuffer(a.FRAMEBUFFER,this.auxFB);var o=function(t,r,o,u){var s=o.textureIds.get(i);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,r,0),a.viewport(0,0,uc,t.height),a.clear(a.COLOR_BUFFER_BIT),a.useProgram(o.program),e.freeTexUnit=Object.keys(s).length,u._setTimestamp((Date.now()-oc)/1e3),u._preDraw(o.program,e,a),Object.keys(s).forEach(function(e,n){a.activeTexture(a.TEXTURE0+n),a.bindTexture(a.TEXTURE_2D,t.getPropertyTexture(e)),a.uniform1i(s[e],n)}),a.enableVertexAttribArray(o.vertexAttribute),a.bindBuffer(a.ARRAY_BUFFER,n.bigTriangleVBO),a.vertexAttribPointer(o.vertexAttribute,2,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLES,0,3),a.disableVertexAttribArray(o.vertexAttribute)};if(r.map(function(t){return o(t,t.texColor,i.colorShader,i.color)}),r.map(function(t){return o(t,t.texWidth,i.widthShader,i.width)}),r.map(function(t){return o(t,t.texStrokeColor,i.strokeColorShader,i.strokeColor)}),r.map(function(t){return o(t,t.texStrokeWidth,i.strokeWidthShader,i.strokeWidth)}),r.map(function(t){return o(t,t.texFilter,i.filterShader,i.filter)}),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.enable(a.BLEND),a.bindFramebuffer(a.FRAMEBUFFER,null),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),"point"!==t.type){var u=(window.devicePixelRatio||1)>=2?1:2;a.bindFramebuffer(a.FRAMEBUFFER,this._AAFB);var s=[a.drawingBufferWidth,a.drawingBufferHeight],c=s[0],f=s[1];if(c!==this._width||f!==this._height){a.bindTexture(a.TEXTURE_2D,this._AATex),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,c*u,f*u,0,a.RGBA,a.UNSIGNED_BYTE,null),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this._AATex,0);var l=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,l),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,c*u,f*u),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,l);var h=[c,f];this._width=h[0],this._height=h[1]}a.viewport(0,0,c*u,f*u),a.clear(a.COLOR_BUFFER_BIT)}var d=function(t){var e=t.viz.order,n=[0],r=[1030];e.isA(dn)?(n=Array.from({length:64},function(t,e){return 2*(63-e)}),r=Array.from({length:64},function(t,e){return 0===e?1030:2*(63-e+1)})):e.isA(pn)&&(n=Array.from({length:64},function(t,e){return 2*e}),r=Array.from({length:64},function(t,e){return 63===e?1030:2*(e+1)}));return{orderingMins:n,orderingMaxs:r}}(t),p=d.orderingMins,v=d.orderingMaxs;"line"!==r[0].type&&"polygon"!==r[0].type||(a.clearDepth(1),a.depthRange(0,1),a.depthFunc(a.NOTEQUAL),a.depthMask(!0),a.enable(a.DEPTH_TEST));p.map(function(t,n){!function(t){r.forEach(function(n){var r=0,o=null;if(o=i.symbol.default?"point"===n.type?i.pointShader:"line"===n.type?i.lineShader:i.polygonShader:i.symbolShader,a.useProgram(o.program),a.uniform1f(o.orderMinWidth,p[t]),a.uniform1f(o.orderMaxWidth,v[t]),a.uniform1f(o.normalScale,1/(512*Math.pow(2,e.zoomLevel)*n.scale)),a.enableVertexAttribArray(o.vertexPositionAttribute),a.bindBuffer(a.ARRAY_BUFFER,n.vertexBuffer),a.vertexAttribPointer(o.vertexPositionAttribute,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(o.featureIdAttr),a.bindBuffer(a.ARRAY_BUFFER,n.featureIDBuffer),a.vertexAttribPointer(o.featureIdAttr,2,a.FLOAT,!1,0,0),"line"!==n.type&&"polygon"!==n.type||(a.enableVertexAttribArray(o.normalAttr),a.bindBuffer(a.ARRAY_BUFFER,n.normalBuffer),a.vertexAttribPointer(o.normalAttr,2,a.FLOAT,!1,0,0)),a.activeTexture(a.TEXTURE0+r),a.bindTexture(a.TEXTURE_2D,n.texColor),a.uniform1i(o.colorTexture,r),r++,a.activeTexture(a.TEXTURE0+r),a.bindTexture(a.TEXTURE_2D,n.texWidth),a.uniform1i(o.widthTexture,r),r++,a.activeTexture(a.TEXTURE0+r),a.bindTexture(a.TEXTURE_2D,n.texFilter),a.uniform1i(o.filterTexture,r),r++,a.uniform2f(o.resolution,a.canvas.width,a.canvas.height),i.symbol.default)"line"!==n.type&&(a.activeTexture(a.TEXTURE0+r),a.bindTexture(a.TEXTURE_2D,n.texStrokeColor),a.uniform1i(o.strokeColorTexture,r),r++,a.activeTexture(a.TEXTURE0+r),a.bindTexture(a.TEXTURE_2D,n.texStrokeWidth),a.uniform1i(o.strokeWidthTexture,r),r++);else{var u=i.symbolShader.textureIds.get(i);e.freeTexUnit=r+Object.keys(u).length,i.symbol._setTimestamp((Date.now()-oc)/1e3),i.symbol._preDraw(i.symbolShader.program,e,a),i.symbolPlacement._setTimestamp((Date.now()-oc)/1e3),i.symbolPlacement._preDraw(i.symbolShader.program,e,a),r=e.freeTexUnit,Object.keys(u).forEach(function(t){a.activeTexture(a.TEXTURE0+r),a.bindTexture(a.TEXTURE_2D,n.getPropertyTexture(t)),a.uniform1i(u[t],r),r++})}if("line"!==n.type&&"polygon"!==n.type||a.clear(a.DEPTH_BUFFER_BIT),!i.transform.default){var s=o.textureIds.get(i);e.freeTexUnit=r+Object.keys(s).length,i.transform._setTimestamp((Date.now()-oc)/1e3),i.transform._preDraw(o.program,e,a),r=e.freeTexUnit,Object.keys(s).forEach(function(t){a.activeTexture(a.TEXTURE0+r),a.bindTexture(a.TEXTURE_2D,n.getPropertyTexture(t)),a.uniform1i(s[t],r),r++}),a.uniform2f(o.resolution,a.canvas.width,a.canvas.height)}a.uniformMatrix4fv(o.matrix,!1,n.matrix),a.drawArrays(a.TRIANGLES,0,n.numVertex),a.disableVertexAttribArray(o.vertexPositionAttribute),a.disableVertexAttribArray(o.featureIdAttr),"line"!==n.type&&"polygon"!==n.type||(a.disableVertexAttribArray(o.normalAttr),a.disable(a.DEPTH_TEST))})}(n)}),"point"!==t.type&&(a.bindFramebuffer(a.FRAMEBUFFER,null),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.useProgram(this._aaBlendShader.program),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this._AATex),a.uniform1i(this._aaBlendShader.readTU,0),a.enableVertexAttribArray(this._aaBlendShader.vertexAttribute),a.bindBuffer(a.ARRAY_BUFFER,this.bigTriangleVBO),a.vertexAttribPointer(this._aaBlendShader.vertexAttribute,2,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLES,0,3),a.disableVertexAttribArray(this._aaBlendShader.vertexAttribute)),a.disable(a.CULL_FACE)}}},{key:"_updateDataframeMatrices",value:function(t){var e=this;t.forEach(function(t){var n=[],r=[];o.copy(n,e.matrix),o.identity(r),o.translate(r,r,[.5,.5,0]),o.scale(r,r,[.5,-.5,1]),o.translate(r,r,[t.center.x,t.center.y,0]),o.scale(r,r,[t.scale,t.scale,1]),o.multiply(n,n,r),t.matrix=n})}},{key:"_initShaders",value:function(){this._aaBlendShader=new _t.AABlender(this.gl)}}]),t}();var cc=function(){function t(e,n,r,i,a,o){A()(this,t),this._propertyName=e,this._properties=n,this._viz=r,this.blendTo=function(t,e,n,r,i,a){return function(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;if("string"==typeof o&&(o=Jo(o)),n[e]&&n[e][t])n[e][t].a.blendTo(o,u);else{var s=$i(o,r[t],$i(1,Gi(Ca(a),e),Ci(u)));i(e,t,s,n),r.replaceChild(r[t],s),r[t].notify()}}}(e,n[o],i,r,a,o),this.reset=function(t,e,n,r,i){return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;n[e]&&n[e][t]&&(n[e][t].replaceChild(n[e][t].mix,$i(Gi(Ca(i),e),Ci(0),Ci(a))),r[t].notify(),n[e][t]=void 0)}}(e,n[o],i,r,o)}return G()(t,[{key:"value",get:function(){return this._viz[this._propertyName].eval(this._properties)}}]),t}();var fc=function(){function t(e,n,r,i,a){A()(this,t);var o={};Object.keys(n.variables).map(function(t){o[t]=new cc("__cartovl_variable_".concat(t),e,n,r,i,a)}),this.id=e[a],this.color=new cc("color",e,n,r,i,a),this.width=new cc("width",e,n,r,i,a),this.strokeColor=new cc("strokeColor",e,n,r,i,a),this.strokeWidth=new cc("strokeWidth",e,n,r,i,a),this.symbol=new cc("symbol",e,n,r,i,a),this.symbolPlacement=new cc("symbolPlacement",e,n,r,i,a),this.variables=o}return G()(t,[{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;for(var e in this.color.reset(t),this.width.reset(t),this.strokeColor.reset(t),this.strokeWidth.reset(t),this.symbol.reset(t),this.symbolPlacement.reset(t),this.variables)this.variables[e].reset(t)}}]),t}(),lc=function(){function t(){A()(this,t),this.dataframes=[],this.renderer=null,this.viz=null,this.type=null,this.customizedFeatures={},this.idProperty=null}return G()(t,[{key:"addDataframe",value:function(t){this.type&&this._checkDataframeType(t),this.type=t.type,this.renderer&&t.bindRenderer(this.renderer),this.dataframes.push(t),this.idProperty=t.metadata.idProperty}},{key:"setRenderer",value:function(t){this.renderer=t,this.dataframes.forEach(function(e){return e.bindRenderer(t)})}},{key:"setViz",value:function(t){this.viz=t}},{key:"getActiveDataframes",value:function(){this.dataframes=this.dataframes.filter(function(t){return!t.freed});var t=this.dataframes.filter(function(t){return t.active&&t.numVertex});return t.length&&void 0!==t[0].orderID&&(t=t.sort(function(t,e){return t.orderID-e.orderID})),t}},{key:"hasDataframes",value:function(){return this.getActiveDataframes().length>0}},{key:"getNumFeatures",value:function(){return this.getActiveDataframes().map(function(t){return t.numFeatures}).reduce(function(t,e){return t+e},0)}},{key:"_checkDataframeType",value:function(t){if(this.type!==t.type)throw new O("".concat(P.INCORRECT_TYPE," Layer dataframes must always be of the same type"))}},{key:"getFeaturesAtPosition",value:function(t){var e,n=this;return this.viz?(e=[]).concat.apply(e,f()(this.getActiveDataframes().map(function(e){return e.getFeaturesAtPosition(t,n.viz)}))).map(function(t){return new fc(t,n.viz,n.customizedFeatures,n.trackFeatureViz,n.idProperty)}):[]}},{key:"trackFeatureViz",value:function(t,e,n,r){r[t]=r[t]||{},r[t][e]=n}},{key:"freeDataframes",value:function(){this.dataframes.map(function(t){return t.free()}),this.dataframes=[],this.type=null}}]),t}();function hc(t,e){var n=function(t,e){var n=Math.hypot(t,e);return[t/n,e/n]}(t[0]-e[0],t[1]-e[1]);return[-n[1],n[0]]}function dc(t,e){var n=[t[1],-t[0]],r=[-e[1],e[0]],i=r[0]*n[1]-r[1]*n[0],a=r[0]*n[0]+r[1]*n[1],o=Math.abs(i);return{turnLeft:i>0,joinNormal:!(o<.866&&a>.5)&&pc([(n[0]+r[0])/o,(n[1]+r[1])/o])}}function pc(t){return[-t[0],-t[1]]}function vc(t,e,n,r){if(mc(e,n)||mc(n,r)||mc(r,e))return!1;var i=yc(t,e,n)<0,a=yc(t,n,r)<0,o=yc(t,r,e)<0;return i===a&&a===o}function yc(t,e,n){return(t.x-n.x)*(e.y-n.y)-(e.x-n.x)*(t.y-n.y)}function mc(t,e){return t.x===e.x&&t.y===e.y}function gc(t,e,n){var r=t.x-e.x,i=t.y-e.y;return r*r+i*i<=n*n}function bc(t,e,n){switch(n){case"line":return function(t,e){for(var n=t,r=t.length,i=0;i<r;i+=2)e.minx=Math.min(e.minx,n[i+0]),e.miny=Math.min(e.miny,n[i+1]),e.maxx=Math.max(e.maxx,n[i+0]),e.maxy=Math.max(e.maxy,n[i+1]);return e}(t,e);case"polygon":return function(t,e){for(var n=[t.flat,t.holes[0]||t.flat.length/2],r=n[0],i=n[1],a=0;a<i;a++)e.minx=Math.min(e.minx,r[2*a+0]),e.miny=Math.min(e.miny,r[2*a+1]),e.maxx=Math.max(e.maxx,r[2*a+0]),e.maxy=Math.max(e.maxy,r[2*a+1]);return e}(t,e)}}var _c=new WeakMap,xc=function(){function t(e,n,r){A()(this,t),this._checkId(e),this._checkSource(n),this._checkViz(r),this._init(e,n,r)}return G()(t,[{key:"_init",value:function(t,e,n){var r=this;n._boundLayer=this,this._context=new Promise(function(t){r._contextInitialize=t}),this.id=t,this.type="custom",this.metadata=null,this._state="init",this._visible=!0,this._isLoaded=!1,this._matrix=null,this._fireUpdateOnNextRender=!1,this._emitter=gu(),this._oldDataframes=new Set,this._renderLayer=new lc,this._atomicChangeUID=0,this.update(e,n)}},{key:"on",value:function(t,e){return this._emitter.on(t,e)}},{key:"off",value:function(t,e){return this._emitter.off(t,e)}},{key:"addTo",value:function(t,e){var n=this;try{t.addLayer(this,e)}catch(r){if(!/Style is not done loading/.test(r))throw new Q("Error adding layer to map: ".concat(r));t.on("load",function(){t.addLayer(n,e)})}}},{key:"remove",value:function(){this.map&&this.map.removeLayer(this.id)}},{key:"update",value:function(){var t=wu()(_u.a.mark(function t(e,n){var r,i,a;return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n=this._viz),this._checkSource(e),this._checkViz(n),e=e._clone(),this._atomicChangeUID++,r=this._atomicChangeUID,i=n.loadImages(),t.next=9,e.requestMetadata(n);case 9:return a=t.sent,t.next=12,i;case 12:return t.next=14,this._context;case 14:if(!(this._atomicChangeUID>r)){t.next=16;break}throw new Q("Another atomic change was done before this one committed (1)");case 16:return this.metadata=a,e.bindLayer(this._onDataframeAdded.bind(this),this._onDataLoaded.bind(this)),this._source!==e&&this._freeSource(),this._source=e,this._noFirstRequestData=!1,this.requestData(),n.setDefaultsIfRequired(this.metadata.geomType),t.next=25,this._context;case 25:if(!(this._atomicChangeUID>r)){t.next=27;break}throw new Q("Another atomic change was done before this one committed (2)");case 27:this._viz&&this._viz.onChange(null),n.setDefaultsIfRequired(this._renderLayer.type),this._viz=n,n.onChange(this._vizChanged.bind(this)),this._compileShaders(n,a),this._needRefresh();case 33:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"blendToViz",value:function(){var t=wu()(_u.a.mark(function t(e){var n,r,i=this,a=arguments;return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:400,r=a.length>2&&void 0!==a[2]?a[2]:pa,this._checkViz(e),e.setDefaultsIfRequired(this.metadata.geomType),!this._viz||this._source.requiresNewMetadata(e)){t.next=13;break}Object.keys(this._viz.variables).map(function(t){e.variables[t]=i._viz.variables[t]}),e.color._blendFrom(this._viz.color,n,r),e.strokeColor._blendFrom(this._viz.strokeColor,n,r),e.width._blendFrom(this._viz.width,n,r),e.strokeWidth._blendFrom(this._viz.strokeWidth,n,r),e.filter._blendFrom(this._viz.filter,n,r),t.next=14;break;case 13:return t.abrupt("return",this.update(this._source,e));case 14:return t.abrupt("return",this._vizChanged(e).then(function(){i._viz&&i._viz.onChange(null),e.setDefaultsIfRequired(i._renderLayer.type),i._viz=e,i._viz.onChange(i._vizChanged.bind(i))}));case 15:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"show",value:function(){this.map.setLayoutProperty(this.id,"visibility","visible"),this._visible=!0,this._noFirstRequestData=!1,this._fireUpdateOnNextRender=!0,this.requestData()}},{key:"hide",value:function(){this.map.setLayoutProperty(this.id,"visibility","none"),this._visible=!1,this._fireUpdateOnNextRender=!0,this._fire("updated")}},{key:"requestMetadata",value:function(){var t=wu()(_u.a.mark(function t(e){return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=e||this._viz){t.next=3;break}return t.abrupt("return");case 3:return t.abrupt("return",this._source.requestMetadata(e));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"requestData",value:function(){var t=wu()(_u.a.mark(function t(){return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.metadata&&this._visible){t.next=2;break}return t.abrupt("return");case 2:this._needRefresh();case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"hasDataframes",value:function(){return this._renderLayer.hasDataframes()}},{key:"getNumFeatures",value:function(){return this._renderLayer.getNumFeatures()}},{key:"getFeaturesAtPosition",value:function(t){return this._visible?this._renderLayer.getFeaturesAtPosition(t).map(this._addLayerIdToFeature.bind(this)):[]}},{key:"isAnimated",value:function(){return this._viz&&this._viz.isAnimated()}},{key:"onAdd",value:function(t,e){this.gl=e,this.map=t,this.renderer=function(t,e){if(!_c.get(t)){var n=new sc;n.initialize(e),_c.set(t,n)}return _c.get(t)}(t,e),this._renderLayer.setRenderer(this.renderer),this._contextInitialize()}},{key:"onRemove",value:function(t,e){}},{key:"prerender",value:function(t,e){E.equalArrays(this._matrix,e)?!this._noFirstRequestData&&this._source&&this._visible&&(this._source.requestData(this._getZoom(),this._getViewport()),this._noFirstRequestData=!0):(this._matrix=e,this.renderer.matrix=e,this._setRendererZoomCenter(e),this._source&&this._visible&&this._source.requestData(this._getZoom(),this._getViewport()),this._fireUpdateOnNextRender=!0)}},{key:"render",value:function(t,e){this._paintLayer(),this.isAnimated()&&this._needRefresh()}},{key:"_paintLayer",value:function(){if(this._viz&&this._viz.colorShader){this._renderLayer.setViz(this._viz),this.renderer.renderLayer(this._renderLayer,{zoomLevel:this.map.getZoom()});var t=!E.isSetsEqual(this._oldDataframes,new Set(this._renderLayer.getActiveDataframes()));(this.isAnimated()||this._fireUpdateOnNextRender||t)&&(this._oldDataframes=new Set(this._renderLayer.getActiveDataframes()),this._fireUpdateOnNextRender=!1,this._fire("updated")),this._isLoaded||"dataLoaded"!==this._state||(this._isLoaded=!0,this._fire("loaded"))}}},{key:"_fire",value:function(t,e){try{return this._emitter.emit(t,e)}catch(t){console.error(t)}}},{key:"_onDataframeAdded",value:function(t){var e=this;t.setFreeObserver(function(){e.map.triggerRepaint()}),this._renderLayer.addDataframe(t),this._viz&&this._viz.setDefaultsIfRequired(t.type),this.map.triggerRepaint()}},{key:"_needRefresh",value:function(){this._fireUpdateOnNextRender=!0,this.map.triggerRepaint()}},{key:"_onDataLoaded",value:function(){this._state="dataLoaded",this._needRefresh()}},{key:"_addLayerIdToFeature",value:function(t){return t.layerId=this.id,t}},{key:"_compileShaders",value:function(t,e){t.compileShaders(this.gl,e)}},{key:"_vizChanged",value:function(){var t=wu()(_u.a.mark(function t(e){var n=this;return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._cache){t.next=2;break}return t.abrupt("return",this._cache);case 2:return this._cache=this._requestVizChanges(e).then(function(){n._cache=null}),t.abrupt("return",this._cache);case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"_requestVizChanges",value:function(){var t=wu()(_u.a.mark(function t(e){var n,r,i;return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._context;case 2:if(this._source){t.next=4;break}throw new O("".concat(P.MISSING_REQUIRED," a 'source' is required before changing the viz."));case 4:return n=this._source,r=e.loadImages(),t.next=8,n.requestMetadata(e);case 8:return i=t.sent,t.next=11,r;case 11:if(this._source===n){t.next=13;break}throw new Q("A source change was made before the metadata was retrieved, therefore, metadata is stale and it cannot be longer consumed");case 13:return this.metadata=i,this._compileShaders(e,this.metadata),this._needRefresh(),t.abrupt("return",this.requestData());case 17:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"_checkId",value:function(t){if(E.isUndefined(t))throw new O("".concat(P.MISSING_REQUIRED," 'id'"));if(!E.isString(t))throw new O("".concat(P.INCORRECT_TYPE," 'id' property must be a string."));if(""===t)throw new O("".concat(P.INCORRECT_VALUE," 'id' property must be not empty."))}},{key:"_checkSource",value:function(t){if(E.isUndefined(t))throw new O("".concat(P.MISSING_REQUIRED," 'source'"));if(!(t instanceof Tu))throw new O("".concat(P.INCORRECT_TYPE," The given object is not a valid 'source'. See \"carto.source\"."))}},{key:"_checkViz",value:function(t){if(E.isUndefined(t))throw new O("".concat(P.MISSING_REQUIRED," 'viz'"));if(!(t instanceof yu))throw new O("".concat(P.INCORRECT_TYPE," The given object is not a valid 'viz'. See \"carto.Viz\"."));if(t._boundLayer&&t._boundLayer!==this)throw new O("".concat(P.INCORRECT_VALUE," The given Viz object is already bound to another layer. Vizs cannot be shared between different layers."))}},{key:"_setRendererZoomCenter",value:function(t){var e,n;e=E.computeMapZoom(this.map),n=E.computeMapCenter(this.map),this.renderer.setZoom(e),this.renderer.setCenter(n)}},{key:"_getViewport",value:function(){var t=o.invert([],this._matrix),e=[[-1,-1],[-1,1],[1,-1],[1,1]].map(function(e){return function(t,e,n){var r=u.transformMat4([],[e,n,1,1],t)[2],i=(r-u.transformMat4([],[e,n,2,1],t)[2])/-1,a=-(r-1*i)/i;return u.transformMat4([],[e,n,a,1],t).map(function(t,e,n){return t/n[3]})}.apply(void 0,[t].concat(f()(e)))}).map(function(t){return t.map(function(t){return 2*t-1})}),n=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],r=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];e.forEach(function(t){n[0]=Math.min(n[0],t[0]),n[1]=Math.min(n[1],t[1]),r[0]=Math.max(r[0],t[0]),r[1]=Math.max(r[1],t[1])}),n[1]=-n[1],r[1]=-r[1];var i=n[1];return n[1]=r[1],r[1]=i,n.concat(r)}},{key:"_getZoom",value:function(){return this.map.getZoom()}},{key:"_freeSource",value:function(){this._source&&this._source.free(),this._renderLayer.freeDataframes()}},{key:"visibility",get:function(){return this._visible?ac.VISIBLE:ac.HIDDEN}},{key:"visible",get:function(){return this._visible}},{key:"viz",get:function(){return this._viz}}]),t}();var wc=["featureClick","featureClickOut","featureEnter","featureHover","featureLeave"],Tc=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{autoChangePointer:!0};A()(this,t),e instanceof xc&&(e=[e]),function(t){if(!Array.isArray(t))throw new O("".concat(P.INCORRECT_TYPE,' Invalid layer list, parameter must be an array of "carto.Layer" objects.'));if(!t.length)throw new O("".concat(P.INCORRECT_VALUE," Invalid argument, layer list must not be empty."));if(!t.every(function(t){return t instanceof xc}))throw new O("".concat(P.INCORRECT_TYPE,' Invalid layer, layer must be an instance of "carto.Layer".'))}(e),this._init(e,n)}return G()(t,[{key:"on",value:function(t,e){return Ec(t),this._numListeners[t]=(this._numListeners[t]||0)+1,this._emitter.on(t,e)}},{key:"off",value:function(t,e){return Ec(t),this._numListeners[t]=this._numListeners[t]-1,this._emitter.off(t,e)}},{key:"_init",value:function(t,e){var n=this;return this._emitter=gu(),this._layerList=t,this._prevHoverFeatures=[],this._prevClickFeatures=[],this._numListeners={},Promise.all(t.map(function(t){return t._context})).then(function(){!function(t){if(!t.every(function(e){return e.map===t[0].map}))throw new O("".concat(P.INCORRECT_VALUE," Invalid argument, all layers must belong to the same map."))}(t),n._subscribeToLayerEvents(t),n._subscribeToMapEvents(t[0].map)}).then(function(){e.autoChangePointer&&n._setInteractiveCursor()})}},{key:"_setInteractiveCursor",value:function(){var t=this,e=this._layerList[0].map;e.__carto_interacivities||(e.__carto_interacivities=new Set),this.on("featureHover",function(n){n.features.length?e.__carto_interacivities.add(t):e.__carto_interacivities.delete(t),e.getCanvas().style.cursor=e.__carto_interacivities.size>0?"pointer":""})}},{key:"_subscribeToMapEvents",value:function(t){t.on("mousemove",this._onMouseMove.bind(this)),t.on("click",this._onClick.bind(this))}},{key:"_subscribeToLayerEvents",value:function(t){var e=this;t.forEach(function(t){t.on("updated",e._onLayerUpdated.bind(e))})}},{key:"_onLayerUpdated",value:function(){this._onMouseMove(this._mouseEvent,!0)}},{key:"_onMouseMove",value:function(t,e){if(this._mouseEvent=t,t&&(this._numListeners.featureEnter||this._numListeners.featureHover||this._numListeners.featureLeave)){var n=this._createFeatureEvent(t),r=n.features,i=this._getDiffFeatures(this._prevHoverFeatures,r),a=this._getDiffFeatures(r,this._prevHoverFeatures);i.length>0&&this._fireEvent("featureLeave",{coordinates:n.coordinates,position:n.position,features:i}),a.length>0&&this._fireEvent("featureEnter",{coordinates:n.coordinates,position:n.position,features:a}),this._prevHoverFeatures=r,(!e||e&&(i.length||a.length))&&this._fireEvent("featureHover",n)}}},{key:"_onClick",value:function(t){if(this._numListeners.featureClick||this._numListeners.featureClickOut){var e=this._createFeatureEvent(t),n=e.features,r=this._getDiffFeatures(this._prevClickFeatures,n);r.length>0&&this._fireEvent("featureClickOut",{coordinates:e.coordinates,position:e.position,features:r}),this._prevClickFeatures=e.features,this._fireEvent("featureClick",e)}}},{key:"_createFeatureEvent",value:function(t){var e=this._getFeaturesAtPosition(t.point);return{coordinates:t.lngLat,position:t.point,features:e}}},{key:"_fireEvent",value:function(t,e){this._emitter.emit(t,e)}},{key:"_getFeaturesAtPosition",value:function(t){var e;return(e=[]).concat.apply(e,f()(this._layerList.map(function(e){return e.getFeaturesAtPosition(t)})))}},{key:"_getDiffFeatures",value:function(t,e){var n=this._getFeatureIDs(e);return t.filter(function(t){return!n.includes(t.id)})}},{key:"_getFeatureIDs",value:function(t){return t.map(function(t){return t.id})}}]),t}();function Ec(t){if(!wc.includes(t))throw new O("".concat(P.INCORRECT_VALUE," Unrecognized event: '").concat(t,"'. Available events: ").concat(wc.join(", "),"."))}var kc=n(16),Ac="separatingLineFound",Cc="separatingLineNotFound";function Mc(t,e){return function(t,e){if(e[0].x<t.minx&&e[1].x<t.minx&&e[2].x<t.minx)return Ac;if(e[0].y<t.miny&&e[1].y<t.miny&&e[2].y<t.miny)return Ac;if(e[0].x>t.maxx&&e[1].x>t.maxx&&e[2].x>t.maxx)return Ac;if(e[0].y>t.maxy&&e[1].y>t.maxy&&e[2].y>t.maxy)return Ac;return Cc}(e,t)!==Ac&&function(t,e){for(var n=0;n<3;n++)for(var r=0;r<e.length;r++){var i=yc(e[r],t[n],t[(n+1)%3]);if(i>0)break;if(3===r)return Ac}return Cc}(t,[{x:e.minx,y:e.miny},{x:e.minx,y:e.maxy},{x:e.maxx,y:e.miny},{x:e.maxx,y:e.maxy}])!==Ac}function Sc(t,e,n,r,i){var a,o,u,s,c,f;if(t.length>=4){if(s=hc(a=[t[0],t[1]],o=[t[2],t[3]]),a[0]===o[0]&&a[1]===o[1])return n;for(var l=4;l<=t.length;l+=2){if((f=!(i&&i(l)))&&(e.vertices[n]=a[0],e.normals[n++]=-s[0],e.vertices[n]=a[1],e.normals[n++]=-s[1],e.vertices[n]=a[0],e.normals[n++]=s[0],e.vertices[n]=a[1],e.normals[n++]=s[1],e.vertices[n]=o[0],e.normals[n++]=s[0],e.vertices[n]=o[1],e.normals[n++]=s[1],e.vertices[n]=a[0],e.normals[n++]=-s[0],e.vertices[n]=a[1],e.normals[n++]=-s[1],e.vertices[n]=o[0],e.normals[n++]=s[0],e.vertices[n]=o[1],e.normals[n++]=s[1],e.vertices[n]=o[0],e.normals[n++]=-s[0],e.vertices[n]=o[1],e.normals[n++]=-s[1]),l<=t.length-2?u=[t[l],t[l+1]]:r&&(u=[t[2],t[3]]),u){if(u[0]===o[0]&&u[1]===o[1])return n;if(c=hc(o,u),f){var h=dc(s,c),d=h.turnLeft,p=h.joinNormal,v=d?s:pc(c),y=d?c:pc(s);e.vertices[n]=o[0],e.normals[n++]=0,e.vertices[n]=o[1],e.normals[n++]=r?1e-37:0,e.vertices[n]=o[0],e.normals[n++]=v[0],e.vertices[n]=o[1],e.normals[n++]=v[1],e.vertices[n]=o[0],e.normals[n++]=y[0],e.vertices[n]=o[1],e.normals[n++]=y[1],p&&(e.vertices[n]=o[0],e.normals[n++]=p[0],e.vertices[n]=o[1],e.normals[n++]=p[1],e.vertices[n]=o[0],e.normals[n++]=y[0],e.vertices[n]=o[1],e.normals[n++]=y[1],e.vertices[n]=o[0],e.normals[n++]=v[0],e.vertices[n]=o[1],e.normals[n++]=v[1])}}a=o,o=u,s=c,u=null}}return n}function Rc(t,e){var n=new Float32Array(e);return n.set(t),n}var Dc=24,Ic=0,Fc={vertices:new Float32Array(1048576),normals:new Float32Array(1048576)};function Nc(t){var e=Ic+t;if(e>Fc.vertices.length){var n=2*e;Fc.vertices=Rc(Fc.vertices,n),Fc.normals=Rc(Fc.normals,n)}}var Oc=n(46),Pc=2,Lc=24,Bc=0,Uc={vertices:new Float32Array(2097152),normals:new Float32Array(2097152)};function zc(t){var e=Bc+t;if(e>Uc.vertices.length){var n=2*e;Uc.vertices=Rc(Uc.vertices,n),Uc.normals=Rc(Uc.normals,n)}}function Vc(t,e){Uc.vertices[Bc]=t[e],Uc.normals[Bc++]=0,Uc.vertices[Bc]=t[e+1],Uc.normals[Bc++]=0}function Gc(t,e,n){return!!(t.clipped.includes(e)&&t.clipped.includes(n)&&t.clippedType[t.clipped.indexOf(e)]&t.clippedType[t.clipped.indexOf(n)])}function jc(t,e){switch(t){case"point":return function(t){return{verticesArrayBuffer:t,vertices:new Float32Array(t),breakpoints:[]}}(e);case"line":return function(t){var e=[],n=new Map;Ic=0;for(var r=0;r<t.length;r++){for(var i=t[r],a=0;a<i.length;a++)Nc(Dc*i[a].length),Ic=Sc(i[a],Fc,Ic);n.set(e.length,0===e.length?{start:0,end:Ic}:{start:n.get(e.length-1).end,end:Ic}),e.push(Ic)}for(var o=new ArrayBuffer(4*Ic),u=new ArrayBuffer(4*Ic),s=new Float32Array(o),c=new Float32Array(u),f=0;f<Ic;f++)s[f]=Fc.vertices[f],c[f]=Fc.normals[f];return{vertices:s,normals:c,verticesArrayBuffer:o,normalsArrayBuffer:u,featureIDToVertexIndex:n,breakpoints:e}}(e);case"polygon":return function(t){var e=[],n=new Map;Bc=0;for(var r=0;r<t.length;r++){for(var i=t[r],a=function(t){var e=i[t],n=Oc(e.flat,e.holes);zc(Pc*n.length+Lc*e.flat.length);for(var r=0;r<n.length;r++)Vc(e.flat,2*n[r]);Bc=Sc(e.flat,Uc,Bc,!0,function(t){return e.holes.includes((t-2)/2)||Gc(e,t-4,t-2)})},o=0;o<i.length;o++)a(o);n.set(e.length,0===e.length?{start:0,end:Bc}:{start:n.get(e.length-1).end,end:Bc}),e.push(Bc)}for(var u=new ArrayBuffer(4*Bc),s=new ArrayBuffer(4*Bc),c=new Float32Array(u),f=new Float32Array(s),l=0;l<Bc;l++)c[l]=Uc.vertices[l],f[l]=Uc.normals[l];return{vertices:c,normals:f,verticesArrayBuffer:u,normalsArrayBuffer:s,featureIDToVertexIndex:n,breakpoints:e}}(e);default:throw new Q("".concat($.NOT_SUPPORTED," Unimplemented geometry type: '").concat(t,"'."))}}var qc=new Map,Wc=1,Yc=-1,Xc=0,Hc=function(t){function e(){return A()(this,e),M()(this,R()(e).apply(this,arguments))}return I()(e,t),G()(e,[{key:"setFreeObserver",value:function(t){this.freeObserver=t}},{key:"bindRenderer",value:function(t){var e=t.gl;this.renderer=t;var n=this.decodedGeom.vertices,r=this.decodedGeom.breakpoints;this.addProperties(this.properties);var i=this.renderer.RTT_WIDTH,a=Math.ceil(this.numFeatures/i);this.height=a,this.vertexBuffer=e.createBuffer(),this.featureIDBuffer=e.createBuffer(),this.texColor=this._createStyleDataframeTexture(this.numFeatures),this.texWidth=this._createStyleDataframeTexture(this.numFeatures),this.texStrokeColor=this._createStyleDataframeTexture(this.numFeatures),this.texStrokeWidth=this._createStyleDataframeTexture(this.numFeatures),this.texFilter=this._createStyleDataframeTexture(this.numFeatures);for(var o=new Float32Array(n.length),u=0,s={},c={},f=0;f<this.numFeatures;f++)s[f]=f%i/(i-1),c[f]=a>1?Math.floor(f/i)/(a-1):.5;if(r.length)for(var l=0;l<n.length;l+=2){for(;l===r[u];)u++;o[l+0]=s[u],o[l+1]=c[u]}else for(var h=0;h<n.length;h+=6)o[h+0]=s[u],o[h+1]=c[u],0===o[h+0]&&(o[h+0]+=1/65536),0===o[h+1]&&(o[h+1]+=1/65536),o[h+2]=-o[h+0],o[h+3]=o[h+1],o[h+4]=o[h+0],o[h+5]=-o[h+1],u++;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),this.decodedGeom.normals&&(this.normalBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.normalBuffer),e.bufferData(e.ARRAY_BUFFER,this.decodedGeom.normals,e.STATIC_DRAW)),e.bindBuffer(e.ARRAY_BUFFER,this.featureIDBuffer),e.bufferData(e.ARRAY_BUFFER,o,e.STATIC_DRAW)}},{key:"getFeaturesAtPosition",value:function(t,e){if(!this.matrix)return[];switch(this.type){case"point":return this._getPointsAtPosition(t,e);case"line":return this._getFeaturesAtPositionFromTriangles("line",t,e);case"polygon":return this._getFeaturesAtPositionFromTriangles("polygon",t,e);default:return[]}}},{key:"inViewport",value:function(t){if(!this.matrix)return!1;switch(this.type){case"point":return this._isPointInViewport(t);case"line":case"polygon":return this._isPolygonInViewport(t);default:return!1}}},{key:"getPropertyTexture",value:function(t){if(this.propertyTex[t])return this.propertyTex[t];var e=this.properties[t],n=this.renderer.gl,r=this.renderer.RTT_WIDTH,i=Math.ceil(this.numFeatures/r);return this.height=i,this.propertyTex[t]=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.propertyTex[t]),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,r,i,0,n.ALPHA,n.FLOAT,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),this.propertyTex[t]}},{key:"free",value:function(){var t=this;if(this.propertyTex){var e=this.renderer.gl;this.propertyTex.map(function(t){return e.deleteTexture(t)}),e.deleteTexture(this.texColor),e.deleteTexture(this.texStrokeColor),e.deleteTexture(this.texWidth),e.deleteTexture(this.texStrokeWidth),e.deleteTexture(this.texFilter),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.featureIDBuffer)}var n=this.freeObserver;Object.keys(this).map(function(e){t[e]=null}),this.freed=!0,n&&n(this)}},{key:"_isPointInViewport",value:function(t){var e=this.matrix,n=this.decodedGeom.vertices[6*t+0],r=this.decodedGeom.vertices[6*t+1],i=e[0]*n+e[4]*r+e[12],a=e[1]*n+e[5]*r+e[13],o=e[3]*n+e[7]*r+e[15];return i>-o&&i<o&&a>-o&&a<o}},{key:"_isPolygonInViewport",value:function(t){var e=this._aabb[t],n=this._compareAABBs(e);if(n===Xc){var r=this.decodedGeom.vertices,i=this.decodedGeom.normals,a=this.decodedGeom.featureIDToVertexIndex.get(t);return this._isPolygonCollidingViewport(r,i,a.start,a.end)}return n===Wc}},{key:"_compareAABBs",value:function(t){if(null===t)return Yc;var e=this._projectToNDC(t.minx,t.miny),n=this._projectToNDC(t.minx,t.maxy),r=this._projectToNDC(t.maxx,t.miny),i=this._projectToNDC(t.maxx,t.maxy),a={minx:Math.min(e.x,n.x,r.x,i.x),miny:Math.min(e.y,n.y,r.y,i.y),maxx:Math.max(e.x,n.x,r.x,i.x),maxy:Math.max(e.y,n.y,r.y,i.y)},o={minx:-1,miny:-1,maxx:1,maxy:1};switch(!0){case function(t,e){return t.minx>=e.minx&&t.maxx<=e.maxx&&t.miny>=e.miny&&t.maxy<=e.maxy}(a,o):return Wc;case Zc(a,o):return Yc;default:return Xc}}},{key:"_isPolygonCollidingViewport",value:function(t,e,n,r){if(!this.matrix)return!1;for(var i={minx:-1,miny:-1,maxx:1,maxy:1},a=n;a<r;a+=6){var o=this._projectToNDC(t[a+0],t[a+1]),u=this._projectToNDC(t[a+2],t[a+3]),s=this._projectToNDC(t[a+4],t[a+5]);if(Mc([{x:o.x,y:o.y},{x:u.x,y:u.y},{x:s.x,y:s.y}],i))return!0}return!1}},{key:"_projectToNDC",value:function(t,e){var n=this.matrix,r=n[0]*t+n[4]*e+n[12],i=n[1]*t+n[5]*e+n[13],a=n[3]*t+n[7]*e+n[15];return{x:r/a,y:i/a}}},{key:"_getPointsAtPosition",value:function(t,e){for(var n=this.decodedGeom.vertices,r=[],i=this.renderer.gl.canvas.width/window.devicePixelRatio,a=this.renderer.gl.canvas.height/window.devicePixelRatio,o=0;o<n.length;o+=6){var u=o/6,s=this.getFeature(u);if(!this._isFeatureFiltered(s,e.filter)){var c={x:n[o],y:n[o+1]},f=this._projectToNDC(c.x,c.y);f.x*=.5,f.y*=-.5,f.x+=.5,f.y+=.5,f.x*=i,f.y*=a;var l=this._computePointRadius(s,e);if(!e.transform.default){var h=e.transform.eval(s);f.x+=h.x,f.y-=h.y}gc(t,f,l)&&r.push(this.getFeature(u))}}return r}},{key:"_computePointRadius",value:function(t,e){return(Math.min(e.width.eval(t),1024)+Math.min(e.strokeWidth.eval(t),1024))/2}},{key:"_computeLineWidthScale",value:function(t,e){return Math.min(e.width.eval(t),1024)/2/this.scale/(512*Math.pow(2,this.renderer.drawMetadata.zoomLevel))}},{key:"_computePolygonWidthScale",value:function(t,e){return Math.min(e.strokeWidth.eval(t),1024)/2/this.scale/(512*Math.pow(2,this.renderer.drawMetadata.zoomLevel))}},{key:"_getFeaturesAtPositionFromTriangles",value:function(t,e,n){for(var r,i=this.decodedGeom.vertices,a=this.decodedGeom.normals,o=this.decodedGeom.breakpoints,u=[],s=-1,c={x:0,y:0},f=this.renderer.gl.canvas.width/window.devicePixelRatio,l=this.renderer.gl.canvas.height/window.devicePixelRatio,h=0;h<i.length;h+=6){if(0===h||h>=o[s]){s++;var d=this.getFeature(s);if(!n.transform.default){var p=n.transform.eval(d);c.x=p[0],c.y=p[1]}if(r="line"===t?this._computeLineWidthScale(d,n):this._computePolygonWidthScale(d,n),this._isFeatureFiltered(d,n.filter)||!this._isPointInAABB(e,c,"line"===t?n.width.eval(d):n.strokeWidth.eval(d),s)){h=o[s]-6;continue}}var v=this._projectToNDC(i[h+0]+a[h+0]*r,i[h+1]+a[h+1]*r),y=this._projectToNDC(i[h+2]+a[h+2]*r,i[h+3]+a[h+3]*r),m=this._projectToNDC(i[h+4]+a[h+4]*r,i[h+5]+a[h+5]*r);v.x*=.5,v.y*=-.5,v.x+=.5,v.y+=.5,y.x*=.5,y.y*=-.5,y.x+=.5,y.y+=.5,m.x*=.5,m.y*=-.5,m.x+=.5,m.y+=.5,vc(e,{x:v.x*f+c.x,y:v.y*l-c.y},{x:y.x*f+c.x,y:y.y*l-c.y},{x:m.x*f+c.x,y:m.y*l-c.y})&&(u.push(this.getFeature(s)),h=o[s]-6)}return u}},{key:"_isPointInAABB",value:function(t,e,n,r){var i=this._aabb[r];if(null===i||!this.matrix)return!1;var a=this._projectToNDC(i.minx,i.miny),o=this._projectToNDC(i.minx,i.maxy),u=this._projectToNDC(i.maxx,i.miny),s=this._projectToNDC(i.maxx,i.maxy),c={minx:Math.min(a.x,o.x,u.x,s.x),miny:Math.min(a.y,o.y,u.y,s.y),maxx:Math.max(a.x,o.x,u.x,s.x),maxy:Math.max(a.y,o.y,u.y,s.y)},f=this.renderer.gl.canvas.width/window.devicePixelRatio,l=this.renderer.gl.canvas.height/window.devicePixelRatio,h=2*e.x/f,d=2*e.y/l,p=t.x/f*2-1,v=-(t.y/l*2-1);return!Zc(c,{minx:p+h-2*n/f,miny:v-d-2*n/l,maxx:p+h+2*n/f,maxy:v-d+2*n/l})}},{key:"_isFeatureFiltered",value:function(t,e){return e.eval(t)<.5}},{key:"_genFeatureClass",value:function(){var t=this;if(qc.has(this.metadata))this._cls=qc.get(this.metadata);else{for(var e=function t(e,n){A()(this,t),this._index=e,this._dataframe=n},n=this.metadata,r={},i=function(e){var i=t.metadata.propertyKeys[e];r[i]={get:function(){var t=this._index;return"category"===n.properties[i].type?n.IDToCategory.get(this._dataframe.properties[i][t]):this._dataframe.properties[i][t]}}},a=0;a<this.metadata.propertyKeys.length;a++)i(a);Object.defineProperties(e.prototype,r),qc.set(this.metadata,e),this._cls=e}}},{key:"_getFeatureProperty",value:function(t,e){return"category"===this.metadata.properties[e].type?this.metadata.IDToCategory.get(this.properties[e][t]):this.properties[e][t]}},{key:"getFeature",value:function(t){if(this.cachedFeatures||(this.cachedFeatures=new Array(this.numFeatures)),void 0!==this.cachedFeatures[t])return this.cachedFeatures[t];this._cls||this._genFeatureClass();var e=new this._cls(t,this);return this.cachedFeatures[t]=e,e}},{key:"_addProperty",value:function(t){Object.keys(this.propertyTex).length<32&&this.getPropertyTexture(t)}},{key:"addProperties",value:function(t){for(var e=0;e<this.metadata.propertyKeys.length;e++){var n=this.metadata.propertyKeys[e];this._addProperty(n)}this._genFeatureClass()}},{key:"_createStyleDataframeTexture",value:function(t){var e=this.renderer.gl,n=this.renderer.RTT_WIDTH,r=Math.ceil(t/n),i=e.createTexture();return e.bindTexture(e.TEXTURE_2D,i),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,r,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),i}}]),e}(function t(e){var n=e.center,r=e.scale,i=e.geom,a=e.properties,o=e.type,u=e.active,s=e.size,c=e.metadata;A()(this,t),this.active=u,this.center=n,this.properties=a,this.scale=r,this.type=o,this.decodedGeom=jc(o,i),this.numVertex="point"===o?3*s:this.decodedGeom.vertices.length/2,this.numFeatures="point"===o?s:this.decodedGeom.breakpoints.length||this.numVertex,this.propertyTex=[],this.metadata=c,this.propertyCount=0,this._aabb=function(t,e){switch(e){case"point":return[];case"line":case"polygon":for(var n=[],r=0;r<t.length;r++){for(var i=t[r],a={minx:Number.POSITIVE_INFINITY,miny:Number.POSITIVE_INFINITY,maxx:Number.NEGATIVE_INFINITY,maxy:Number.NEGATIVE_INFINITY},o=0;o<i.length;o++)a=bc(i[o],a,e);a.minx===Number.POSITIVE_INFINITY&&(a=null),n.push(a)}return n}}(i,o),this.t1=[.1,.1,.1,.1],this.t2=[.1,.1,.1,.1],this.t3=[.1,.1,.1,.1],this.t4=[.1,.1,.1,.1]});function Zc(t,e){return t.minx>e.maxx||t.miny>e.maxy||t.maxx<e.minx||t.maxy<e.miny}var Qc=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{properties:{}},r=n.properties,i=n.featureCount,a=n.sample,o=n.geomType,u=n.isAggregated,s=n.idProperty;A()(this,t),this.properties=r,this.featureCount=i,this.sample=a,this.geomType=o,this.isAggregated=u,this.idProperty=s||"cartodb_id",this.categoryToID=new Map,this.IDToCategory=new Map,this.numCategories=0,Object.values(r).map(function(t){t.categories=t.categories||[],t.categories.map(function(n){return e.categorizeString(t,n.name,!0)})}),this.propertyKeys=Object.keys(this.properties)}return G()(t,[{key:"categorizeString",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return void 0===e&&(e=null),this.categoryToID.has(e)?this.categoryToID.get(e):(n||this.properties[t].categories.push({name:e,frequency:Number.NaN}),this.categoryToID.set(e,this.numCategories),this.IDToCategory.set(this.numCategories,e),this.numCategories++,this.numCategories-1)}},{key:"propertyNames",value:function(t){var e=this.properties[t];return e.aggregations?Object.keys(e.aggregations).map(function(t){return e.aggregations[t]}):[t]}}]),t}(),$c=n(44),Jc=function(){function t(){A()(this,t);this._cache=$c({max:256,length:function(){return 1},maxAge:36e5,dispose:function(t,e){e.then(function(t){t.empty||t.free()})}})}return G()(t,[{key:"get",value:function(t,e){var n=this._cache.get(t);if(n)return n;var r=e(t);return this._cache.set(t,r),r}},{key:"free",value:function(){this._cache.reset()}}]),t}();function Kc(t,e,n){return{x:(t-n.center.x)/n.scale,y:(e-n.center.y)/n.scale}}function tf(t,e){return function(t,e){for(var n=Xe()(e,4),r=n[0],i=n[1],a=n[2],o=n[3],u=1<<t,s=function(t){return Math.min(Math.max(t,0),u-1)},c=s(Math.floor(u*(r+1)*.5)),f=s(Math.ceil(u*(a+1)*.5)-1),l=s(Math.floor(u*(1-o)*.5)),h=s(Math.ceil(u*(1-i)*.5)-1),d=[],p=c;p<=f;++p)for(var v=l;v<=h;++v)d.push({x:p,y:v,z:t});return d}((arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.ceil)(t),e)}var ef=function(){function t(e){A()(this,t),Array.isArray(e)||(e=[e]),this._templateURLs=e,this._requestGroupID=0,this._oldDataframes=[],this._cache=new Jc}return G()(t,[{key:"bindLayer",value:function(t,e){this._addDataframe=t,this._dataLoadedCallback=e}},{key:"requestData",value:function(t,e,n){var r=tf(t,e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.ceil);this._getTiles(r,n)}},{key:"free",value:function(){this._cache.free(),this._cache=new Jc,this._oldDataframes=[]}},{key:"_getTileUrl",value:function(t,e,n){var r=this._getSubdomainIndex(t,e);return this._templateURLs[r].replace("{x}",t).replace("{y}",e).replace("{z}",n)}},{key:"_getSubdomainIndex",value:function(t,e){return Math.abs(t+e)%this._templateURLs.length}},{key:"_getTiles",value:function(t,e){var n=this;this._requestGroupID++;var r=[],i=t.length,a=this._requestGroupID;t.forEach(function(t){var o=t.x,u=t.y,s=t.z;n._cache.get("".concat(o,",").concat(u,",").concat(s),function(){return n._requestDataframe(o,u,s,e)}).then(function(t){t.orderID=o+u/1e3,t.empty?i--:r.push(t),r.length===i&&a===n._requestGroupID&&(n._oldDataframes.forEach(function(t){t.active=!1}),r.map(function(t){t.active=!0}),n._oldDataframes=r,n._dataLoadedCallback())})})}},{key:"_requestDataframe",value:function(){var t=wu()(_u.a.mark(function t(e,n,r,i){var a,o;return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=this._getTileUrl(e,n,r),t.next=3,i(e,n,r,a);case 3:return(o=t.sent).empty||this._addDataframe(o),t.abrupt("return",o);case 6:case"end":return t.stop()}},t,this)}));return function(e,n,r,i){return t.apply(this,arguments)}}()}]),t}(),nf=n(45),rf=n.n(nf),af=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qc,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{layerID:void 0,viewportZoomToSourceZoom:Math.ceil,maxZoom:void 0};return A()(this,e),(n=M()(this,R()(e).call(this)))._templateURL=t,r instanceof Qc||(r=new Qc(r)),n._metadata=r,n._tileClient=new ef(t),n._options=i,n._options.viewportZoomToSourceZoom=n._options.viewportZoomToSourceZoom||Math.ceil,n._workerDispatch={},n._mID=0,n._workerName="MVT",n}return I()(e,t),G()(e,[{key:"_clone",value:function(){return new e(this._templateURL,JSON.parse(JSON.stringify(this._metadata)),this._options)}},{key:"bindLayer",value:function(t,e){this._tileClient.bindLayer(t,e)}},{key:"requestMetadata",value:function(){var t=wu()(_u.a.mark(function t(){return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._metadata);case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"requestData",value:function(t,e){var n=this;return this._tileClient.requestData(t,e,function(t,e,r,i){return new Promise(function(a){if("."===i[0]){var o=window.location.pathname.split("/");o.pop();var u=o.join("/");i="".concat(window.location.protocol,"//").concat(window.location.host,"/").concat(u,"/").concat(i)}else"/"===i[0]&&(i="".concat(window.location.protocol,"//").concat(window.location.host).concat(i));n._worker.postMessage({x:t,y:e,z:r,url:i,layerID:n._options.layerID,metadata:n._metadataSent?void 0:n._metadata,mID:n._mID,workerName:n._workerName}),n._metadataSent=!0,n._workerDispatch[n._mID]=a,n._mID++})},function(t){return void 0===n._options.maxZoom?n._options.viewportZoomToSourceZoom(t):Math.min(n._options.viewportZoomToSourceZoom(t),n._options.maxZoom)})}},{key:"free",value:function(){this._tileClient.free()}},{key:"_worker",get:function(){var t=this;return this._workerInstance||(this._workerInstance=new rf.a,this._workerInstance.onmessage=function(e){var n=e.data.mID,r=e.data.dataframe,i=r.metadata;r.empty||(Object.setPrototypeOf(r,Hc.prototype),t._metadata.numCategories=i.numCategories,t._metadata.categoryToID=i.categoryToID,t._metadata.IDToCategory=i.IDToCategory,t._metadata.geomType=i.geomType,r.metadata=t._metadata),t._workerDispatch[n](r)}),this._workerInstance}}]),e}(Tu),of=function(){function t(e){A()(this,t),this._onlyAggregateFilters=e.exclusive}return G()(t,[{key:"getFilters",value:function(t){var e={},n=this._and(t).filter(Boolean),r=!0,i=!1,a=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,c=s.property,f=e[c];if(f){if(!this._compatibleAndFilters(f,s.filters))return{};Object.assign(f[0],s.filters[0])}else e[c]=s.filters}}catch(t){i=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return e}},{key:"_and",value:function(t){return t.isA(be)?this._and(t.a).concat(this._and(t.b)).filter(Boolean):[this._or(t)].filter(Boolean)}},{key:"_or",value:function(t){if(t.isA(ge)){var e=this._basicCondition(t.a),n=this._basicCondition(t.b);if(e&&n&&e.property===n.property)return e.filters=e.filters.concat(n.filters),e}return this._basicCondition(t)}},{key:"_removeBlend",value:function(t){return t.isA(we)&&t.originalMix.isA(Xt)?t.b:t}},{key:"_basicCondition",value:function(t){return t=this._removeBlend(t),this._between(t)||this._equals(t)||this._notEquals(t)||this._lessThan(t)||this._lessThanOrEqualTo(t)||this._greaterThan(t)||this._greaterThanOrEqualTo(t)||this._in(t)||this._notIn(t)}},{key:"_value",value:function(t){if((t=this._removeBlend(t)).isA(ln)||t.isA(qe)||t.isA(Me))return t.expr}},{key:"_between",value:function(t){if(t.isA(Kt)){var e=this._aggregation(t.input),n=e&&this._value(t.lowerLimit),r=e&&n&&this._value(t.upperLimit);if(r)return e.filters.push({greater_than_or_equal_to:n,less_than_or_equal_to:r}),e}}},{key:"_in",value:function(t){var e=this;if(t.isA(Qt)){var n=this._aggregation(t.input),r=t.list.elems.map(function(t){return e._value(t)}).filter(function(t){return null!==t});if(n&&r.length>0&&r.length===t.list.elems.length)return n.filters.push({in:r}),n}}},{key:"_notIn",value:function(t){var e=this;if(t.isA($t)){var n=this._aggregation(t.input),r=t.list.elems.map(function(t){return e._value(t)}).filter(function(t){return null!==t});if(n&&r.length>0&&r.length===t.list.elems.length)return n.filters.push({not_in:r}),n}}},{key:"_equals",value:function(t){return this._cmpOp(t,ye,"equal")}},{key:"_notEquals",value:function(t){return this._cmpOp(t,me,"not_equal")}},{key:"_lessThan",value:function(t){return this._cmpOp(t,pe,"less_than","greater_than")}},{key:"_lessThanOrEqualTo",value:function(t){return this._cmpOp(t,ve,"less_than_or_equal_to","greater_than_or_equal_to")}},{key:"_greaterThan",value:function(t){return this._cmpOp(t,he,"greater_than","less_than")}},{key:"_greaterThanOrEqualTo",value:function(t){return this._cmpOp(t,de,"greater_than_or_equal_to","less_than_or_equal_to")}},{key:"_aggregation",value:function(t){if((t=this._removeBlend(t)).isA(Be)||t.isA(Ue)||t.isA(ze)||t.isA(Ve)||t.isA(Ge)){var e=this._property(t.property);if(e)return e.property=X.aggColumn(e.property,t.aggName),e}if(!this._onlyAggregateFilters)return this._property(t)}},{key:"_property",value:function(t){if((t=this._removeBlend(t)).isA(Pe))return{property:t.name,filters:[]}}},{key:"_cmpOp",value:function(t,e,n,r){if(r=r||n,t.isA(e)){var i=this._aggregation(t.a),a=i&&this._value(t.b),o=n;if(a||(a=(i=this._aggregation(t.b))&&this._value(t.a),o=r),a){var u={};return u[o]=a,i.filters.push(u),i}}}},{key:"_compatibleAndFilters",value:function(t,e){if(0===t.length||0===e.length)return!0;if(1===t.length&&1===e.length){var n=t[0],r=e[0];if(1===Object.keys(n).length&&1===Object.keys(r).length){var i=Object.keys(n)[0],a=Object.keys(r)[0],o=["less_than","less_than_or_equal_to"],u=["greater_than","greater_than_or_equal_to"];return o.includes(i)&&u.includes(a)||o.includes(a)&&u.includes(i)}}return!1}}]),t}(),uf=function(){function t(){A()(this,t)}return G()(t,[{key:"getFilter",value:function(t){return this._filter(t)}},{key:"_filter",value:function(t){return this._and(t)||this._or(t)||this._in(t)||this._notIn(t)||this._between(t)||this._equals(t)||this._notEquals(t)||this._lessThan(t)||this._lessThanOrEqualTo(t)||this._greaterThan(t)||this._greaterThanOrEqualTo(t)||this._blend(t)||null}},{key:"_and",value:function(t){if(t.isA(be)){var e=[this._filter(t.a),this._filter(t.b)].filter(Boolean).reduce(function(t,e){return t.concat(e)},[]);if(e.length)return 1===e.length?e[0]:{type:"and",left:e[0],right:e[1]}}}},{key:"_or",value:function(t){if(t.isA(ge)){var e=this._filter(t.a),n=this._filter(t.b);if(e&&n)return{type:"or",left:e,right:n}}}},{key:"_lessThan",value:function(t){return this._cmpOp(t,pe,"lessThan")}},{key:"_lessThanOrEqualTo",value:function(t){return this._cmpOp(t,ve,"lessThanOrEqualTo")}},{key:"_greaterThan",value:function(t){return this._cmpOp(t,he,"greaterThan")}},{key:"_greaterThanOrEqualTo",value:function(t){return this._cmpOp(t,de,"greaterThanOrEqualTo")}},{key:"_equals",value:function(t){return this._cmpOp(t,ye,"equals")}},{key:"_notEquals",value:function(t){return this._cmpOp(t,me,"notEquals")}},{key:"_cmpOp",value:function(t,e,n){if(t.isA(e)){var r=this._property(t.a)||this._value(t.a),i=this._property(t.b)||this._value(t.b);if(r&&i)return{type:n,left:r,right:i}}}},{key:"_blend",value:function(t){if(t.isA(we)&&t.originalMix.isA(Xt))return this._filter(t.b)}},{key:"_property",value:function(t){if(t.isA(Pe))return{type:"property",property:t.name}}},{key:"_value",value:function(t){if(t.isA(ln)||t.isA(qe)||t.isA(Me))return{type:"value",value:t.expr}}},{key:"_in",value:function(t){var e=this;if(t.isA(Qt)){var n=this._property(t.input),r=t.list.elems.map(function(t){return e._value(t)});if(n&&r.length>0&&r.length===t.list.elems.length)return{type:"in",property:n.property,values:r.map(function(t){return t.value})}}}},{key:"_notIn",value:function(t){var e=this;if(t.isA($t)){var n=this._property(t.input),r=t.list.elems.map(function(t){return e._value(t)});if(n&&r.length>0&&r.length===t.list.elems.length)return{type:"notIn",property:n.property,values:r.map(function(t){return t.value})}}}},{key:"_between",value:function(t){if(t.isA(Kt)){var e=this._property(t.input),n=this._value(t.lowerLimit),r=this._value(t.upperLimit);if(e&&n&&r)return{type:"between",property:e.property,lower:n.value,upper:r.value}}}}]),t}();function sf(t){return t.type?"(".concat(hf[t.type](t),")"):cf(t)}function cf(t){return isFinite(t)?String(t):"'".concat(t.replace(/\'/g,"''"),"'")}function ff(t){return t.match(/^[a-z\d_]+$/)||(t='"'.concat(t.replace(/\"/g,'""'),'"')),t}function lf(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.map(function(t){return sf(t)}).join(t)}var hf={and:function(t){return lf(" AND ",t.left,t.right)},or:function(t){return lf(" OR ",t.left,t.right)},between:function(t){return"".concat(ff(t.property)," BETWEEN ").concat(cf(t.lower)," AND ").concat(cf(t.upper))},in:function(t){return"".concat(ff(t.property)," IN (").concat(lf.apply(void 0,[","].concat(f()(t.values))),")")},notIn:function(t){return"".concat(ff(t.property)," NOT IN (").concat(lf.apply(void 0,[","].concat(f()(t.values))),")")},equals:function(t){return lf(" = ",t.left,t.right)},notEquals:function(t){return lf(" <> ",t.left,t.right)},lessThan:function(t){return lf(" < ",t.left,t.right)},lessThanOrEqualTo:function(t){return lf(" <= ",t.left,t.right)},greaterThan:function(t){return lf(" > ",t.left,t.right)},greaterThanOrEqualTo:function(t){return lf(" >= ",t.left,t.right)},property:function(t){return ff(t.property)},value:function(t){return cf(t.value)}};function df(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new of(e),r={preaggregation:new uf(e).getFilter(t.filter),aggregation:n.getFilters(t.filter)};return r.preaggregation||r.aggregation?r:null}function pf(t){return t&&t.aggregation}var vf=function(t){function e(t){var n;return A()(this,e),(n=M()(this,R()(e).call(this,{message:t}))).name="CartoMapsAPIError",n}return I()(e,t),e}(N),yf={NOT_SUPPORTED:"[Not supported]:",SECURITY:"[Security]:"},mf=2048,gf=function(){function t(e){A()(this,t),this._source=e,this._exclusive=!0,this._MNS=null,this._promiseMNS=null,this.inProgressInstantiations={}}return G()(t,[{key:"bindLayer",value:function(t,e){this._addDataframe=t,this._dataLoadedCallback=e,this._mvtClient.bindLayer(t,e)}},{key:"_getInstantiationID",value:function(t,e,n,r){return JSON.stringify({MNS:H.simplify(t),resolution:e,filtering:r.backendFilters?n:null,options:r})}},{key:"getMetadata",value:function(){var t=wu()(_u.a.mark(function t(e){var n,r,i,a;return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.getMinimumNeededSchema(),this._checkAcceptableMNS(n),r=e.resolution,i=df(e,{exclusive:this._exclusive}),this._forceIncludeCartodbId(n),!this._needToInstantiate(n,r,i)){t.next=10;break}return t.next=8,this._repeatableInstantiate(n,r,i);case 8:a=t.sent,this._updateStateAfterInstantiating(a);case 10:return t.abrupt("return",this.metadata);case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"_forceIncludeCartodbId",value:function(t){t.cartodb_id||(t.cartodb_id=[{type:"unaggregated"}])}},{key:"requiresNewMetadata",value:function(t){var e=t.getMinimumNeededSchema();this._checkAcceptableMNS(e);var n=t.resolution,r=df(t,{exclusive:this._exclusive});return this._forceIncludeCartodbId(e),this._needToInstantiate(e,n,r)}},{key:"_checkAcceptableMNS",value:function(t){Object.keys(t).forEach(function(e){var n=t[e],r=n.some(function(t){return"aggregated"===t.type}),i=n.some(function(t){return"unaggregated"===t.type});if(r&&i)throw new O("".concat(P.INCORRECT_VALUE," Incompatible combination of cluster aggregation usages (").concat(JSON.stringify(n.filter(function(t){return"aggregated"===t.type})),") with unaggregated usage for property '").concat(e,"'"))})}},{key:"getData",value:function(t,e){if(this._mvtClient)return this._mvtClient.requestData(t,e)}},{key:"_needToInstantiate",value:function(t,e,n){return!H.equals(this._MNS,t)||e!==this.resolution||JSON.stringify(n)!==JSON.stringify(this.filtering)&&this.metadata.featureCount>2e6}},{key:"_isInstantiated",value:function(){return!!this.metadata}},{key:"_intantiationChoices",value:function(t){var e={backendFilters:!0};return t&&t.featureCount>=0&&(e.backendFilters=t.featureCount>2e6||!t.backendFiltersApplied),e}},{key:"_instantiateUncached",value:function(){var t=wu()(_u.a.mark(function t(e,n,r){var i,a,o,u,s,c,f,l,h,d,p,v,y,m=arguments;return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=m.length>3&&void 0!==m[3]?m[3]:{backendFilters:!0},a=m.length>4&&void 0!==m[4]?m[4]:null,o=this._getConfig(),t.next=5,this._generateAggregation(e,n);case 5:return u=t.sent,s=this._buildSelectClause(e),c=this._buildQuery(s),f="(".concat(c,") AS tmp"),l=i.backendFilters?r:null,h=!1,l&&this._requiresAggregation(e)&&(u.filters=pf(l),u.filters&&(h=!0),this._exclusive||(l=null)),l&&(d=this._buildQuery(s,l),h=h||d!==c,c=d),t.next=15,this._getInstantiationPromise(f,o,u,c,s,a);case 15:return p=t.sent,v=p.urlTemplates,(y=p.metadata).backendFiltersApplied=h,t.abrupt("return",{MNS:e,resolution:n,filters:r,metadata:y,urlTemplates:v});case 20:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_updateStateAfterInstantiating",value:function(t){var e=t.MNS,n=t.resolution,r=t.filters,i=t.metadata,a=t.urlTemplates;this._mvtClient&&this._mvtClient.free(),this._mvtClient=new af(a),this._mvtClient._workerName="windshaft",this._mvtClient.bindLayer(this._addDataframe,this._dataLoadedCallback),this.urlTemplates=a,this.metadata=i,this._mvtClient._metadata=i,this._MNS=e,this.filtering=r,this.resolution=n,this._checkLayerMeta(e)}},{key:"_instantiate",value:function(){var t=wu()(_u.a.mark(function t(e,n,r,i,a){var o,u;return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=this._getInstantiationID(e,n,r,i),!this.inProgressInstantiations[o]){t.next=3;break}return t.abrupt("return",this.inProgressInstantiations[o]);case 3:return u=this._instantiateUncached(e,n,r,i,a),this.inProgressInstantiations[o]=u,t.abrupt("return",u);case 6:case"end":return t.stop()}},t,this)}));return function(e,n,r,i,a){return t.apply(this,arguments)}}()},{key:"_repeatableInstantiate",value:function(){var t=wu()(_u.a.mark(function t(e,n,r){var i,a,o,u=this;return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=null,a=this._intantiationChoices(this.metadata),o=function(t){return i=t.metadata,u._intantiationChoices(t.metadata)},t.abrupt("return",bf(a,o,function(t){return u._instantiate(e,n,r,t,i)}));case 4:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_checkLayerMeta",value:function(t){if(!this._isAggregated()&&this._requiresAggregation(t))throw new vf("".concat(yf.NOT_SUPPORTED," Aggregation not supported for this dataset"))}},{key:"_isAggregated",value:function(){return this.metadata&&this.metadata.isAggregated}},{key:"_requiresAggregation",value:function(t){return Object.values(t).some(function(t){return t.some(function(t){return"aggregated"===t.type})})}},{key:"_generateAggregation",value:function(t,e){var n={columns:{},dimensions:{},placement:"centroid",resolution:e,threshold:1};return Object.keys(t).forEach(function(e){"cartodb_id"!==e&&t[e].forEach(function(t){"aggregated"===t.type?n.columns[H.column.aggColumn(e,t.op)]={aggregate_function:t.op,aggregated_column:e}:n.dimensions[e]=e})}),n}},{key:"_buildSelectClause",value:function(t){var e=Object.keys(t).concat(["the_geom_webmercator","cartodb_id"]);return e.filter(function(t,n){return e.indexOf(t)===n})}},{key:"_buildQuery",value:function(t,e){var n=t.map(function(t){return'"'.concat(t,'"')}).join(),r=e?function(t){var e;return(t=t&&t.preaggregation)&&Object.keys(t).length>0&&(e=sf(t)),e?"WHERE "+e:""}(e):"";return"SELECT ".concat(n," FROM ").concat(this._source._getFromClause()," ").concat(r)}},{key:"_getConfig",value:function(){return{apiKey:this._source._apiKey,username:this._source._username,serverURL:this._source._serverURL}}},{key:"free",value:function(){this._mvtClient&&this._mvtClient.free()}},{key:"_getInstantiationPromise",value:function(){var t=wu()(_u.a.mark(function t(e,n,r,i,a){var o,u,s,c,f,l,h=arguments;return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=h.length>5&&void 0!==h[5]?h[5]:null,u={buffersize:{mvt:1},layers:[{type:"mapnik",options:{sql:i,aggregation:r,dates_as_numbers:!0}}]},o||(s=["the_geom","the_geom_webmercator"],c=a.filter(function(t){return!s.includes(t)}),u.layers[0].options.metadata={geometryType:!0,columnStats:{topCategories:32768,includeNulls:!0},sample:{num_rows:1e3,include_columns:c}}),t.prev=3,t.next=6,fetch(xf(n,u));case 6:f=t.sent,t.next=12;break;case 9:throw t.prev=9,t.t0=t.catch(3),new vf("Failed to connect to Maps API with your user('".concat(this._source._username,"')"));case 12:return t.next=14,f.json();case 14:if(l=t.sent,f.ok){t.next=23;break}if(401!==f.status){t.next=20;break}throw new vf("".concat(yf.SECURITY," Unauthorized access to Maps API: invalid combination of user('").concat(this._source._username,"') and apiKey('").concat(this._source._apiKey,"')"));case 20:if(403!==f.status){t.next=22;break}throw new vf("".concat(yf.SECURITY," Unauthorized access to dataset: the provided apiKey('").concat(this._source._apiKey,"') doesn't provide access to the requested data"));case 22:throw new vf("SQL errors: ".concat(JSON.stringify(l.errors)));case 23:return t.abrupt("return",{urlTemplates:l.metadata.tilejson.vector.tiles,metadata:o||this._adaptMetadata(l.metadata.layers[0].meta,r)});case 24:case"end":return t.stop()}},t,this,[[3,9]])}));return function(e,n,r,i,a){return t.apply(this,arguments)}}()},{key:"_adaptMetadata",value:function(t,e){t.datesAsNumbers=t.dates_as_numbers;var n=t.stats,r=t.aggregation,i=t.datesAsNumbers,a=n.hasOwnProperty("featureCount")?n.featureCount:n.estimatedFeatureCount,o=function(t){switch(t){case"ST_MultiPolygon":case"ST_Polygon":return"polygon";case"ST_Point":return"point";case"ST_MultiLineString":case"ST_LineString":return"line";default:throw new vf("".concat(yf.NOT_SUPPORTED," Unimplemented geometry type '").concat(t,"'."))}}(n.geometryType),u=n.columns;Object.keys(e.columns).forEach(function(t){var e=H.column.getBase(t),n=H.column.getAggFN(t);u[e].aggregations||(u[e].aggregations={}),u[e].aggregations[n]=t}),Object.values(u).map(function(t){t.type=function(t){if("string"===t)return"category";return t}(t.type)}),Object.keys(u).forEach(function(t){var e=u[t];"category"===e.type&&e.categories?e.categories.forEach(function(t){t.name=t.category,delete t.category}):i&&i.includes(t)&&(e.type="date",["min","max","avg"].map(function(t){e[t]&&(e[t]=new Or(1e3*e[t]).value)}))}),"point"===o&&(u._cdb_feature_count={type:"number"});return new Qc({properties:u,featureCount:a,sample:n.sample,geomType:o,isAggregated:r.mvt,idProperty:"cartodb_id"})}}]),t}();function bf(t,e,n){return _f.apply(this,arguments)}function _f(){return(_f=wu()(_u.a.mark(function t(e,n,r){var i,a,o;return _u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=r(e),t.next=3,i;case 3:if(a=t.sent,o=n(a),JSON.stringify(e)!==JSON.stringify(o)){t.next=9;break}return t.abrupt("return",i);case 9:return t.abrupt("return",r(o));case 10:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function xf(t,e){var n=JSON.stringify(e),r=wf("api_key",t.apiKey),i=wf("client","vl-".concat(kc.a)),a=[r,i,wf("config",n)],o=Tf(Ef(t),a);return o.length<mf?new Request(o,{method:"GET",headers:{Accept:"application/json"}}):new Request(Tf(Ef(t),[r,i]),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:n})}function wf(t,e){return"".concat(t,"=").concat(encodeURIComponent(e))}function Tf(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return"".concat(t,"?").concat(e.join("&"))}function Ef(t,e){var n="".concat(t.serverURL,"/api/v1/map");return e&&(n+=e),n}var kf=function(t){function e(){var t;return A()(this,e),(t=M()(this,R()(e).call(this)))._client=new gf(Oe()(Oe()(t))),t}return I()(e,t),G()(e,[{key:"initialize",value:function(t,e){this._auth=t||w,this._config=e||T,B(this._auth),z(this._config),this._apiKey=this._auth.apiKey,this._username=this._auth.username,this._serverURL=this._generateURL(this._auth,this._config)}},{key:"bindLayer",value:function(){var t;(t=this._client).bindLayer.apply(t,arguments)}},{key:"requiresNewMetadata",value:function(t){return this._client.requiresNewMetadata(t)}},{key:"requestMetadata",value:function(t){return this._client.getMetadata(t)}},{key:"requestData",value:function(t,e){return this._client.getData(t,e)}},{key:"free",value:function(){this._client.free()}},{key:"_generateURL",value:function(t,e){var n=e&&e.serverURL||"https://{user}.carto.com";return n=n.replace(/{user}/,t.username)}}]),e}(Tu),Af=function(t){function e(t,n,r){var i;return A()(this,e),(i=M()(this,R()(e).call(this)))._checkTableName(t),i._tableName=t,i.initialize(n,r),i}return I()(e,t),G()(e,[{key:"_getFromClause",value:function(){return this._tableName}},{key:"_clone",value:function(){return new e(this._tableName,this._auth,this._config)}},{key:"_checkTableName",value:function(t){if(E.isUndefined(t))throw new O("".concat(P.MISSING_REQUIRED," 'tableName'"));if(!E.isString(t))throw new O("".concat(P.INCORRECT_TYPE," 'tableName' property must be a string."));if(""===t)throw new O("".concat(P.INCORRECT_VALUE," 'tableName' property must be not empty."))}}]),e}(kf),Cf=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(A()(this,e),(n=M()(this,R()(e).call(this)))._checkData(t),n._type="",n._categoryStringToIDMap={},n._numCategories=0,n._numFields=new Set,n._catFields=new Set,n._dateFields=new Set,n._providedDateColumns=new Set(r.dateColumns),n._properties={},n._boundColumns=new Set,n._data=t,"FeatureCollection"===t.type)n._features=t.features;else{if("Feature"!==t.type)throw new O("".concat(P.INCORRECT_VALUE," 'data' property must be a GeoJSON object."));n._features=[t]}return n._features=n._initializeFeatureProperties(n._features),n._setCoordinatesCenter(),n}return I()(e,t),G()(e,[{key:"bindLayer",value:function(t,e){this._addDataframe=t,this._dataLoadedCallback=e}},{key:"requestMetadata",value:function(t){return Promise.resolve(this._computeMetadata(t))}},{key:"requestData",value:function(){var t=this;if(this._dataframe){var e=this._decodeUnboundProperties();return this._dataframe.addProperties(e),void Object.keys(e).forEach(function(e){t._boundColumns.add(e)})}var n=new Hc({active:!0,center:this._dataframeCenter,geom:this._decodeGeometry(),properties:this._decodeUnboundProperties(),scale:1,size:this._features.length,type:this._getDataframeType(this._type),metadata:this._metadata});this._boundColumns=new Set(Object.keys(n.properties)),this._dataframe=n,this._addDataframe(n),this._dataLoadedCallback()}},{key:"requiresNewMetadata",value:function(){return!1}},{key:"_clone",value:function(){return new e(this._data,{dateColumns:Array.from(this._providedDateColumns)})}},{key:"_checkData",value:function(t){if(E.isUndefined(t))throw new O("".concat(P.MISSING_REQUIRED," 'data'"));if(!E.isObject(t))throw new O("".concat(P.INCORRECT_TYPE," 'data' property must be an object."))}},{key:"_initializeFeatureProperties",value:function(t){for(var e=0;e<t.length;e++)t[e].properties=t[e].properties||{};return t}},{key:"_computeMetadata",value:function(t){var e=this,n=[];this._addNumericColumnField("cartodb_id");for(var r=this._features.length,i=new Set(Object.keys(H.simplify(t.getMinimumNeededSchema()))),a=0;a<this._features.length;a++){for(var o=this._features[a].properties,u=Object.keys(o),s=0,c=u.length;s<c;s++){var f=u[s];if(i.has(f)&&!this._boundColumns.has(f)){var l=o[f];this._addPropertyToMetadata(f,l)}}this._sampleFeatureOnMetadata(o,n,this._features.length)}this._numFields.forEach(function(t){var n=e._properties[t];n.avg=n.sum/n.count});var h="";r>0&&(h=this._getDataframeType(this._features[0].geometry.type));return this._metadata=new Qc({properties:this._properties,featureCount:r,sample:n,geomType:h,idProperty:"cartodb_id"}),this._metadata}},{key:"_sampleFeatureOnMetadata",value:function(t,e,n){if(n>1e3){var r=1e3/n;if(Math.random()>r)return}e.push(t)}},{key:"_addNumericPropertyToMetadata",value:function(t,e){if(this._catFields.has(t)||this._dateFields.has(t))throw new O("".concat(P.INCORRECT_TYPE," Unsupported GeoJSON: the property '").concat(t,"' has different types in different features."));this._addNumericColumnField(t);var n=this._properties[t];n.min=Math.min(n.min,e),n.max=Math.max(n.max,e),n.sum+=e}},{key:"_addNumericColumnField",value:function(t){this._numFields.has(t)||(this._numFields.add(t),this._properties[t]={type:"number",min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY,avg:Number.NaN,sum:0,count:0})}},{key:"_addDatePropertyToMetadata",value:function(t,e){if(this._catFields.has(t)||this._numFields.has(t))throw new Q("".concat($.NOT_SUPPORTED," Unsupported GeoJSON: the property '").concat(t,"' has different types in different features."));this._addDateColumnField(t);var n=this._properties[t],r=E.castDate(e);n.min=n.min?E.castDate(Math.min(n.min,r)):r,n.max=n.max?E.castDate(Math.max(n.max,r)):r,n.sum+=e,n.count++}},{key:"_addDateColumnField",value:function(t){this._dateFields.has(t)||(this._dateFields.add(t),this._properties[t]={type:"date",min:null,max:null,avg:null,sum:0,count:0})}},{key:"_addPropertyToMetadata",value:function(t,e){return this._providedDateColumns.has(t)?this._addDatePropertyToMetadata(t,e):Number.isFinite(e)?this._addNumericPropertyToMetadata(t,e):void this._addCategoryPropertyToMetadata(t,e)}},{key:"_addCategoryPropertyToMetadata",value:function(t,e){if(this._numFields.has(t)||this._dateFields.has(t))throw new Q("".concat($.NOT_SUPPORTED," Unsupported GeoJSON: the property '").concat(t,"' has different types in different features."));this._catFields.has(t)||(this._catFields.add(t),this._properties[t]={type:"category",categories:[]});var n=this._properties[t],r=n.categories.find(function(t){return t.name===e});r?r.frequency++:n.categories.push({name:e,frequency:1})}},{key:"_decodeUnboundProperties",value:function(){var t=this,e={};f()(this._numFields).concat(f()(this._catFields)).concat(f()(this._dateFields)).map(function(n){t._boundColumns.has(n)||(e[n]=new Float32Array(t._features.length+1024))});for(var n=f()(this._catFields).filter(function(e){return!t._boundColumns.has(e)}),r=f()(this._numFields).filter(function(e){return!t._boundColumns.has(e)}),i=f()(this._dateFields).filter(function(e){return!t._boundColumns.has(e)}),a=function(a){var o=t._features[a];n.forEach(function(n){e[n][a]=t._metadata.categorizeString(n,o.properties[n],!0)}),r.forEach(function(t){"cartodb_id"!==t||Number.isFinite(o.properties.cartodb_id)||(o.properties.cartodb_id=-a);var n=Number(o.properties[t]);e[t][a]=Number.isNaN(n)?Number.MIN_SAFE_INTEGER:n}),i.forEach(function(n){var r=t._properties[n],i=E.castDate(o.properties[n]).getTime(),u=r.min,s=r.max,c=(i-u.getTime())/(s.getTime()-u.getTime());e[n][a]=c})},o=0;o<this._features.length;o++)a(o);return e}},{key:"_getDataframeType",value:function(t){switch(t){case"Point":return"point";case"LineString":case"MultiLineString":return"line";case"Polygon":case"MultiPolygon":return"polygon";default:return""}}},{key:"_fetchFeatureGeometry",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=this._features.length,r=t.sample?Math.max(1,Math.floor(n/t.sample)):1,i=0;i<n;i+=r){var a=this._features[i];"Feature"===a.type&&e(i,a.geometry)}return null}},{key:"_allocGeometry",value:function(){return"Point"===this._type?new Float32Array(6*this._features.length):[]}},{key:"_decodeGeometry",value:function(){var t=this,e=this._allocGeometry();return this._fetchFeatureGeometry({},function(n,r){var i=r.type,a=r.coordinates;if(t._type!==i)throw new O("".concat(P.INCORRECT_TYPE," multiple geometry types not supported: found '").concat(i,"' instead of '").concat(t._type,"'."));if("Point"===i){var o=t._computePointGeometry(a);e[6*n+0]=o.x,e[6*n+1]=o.y,e[6*n+2]=o.x,e[6*n+3]=o.y,e[6*n+4]=o.x,e[6*n+5]=o.y}else if("LineString"===i){var u=t._computeLineStringGeometry(a);e.push([u])}else if("MultiLineString"===i){var s=t._computeMultiLineStringGeometry(a);e.push(s)}else if("Polygon"===i){var c=t._computePolygonGeometry(a);e.push([c])}else if("MultiPolygon"===i){var f=t._computeMultiPolygonGeometry(a);e.push(f)}}),e}},{key:"_computePointGeometry",value:function(t){var e=t[1],n=t[0],r=E.projectToWebMercator({lat:e,lng:n});return Kc(r.x,r.y,{scale:E.WM_R,center:this._center})}},{key:"_computeLineStringGeometry",value:function(t,e){for(var n=[],r=0;r<t.length;r++){var i=this._computePointGeometry(t[e?t.length-r-1:r]);n.push(i.x,i.y)}return n}},{key:"_computeMultiLineStringGeometry",value:function(t){for(var e=[],n=0;n<t.length;n++){var r=this._computeLineStringGeometry(t[n]);r.length>0&&e.push(r)}return e}},{key:"_computePolygonGeometry",value:function(t){var e={flat:[],holes:[],clipped:[]},n=0,r=!1;if(t.length){r=this._isReversed(t[0]);var i=this._computeLineStringGeometry(t[0],r);e.flat=e.flat.concat(i)}for(var a=1;a<t.length;a++){r!==this._isReversed(t[a])&&(n+=t[a-1].length,e.holes.push(n));var o=this._computeLineStringGeometry(t[a],r);e.flat=e.flat.concat(o)}return e}},{key:"_computeMultiPolygonGeometry",value:function(t){for(var e=[],n=0;n<t.length;n++){var r=this._computePolygonGeometry(t[n]);r.flat.length>0&&e.push(r)}return e}},{key:"_isReversed",value:function(t){for(var e,n=0,r=t[0],i=0;i<t.length-1;i++)n+=((e=t[i+1])[1]-r[1])*(e[0]+r[0]),r=e;return n>=0}},{key:"_samplePoint",value:function(t){var e=t.type,n=t.coordinates;return"Point"===e?n:"LineString"===e?n[0]:"MultiLineString"===e||"Polygon"===e?n[0][0]:"MultiPolygon"===e?n[0][0][0]:void 0}},{key:"_setCoordinatesCenter",value:function(){var t=this,e=0,n=0,r=0;this._fetchFeatureGeometry({sample:10},function(i,a){t._type||(t._type=a.type);var o=t._samplePoint(a),u=E.projectToWebMercator({lng:o[0],lat:o[1]});e+=u.x,n+=u.y,r+=1}),r>1&&(e/=r,n/=r),this._center={x:e,y:n},this._dataframeCenter=Kc(this._center.x,this._center.y,{scale:E.WM_R,center:{x:0,y:0}})}},{key:"free",value:function(){}}]),e}(Tu),Mf=function(t){function e(t,n,r){var i;return A()(this,e),(i=M()(this,R()(e).call(this)))._checkQuery(t),i._query=t,i.initialize(n,r),i}return I()(e,t),G()(e,[{key:"_getFromClause",value:function(){return"(".concat(this._query,") as _cdb_query_wrapper")}},{key:"_clone",value:function(){return new e(this._query,this._auth,this._config)}},{key:"_checkQuery",value:function(t){if(E.isUndefined(t))throw new O("".concat(P.MISSING_REQUIRED," 'query'"));if(!E.isString(t))throw new O("".concat(P.INCORRECT_TYPE," 'query' property must be a string."));if(""===t)throw new O("".concat(P.INCORRECT_VALUE," 'query' property must be not empty."));if(!t.match(/\bSELECT\b/i))throw new O("".concat(P.INCORRECT_VALUE," 'query' property must be a SQL query."))}}]),e}(kf),Sf=[];function Rf(t,e,n){var r=[];if("loaded"===t){var i=new Set(e);e.forEach(function(t){var e=function(){i.delete(t),0===i.size&&n()};t.on("loaded",e),r.push(e)})}else{if("updated"!==t)throw new O("".concat(P.INCORRECT_VALUE," Event name '").concat(t,"' is not supported by \"carto.on\". Supported event names are: 'loaded' and 'updated'."));var a=!1;e.forEach(function(t){var e=function(){a||window.requestAnimationFrame(function(){a=!1,n()})};t.on("updated",e),r.push(e)})}Sf.push({eventName:t,layerList:e,callback:n,internalCallbacks:r})}function Df(t,e,n){Sf.forEach(function(r){r.eventName===t&&r.layerList.every(function(t){return e.includes(t)})&&r.callback===n&&r.layerList.forEach(function(e){r.internalCallbacks.forEach(function(n){e.off(t,n)})})}),Sf=Sf.filter(function(r){return!(r.eventName===t&&r.layerList.every(function(t){return e.includes(t)})&&r.callback===n)})}var If="https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",Ff="https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json",Nf="https://basemaps.cartocdn.com/gl/positron-gl-style/style.json";n.d(e,"source",function(){return Of}),n.d(e,"version",function(){return kc.a}),n.d(e,"on",function(){return Rf}),n.d(e,"off",function(){return Df}),n.d(e,"setDefaultAuth",function(){return L}),n.d(e,"setDefaultConfig",function(){return U}),n.d(e,"expressions",function(){return a}),n.d(e,"Layer",function(){return xc}),n.d(e,"Viz",function(){return yu}),n.d(e,"Interactivity",function(){return Tc}),n.d(e,"basemaps",function(){return s});var Of={Dataset:Af,SQL:Mf,GeoJSON:Cf,MVT:af};e.default={version:kc.a,on:Rf,off:Df,setDefaultAuth:L,setDefaultConfig:U,source:Of,expressions:a,Layer:xc,Viz:yu,Interactivity:Tc,basemaps:s}}])});