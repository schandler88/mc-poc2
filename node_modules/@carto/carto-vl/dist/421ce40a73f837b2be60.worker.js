/*!
 * CARTO VL js https://carto.com/
 * Version: 0.7.0
 * 
 */!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=8)}([function(t,e,r){"use strict";var n=r(1);function i(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(s,this,e),this.length=this._features.length}function s(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(function(t){var e=null,r=t.readVarint()+t.pos;for(;t.pos<r;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(r))}t.exports=i,i.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new n(this._pbf,e,this.extent,this._keys,this._values)}},function(t,e,r){"use strict";var n=r(6);function i(t,e,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=i,t.readFields(s,this,e)}function s(t,e,r){1==t?e.id=r.readVarint():2==t?function(t,e){var r=t.readVarint()+t.pos;for(;t.pos<r;){var n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}function o(t){for(var e,r,n=0,i=0,s=t.length,o=s-1;i<s;o=i++)e=t[i],n+=((r=t[o]).x-e.x)*(e.y+r.y);return n}t.exports=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,i=1,s=0,o=0,a=0,u=[];t.pos<r;){if(s<=0){var h=t.readVarint();i=7&h,s=h>>3}if(s--,1===i||2===i)o+=t.readSVarint(),a+=t.readSVarint(),1===i&&(e&&u.push(e),e=[]),e.push(new n(o,a));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&u.push(e),u},i.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,n=0,i=0,s=0,o=1/0,a=-1/0,u=1/0,h=-1/0;t.pos<e;){if(n<=0){var f=t.readVarint();r=7&f,n=f>>3}if(n--,1===r||2===r)i+=t.readSVarint(),s+=t.readSVarint(),i<o&&(o=i),i>a&&(a=i),s<u&&(u=s),s>h&&(h=s);else if(7!==r)throw new Error("unknown command "+r)}return[o,u,a,h]},i.prototype.toGeoJSON=function(t,e,r){var n,s,a=this.extent*Math.pow(2,r),u=this.extent*t,h=this.extent*e,f=this.loadGeometry(),c=i.types[this.type];function l(t){for(var e=0;e<t.length;e++){var r=t[e],n=180-360*(r.y+h)/a;t[e]=[360*(r.x+u)/a-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(n=0;n<f.length;n++)p[n]=f[n][0];l(f=p);break;case 2:for(n=0;n<f.length;n++)l(f[n]);break;case 3:for(f=function(t){var e=t.length;if(e<=1)return[t];for(var r,n,i=[],s=0;s<e;s++){var a=o(t[s]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(r&&i.push(r),r=[t[s]]):r.push(t[s]))}r&&i.push(r);return i}(f),n=0;n<f.length;n++)for(s=0;s<f[n].length;s++)l(f[n][s])}1===f.length?f=f[0]:c="Multi"+c;var y={type:"Feature",geometry:{type:c,coordinates:f},properties:this.properties};return"id"in this&&(y.id=this.id),y}},function(t,e,r){t.exports.VectorTile=r(5),t.exports.VectorTileFeature=r(1),t.exports.VectorTileLayer=r(0)},function(t,e,r){"use strict";t.exports=i;var n=r(7);function i(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;function s(t){return t.type===i.Bytes?t.readVarint()+t.pos:t.pos+1}function o(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function a(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=t;i--)r.buf[i+n]=r.buf[i]}function u(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function h(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function f(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function c(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function l(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function p(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function y(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function d(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function x(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function g(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function v(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function m(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,s=this.pos;this.type=7&n,t(i,e,this),this.pos===s&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=g(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=m(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=g(this.buf,this.pos)+4294967296*g(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=g(this.buf,this.pos)+4294967296*m(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,n=this.buf;return e=127&(r=n[this.pos++]),r<128?e:(e|=(127&(r=n[this.pos++]))<<7,r<128?e:(e|=(127&(r=n[this.pos++]))<<14,r<128?e:(e|=(127&(r=n[this.pos++]))<<21,r<128?e:function(t,e,r){var n,i,s=r.buf;if(i=s[r.pos++],n=(112&i)>>4,i<128)return o(t,n,e);if(i=s[r.pos++],n|=(127&i)<<3,i<128)return o(t,n,e);if(i=s[r.pos++],n|=(127&i)<<10,i<128)return o(t,n,e);if(i=s[r.pos++],n|=(127&i)<<17,i<128)return o(t,n,e);if(i=s[r.pos++],n|=(127&i)<<24,i<128)return o(t,n,e);if(i=s[r.pos++],n|=(1&i)<<31,i<128)return o(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,r){var n="",i=e;for(;i<r;){var s,o,a,u=t[i],h=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f>r)break;1===f?u<128&&(h=u):2===f?128==(192&(s=t[i+1]))&&(h=(31&u)<<6|63&s)<=127&&(h=null):3===f?(s=t[i+1],o=t[i+2],128==(192&s)&&128==(192&o)&&((h=(15&u)<<12|(63&s)<<6|63&o)<=2047||h>=55296&&h<=57343)&&(h=null)):4===f&&(s=t[i+1],o=t[i+2],a=t[i+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&((h=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||h>=1114112)&&(h=null)),null===h?(h=65533,f=1):h>65535&&(h-=65536,n+=String.fromCharCode(h>>>10&1023|55296),h=56320|1023&h),n+=String.fromCharCode(h),i+=f}return n}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var r=s(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),v(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),v(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),v(this.buf,-1&t,this.pos),v(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),v(this.buf,-1&t,this.pos),v(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var r,n;t>=0?(r=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,n=n+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos]=127&t}(r,0,e),function(t,e){var r=(7&t)<<4;if(e.buf[e.pos++]|=r|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var n,i,s=0;s<e.length;s++){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){n>56319||s+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):i=n;continue}if(n<56320){t[r++]=239,t[r++]=191,t[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(t[r++]=239,t[r++]=191,t[r++]=189,i=null);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(n<65536?t[r++]=n>>12|224:(t[r++]=n>>18|240,t[r++]=n>>12&63|128),t[r++]=n>>6&63|128),t[r++]=63&n|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&a(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),n.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),n.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&a(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,r){this.writeTag(t,i.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){this.writeMessage(t,u,e)},writePackedSVarint:function(t,e){this.writeMessage(t,h,e)},writePackedBoolean:function(t,e){this.writeMessage(t,l,e)},writePackedFloat:function(t,e){this.writeMessage(t,f,e)},writePackedDouble:function(t,e){this.writeMessage(t,c,e)},writePackedFixed32:function(t,e){this.writeMessage(t,p,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,y,e)},writePackedFixed64:function(t,e){this.writeMessage(t,d,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,x,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},function(t,e,r){"use strict";function n(t,e,r){r=r||2;var n,a,u,h,f,p,d,x=e&&e.length,g=x?e[0]*r:t.length,v=i(t,0,g,r,!0),m=[];if(!v)return m;if(x&&(v=function(t,e,r,n){var o,a,u,h,f,p=[];for(o=0,a=e.length;o<a;o++)u=e[o]*n,h=o<a-1?e[o+1]*n:t.length,(f=i(t,u,h,n,!1))===f.next&&(f.steiner=!0),p.push(y(f));for(p.sort(c),o=0;o<p.length;o++)l(p[o],r),r=s(r,r.next);return r}(t,e,v,r)),t.length>80*r){n=u=t[0],a=h=t[1];for(var w=r;w<g;w+=r)f=t[w],p=t[w+1],f<n&&(n=f),p<a&&(a=p),f>u&&(u=f),p>h&&(h=p);d=0!==(d=Math.max(u-n,h-a))?1/d:0}return o(v,m,r,n,a,d),m}function i(t,e,r,n,i){var s,o;if(i===V(t,e,r,n)>0)for(s=e;s<r;s+=n)o=_(s,t[s],t[s+1],o);else for(s=r-n;s>=e;s-=n)o=_(s,t[s],t[s+1],o);return o&&v(o,o.next)&&(F(o),o=o.next),o}function s(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!v(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{if(F(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function o(t,e,r,n,i,c,l){if(t){!l&&c&&function(t,e,r,n){var i=t;do{null===i.z&&(i.z=p(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,r,n,i,s,o,a,u,h=1;do{for(r=t,t=null,s=null,o=0;r;){for(o++,n=r,a=0,e=0;e<h&&(a++,n=n.nextZ);e++);for(u=h;a>0||u>0&&n;)0!==a&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,u--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;r=n}s.nextZ=null,h*=2}while(o>1)}(i)}(t,n,i,c);for(var y,d,x=t;t.prev!==t.next;)if(y=t.prev,d=t.next,c?u(t,n,i,c):a(t))e.push(y.i/r),e.push(t.i/r),e.push(d.i/r),F(t),t=d.next,x=d.next;else if((t=d)===x){l?1===l?o(t=h(t,e,r),e,r,n,i,c,2):2===l&&f(t,e,r,n,i,c):o(s(t),e,r,n,i,c,1);break}}}function a(t){var e=t.prev,r=t,n=t.next;if(g(e,r,n)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(d(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&g(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(t,e,r,n){var i=t.prev,s=t,o=t.next;if(g(i,s,o)>=0)return!1;for(var a=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,u=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,h=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,f=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,c=p(a,u,e,r,n),l=p(h,f,e,r,n),y=t.prevZ,x=t.nextZ;y&&y.z>=c&&x&&x.z<=l;){if(y!==t.prev&&y!==t.next&&d(i.x,i.y,s.x,s.y,o.x,o.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,x!==t.prev&&x!==t.next&&d(i.x,i.y,s.x,s.y,o.x,o.y,x.x,x.y)&&g(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;y&&y.z>=c;){if(y!==t.prev&&y!==t.next&&d(i.x,i.y,s.x,s.y,o.x,o.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;x&&x.z<=l;){if(x!==t.prev&&x!==t.next&&d(i.x,i.y,s.x,s.y,o.x,o.y,x.x,x.y)&&g(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function h(t,e,r){var n=t;do{var i=n.prev,s=n.next.next;!v(i,s)&&m(i,n,n.next,s)&&w(i,s)&&w(s,i)&&(e.push(i.i/r),e.push(n.i/r),e.push(s.i/r),F(n),F(n.next),n=t=s),n=n.next}while(n!==t);return n}function f(t,e,r,n,i,a){var u=t;do{for(var h=u.next.next;h!==u.prev;){if(u.i!==h.i&&x(u,h)){var f=b(u,h);return u=s(u,u.next),f=s(f,f.next),o(u,e,r,n,i,a),void o(f,e,r,n,i,a)}h=h.next}u=u.next}while(u!==t)}function c(t,e){return t.x-e.x}function l(t,e){if(e=function(t,e){var r,n=e,i=t.x,s=t.y,o=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var a=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&a>o){if(o=a,a===i){if(s===n.y)return n;if(s===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(i===o)return r.prev;var u,h=r,f=r.x,c=r.y,l=1/0;n=r.next;for(;n!==h;)i>=n.x&&n.x>=f&&i!==n.x&&d(s<c?i:o,s,f,c,s<c?o:i,s,n.x,n.y)&&((u=Math.abs(s-n.y)/(i-n.x))<l||u===l&&n.x>r.x)&&w(n,t)&&(r=n,l=u),n=n.next;return r}(t,e)){var r=b(e,t);s(r,r.next)}}function p(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function y(t){var e=t,r=t;do{e.x<r.x&&(r=e),e=e.next}while(e!==t);return r}function d(t,e,r,n,i,s,o,a){return(i-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(n-a)-(r-o)*(e-a)>=0&&(r-o)*(s-a)-(i-o)*(n-a)>=0}function x(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&m(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&w(t,e)&&w(e,t)&&function(t,e){var r=t,n=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do{r.y>s!=r.next.y>s&&r.next.y!==r.y&&i<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)}function g(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function m(t,e,r,n){return!!(v(t,e)&&v(r,n)||v(t,n)&&v(r,e))||g(t,e,r)>0!=g(t,e,n)>0&&g(r,n,t)>0!=g(r,n,e)>0}function w(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function b(t,e){var r=new M(t.i,t.x,t.y),n=new M(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function _(t,e,r,n){var i=new M(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function F(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function M(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function V(t,e,r,n){for(var i=0,s=e,o=r-n;s<r;s+=n)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}t.exports=n,t.exports.default=n,n.deviation=function(t,e,r,n){var i=e&&e.length,s=i?e[0]*r:t.length,o=Math.abs(V(t,0,s,r));if(i)for(var a=0,u=e.length;a<u;a++){var h=e[a]*r,f=a<u-1?e[a+1]*r:t.length;o-=Math.abs(V(t,h,f,r))}var c=0;for(a=0;a<n.length;a+=3){var l=n[a]*r,p=n[a+1]*r,y=n[a+2]*r;c+=Math.abs((t[l]-t[y])*(t[p+1]-t[l+1])-(t[l]-t[p])*(t[y+1]-t[l+1]))}return 0===o&&0===c?0:Math.abs((c-o)/o)},n.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)r.vertices.push(t[i][s][o]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r}},function(t,e,r){"use strict";var n=r(0);function i(t,e,r){if(3===t){var i=new n(r,r.readVarint()+r.pos);i.length&&(e[i.name]=i)}}t.exports=function(t,e){this.layers=t.readFields(i,{},e)}},function(t,e,r){"use strict";function n(t,e){this.x=t,this.y=e}t.exports=n,n.prototype={clone:function(){return new n(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,i=r*this.x+e*this.y;return this.x=n,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),i=e.x+r*(this.x-e.x)-n*(this.y-e.y),s=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=i,this.y=s,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(t){return t instanceof n?t:Array.isArray(t)?new n(t[0],t[1]):t}},function(t,e){e.read=function(t,e,r,n,i){var s,o,a=8*i-n-1,u=(1<<a)-1,h=u>>1,f=-7,c=r?i-1:0,l=r?-1:1,p=t[e+c];for(c+=l,s=p&(1<<-f)-1,p>>=-f,f+=a;f>0;s=256*s+t[e+c],c+=l,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=n;f>0;o=256*o+t[e+c],c+=l,f-=8);if(0===s)s=1-h;else{if(s===u)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),s-=h}return(p?-1:1)*o*Math.pow(2,s-n)},e.write=function(t,e,r,n,i,s){var o,a,u,h=8*s-i-1,f=(1<<h)-1,c=f>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,y=n?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+c>=1?l/u:l*Math.pow(2,1-c))*u>=2&&(o++,u/=2),o+c>=f?(a=0,o=f):o+c>=1?(a=(e*u-1)*Math.pow(2,i),o+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,i),o=0));i>=8;t[r+p]=255&a,p+=y,a/=256,i-=8);for(o=o<<i|a,h+=i;h>0;t[r+p]=255&o,p+=y,o/=256,h-=8);t[r+p-y]|=128*d}},function(t,e,r){"use strict";r.r(e);var n=r(2),i=r(3);function s(t,e,r){return{center:{x:(t+.5)/Math.pow(2,r)*2-1,y:2*(1-(e+.5)/Math.pow(2,r))-1},scale:1/Math.pow(2,r)}}function o([t,e],[r,n]){return[t-r,e-n]}function a([t,e],[r,n]){return t*r+e*n}function u([t,e]){return[-e,t]}function h(t,e){const r=function(t,e){const r=Math.hypot(t,e);return[t/r,e/r]}(t[0]-e[0],t[1]-e[1]);return[-r[1],r[0]]}function f(t,e){const r=[t[1],-t[0]],n=[-e[1],e[0]],i=n[0]*r[1]-n[1]*r[0],s=n[0]*r[0]+n[1]*r[1],o=Math.abs(i);return{turnLeft:i>0,joinNormal:!(o<.866&&s>.5)&&c([(r[0]+n[0])/o,(r[1]+n[1])/o])}}function c(t){return[-t[0],-t[1]]}function l(t,e,r){return(t.x-r.x)*(e.y-r.y)-(e.x-r.x)*(t.y-r.y)}function p(t,e){return t.x===e.x&&t.y===e.y}function y(t,e,r){switch(r){case"line":return function(t,e){const r=t,n=t.length;for(let t=0;t<n;t+=2)e.minx=Math.min(e.minx,r[t+0]),e.miny=Math.min(e.miny,r[t+1]),e.maxx=Math.max(e.maxx,r[t+0]),e.maxy=Math.max(e.maxy,r[t+1]);return e}(t,e);case"polygon":return function(t,e){const[r,n]=[t.flat,t.holes[0]||t.flat.length/2];for(let t=0;t<n;t++)e.minx=Math.min(e.minx,r[2*t+0]),e.miny=Math.min(e.miny,r[2*t+1]),e.maxx=Math.max(e.maxx,r[2*t+0]),e.maxy=Math.max(e.maxy,r[2*t+1]);return e}(t,e)}}var d={intersect:function(t,e,r,n){const i=t,s=r,h=o(e,t),f=o(n,r),c=u(h),l=u(f),p=a(o(s,i),l)/a(h,l),y=a(o(i,s),c)/a(f,c);if(p>=0&&p<=1&&y>=0&&y<=1)return[i[0]+p*h[0],i[1]+p*h[1]]},sub:o,dot:a,perpendicular:u,getLineNormal:h,getJoinNormal:f,neg:c,halfPlaneSign:l,pointInTriangle:function(t,e,r,n){if(p(e,r)||p(r,n)||p(n,e))return!1;const i=l(t,e,r)<0,s=l(t,r,n)<0,o=l(t,n,e)<0;return i===s&&s===o},equalPoints:p,pointInCircle:function(t,e,r){const n=t.x-e.x,i=t.y-e.y;return n*n+i*i<=r*r},pointInRectangle:function(t,e){if(null===e)return!1;const r=t.x.toFixed(2),n=t.y.toFixed(2);return e.minx<=r&&r<=e.maxx&&e.miny<=n&&n<=e.maxy}};class x{constructor(){this.flat=[],this.holes=[],this.clipped=[],this.clippedType=[]}}function g(t,e){let r=[];return t.map(t=>{let n=[];t.map(t=>{n.push([2*t.x/e-1,2*(1-t.y/e)-1])}),r.push(...function(t){let e=[];const r=[];function n(t){let e=0;for(let r=0;r<w;r++)e|=m[r].inside(t)?0:1<<r;return e}function i(t,e,r){for(let i=0;i<w;i++){const s=1<<i;if(r&s){const o=m[i].intersect(t,e);return r=n(o)&~s,[o,r]}}}let s=t[0],o=n(s);for(let a=1;a<t.length;++a){let u=t[a],h=n(u);const f=h,c=u;for(;;){if(!(o|h)){e.push(...s),h!==f?(e.push(...u),a<t.length-1&&(r.push(e),e=[])):a===t.length-1&&e.push(...u);break}if(o&h)break;o?[s,o]=i(s,u,o):[u,h]=i(s,u,h)}s=c,o=f}(e=function(t){const e=[];let r,n;for(let i=0;i<t.length;i+=2){const s=t[i],o=t[i+1];s===r&&o===n||(e.push(s,o),r=s,n=o)}return e}(e)).length>0&&r.push(e);return r}(n))}),r}function v(t,e){let r,n=null,i=[];return t.forEach(t=>{let s=function(t){let e=0;for(let r=0;r<t.length;r++){let n=(r+1)%t.length;e+=t[r].x*t[n].y,e-=t[n].x*t[r].y}return e/2}(t);if(0===s)return;void 0===r&&(r=s>0);const o=r?s>0:s<0,a=function(t,e){return t.map(t=>{let r=t.x,n=t.y;return[r=2*r/e-1,n=2*(1-n/e)-1]})}(t,e);o&&(n&&i.push(n),n=new x),n=function(t,e,r){let n={};for(let e=0;e<w;e++){const r=[],i={},s=(t,e,r=-1)=>{let s=0;e>=0&&(s=n[e]||0),r>=0&&(s|=1<<r),s&&(i[t]=s)};for(let n=0;n<t.length-1;n++){const i=t[n],o=t[n+1],a=m[e].inside(i),u=m[e].inside(o);if(a&&u)s(r.length,n+1),r.push(o);else if(a){const t=m[e].intersect(i,o);s(r.length,n+1,e),r.push(t)}else if(u){const t=m[e].intersect(i,o);s(r.length,n,e),r.push(t),s(r.length,n+1),r.push(o)}}r.length&&(i[0]&&(i[r.length]=i[0]),r.push(r[0])),t=r,n=i}t.length>=4&&(r&&e.holes.push(e.flat.length/2),t.forEach(t=>{e.flat.push(t[0],t[1])}),Object.keys(n).forEach(t=>{e.clipped.push(2*Number(t)),e.clippedType.push(n[t])}));return e}(a,n,!o)}),n&&i.push(n),i}const m=[{inside:t=>t[0]<=1,intersect:(t,e)=>d.intersect(t,e,[1,-100],[1,100])},{inside:t=>t[1]<=1,intersect:(t,e)=>d.intersect(t,e,[-100,1],[100,1])},{inside:t=>t[0]>=-1,intersect:(t,e)=>d.intersect(t,e,[-1,-100],[-1,100])},{inside:t=>t[1]>=-1,intersect:(t,e)=>d.intersect(t,e,[-100,-1],[100,-1])}],w=m.length;class b{constructor({properties:t,featureCount:e,sample:r,geomType:n,isAggregated:i,idProperty:s}={properties:{}}){this.properties=t,this.featureCount=e,this.sample=r,this.geomType=n,this.isAggregated=i,this.idProperty=s||"cartodb_id",this.categoryToID=new Map,this.IDToCategory=new Map,this.numCategories=0,Object.values(t).map(t=>{t.categories=t.categories||[],t.categories.map(e=>this.categorizeString(t,e.name,!0))}),this.propertyKeys=Object.keys(this.properties)}categorizeString(t,e,r=!1){return void 0===e&&(e=null),this.categoryToID.has(e)?this.categoryToID.get(e):(r||this.properties[t].categories.push({name:e,frequency:Number.NaN}),this.categoryToID.set(e,this.numCategories),this.IDToCategory.set(this.numCategories,e),this.numCategories++,this.numCategories-1)}propertyNames(t){const e=this.properties[t];return e.aggregations?Object.keys(e.aggregations).map(t=>e.aggregations[t]):[t]}}function _(t,e,r,n,i){let s,o,a,u,l,p;if(t.length>=4){u=h(s=[t[0],t[1]],o=[t[2],t[3]]);for(let y=4;y<=t.length;y+=2){if((p=!(i&&i(y)))&&(e.vertices[r]=s[0],e.normals[r++]=-u[0],e.vertices[r]=s[1],e.normals[r++]=-u[1],e.vertices[r]=s[0],e.normals[r++]=u[0],e.vertices[r]=s[1],e.normals[r++]=u[1],e.vertices[r]=o[0],e.normals[r++]=u[0],e.vertices[r]=o[1],e.normals[r++]=u[1],e.vertices[r]=s[0],e.normals[r++]=-u[0],e.vertices[r]=s[1],e.normals[r++]=-u[1],e.vertices[r]=o[0],e.normals[r++]=u[0],e.vertices[r]=o[1],e.normals[r++]=u[1],e.vertices[r]=o[0],e.normals[r++]=-u[0],e.vertices[r]=o[1],e.normals[r++]=-u[1]),y<=t.length-2?a=[t[y],t[y+1]]:n&&(a=[t[2],t[3]]),a&&(l=h(o,a),p)){let{turnLeft:t,joinNormal:i}=f(u,l),s=t?u:c(l),a=t?l:c(u);e.vertices[r]=o[0],e.normals[r++]=0,e.vertices[r]=o[1],e.normals[r++]=n?1e-37:0,e.vertices[r]=o[0],e.normals[r++]=s[0],e.vertices[r]=o[1],e.normals[r++]=s[1],e.vertices[r]=o[0],e.normals[r++]=a[0],e.vertices[r]=o[1],e.normals[r++]=a[1],i&&(e.vertices[r]=o[0],e.normals[r++]=i[0],e.vertices[r]=o[1],e.normals[r++]=i[1],e.vertices[r]=o[0],e.normals[r++]=a[0],e.vertices[r]=o[1],e.normals[r++]=a[1],e.vertices[r]=o[0],e.normals[r++]=s[0],e.vertices[r]=o[1],e.normals[r++]=s[1])}s=o,o=a,u=l,a=null}}return r}function F(t,e){const r=new Float32Array(e);return r.set(t),r}const M=24;let V=0,T={vertices:new Float32Array(1048576),normals:new Float32Array(1048576)};function N(t){const e=V+t;if(e>T.vertices.length){const t=2*e;T.vertices=F(T.vertices,t),T.normals=F(T.normals,t)}}var S=r(4);const P=2,k=24;let I=0,B={vertices:new Float32Array(2097152),normals:new Float32Array(2097152)};function A(t){const e=I+t;if(e>B.vertices.length){const t=2*e;B.vertices=F(B.vertices,t),B.normals=F(B.normals,t)}}function O(t,e){B.vertices[I]=t[e],B.normals[I++]=0,B.vertices[I]=t[e+1],B.normals[I++]=0}function E(t,e,r){return!!(t.clipped.includes(e)&&t.clipped.includes(r)&&t.clippedType[t.clipped.indexOf(e)]&t.clippedType[t.clipped.indexOf(r)])}function D(t,e){switch(t){case"point":return function(t){return{verticesArrayBuffer:t,vertices:new Float32Array(t),breakpoints:[]}}(e);case"line":return function(t){let e=[],r=new Map;V=0;for(let n=0;n<t.length;n++){const i=t[n];for(let t=0;t<i.length;t++)N(M*i[t].length),V=_(i[t],T,V);r.set(e.length,0===e.length?{start:0,end:V}:{start:r.get(e.length-1).end,end:V}),e.push(V)}const n=new ArrayBuffer(4*V),i=new ArrayBuffer(4*V),s=new Float32Array(n),o=new Float32Array(i);for(let t=0;t<V;t++)s[t]=T.vertices[t],o[t]=T.normals[t];return{vertices:s,normals:o,verticesArrayBuffer:n,normalsArrayBuffer:i,featureIDToVertexIndex:r,breakpoints:e}}(e);case"polygon":return function(t){let e=[],r=new Map;I=0;for(let n=0;n<t.length;n++){const i=t[n];for(let t=0;t<i.length;t++){const e=i[t],r=S(e.flat,e.holes);A(P*r.length+k*e.flat.length);for(let t=0;t<r.length;t++)O(e.flat,2*r[t]);I=_(e.flat,B,I,!0,t=>e.holes.includes((t-2)/2)||E(e,t-4,t-2))}r.set(e.length,0===e.length?{start:0,end:I}:{start:r.get(e.length-1).end,end:I}),e.push(I)}const n=new ArrayBuffer(4*I),i=new ArrayBuffer(4*I),s=new Float32Array(n),o=new Float32Array(i);for(let t=0;t<I;t++)s[t]=B.vertices[t],o[t]=B.normals[t];return{vertices:s,normals:o,verticesArrayBuffer:n,normalsArrayBuffer:i,featureIDToVertexIndex:r,breakpoints:e}}(e);default:throw new Error(`Unimplemented geometry type: '${t}'`)}}class Z{constructor({center:t,scale:e,geom:r,properties:n,type:i,active:s,size:o,metadata:a}){this.active=s,this.center=t,this.properties=n,this.scale=e,this.type=i,this.decodedGeom=D(i,r),this.numVertex="point"===i?3*o:this.decodedGeom.vertices.length/2,this.numFeatures="point"===i?o:this.decodedGeom.breakpoints.length||this.numVertex,this.propertyTex=[],this.metadata=a,this.propertyCount=0,this._aabb=function(t,e){switch(e){case"point":return[];case"line":case"polygon":const r=[];for(let n=0;n<t.length;n++){const i=t[n];let s={minx:Number.POSITIVE_INFINITY,miny:Number.POSITIVE_INFINITY,maxx:Number.NEGATIVE_INFINITY,maxy:Number.NEGATIVE_INFINITY};for(let t=0;t<i.length;t++)s=y(i[t],s,e);s.minx===Number.POSITIVE_INFINITY&&(s=null),r.push(s)}return r}}(r,i)}}const j=1024,L={point:1,line:2,polygon:3},z={UNKNOWN:"unknown",POINT:"point",LINE:"line",POLYGON:"polygon"},C={1:z.POINT,2:z.LINE,3:z.POLYGON};class G{onmessage(t){this.processEvent(t).then(t=>{const e=[];t.dataframe.empty||(e.push(this._propertiesArrayBuffer),e.push(t.dataframe.decodedGeom.verticesArrayBuffer),t.dataframe.decodedGeom.normalsArrayBuffer&&e.push(t.dataframe.decodedGeom.normalsArrayBuffer)),postMessage(t,e)})}async processEvent(t){const e=t.data;e.metadata&&(Object.setPrototypeOf(e.metadata,b.prototype),this.metadata=e.metadata);const r=await this._requestDataframe(e.x,e.y,e.z,e.url,e.layerID,this.metadata);return{mID:e.mID,dataframe:r}}async _requestDataframe(t,e,r,n,i,s){const o=await fetch(n);return await this.urlToDataframeTransformer(o,t,e,r,i,s)}async urlToDataframeTransformer(t,e,r,o,a,u){const h=await t.arrayBuffer();if(0===h.byteLength||"null"===t)return{empty:!0};const f=new n.VectorTile(new i(h));if(Object.keys(f.layers).length>1&&!a)throw new Error(`LayerID parameter wasn't specified and the MVT tile contains multiple layers: ${JSON.stringify(Object.keys(f.layers))}`);const c=f.layers[a||Object.keys(f.layers)[0]];if(!c)return{empty:!0};const{geometries:l,properties:p,numFeatures:y}=this._decodeMVTLayer(c,u,4096),d=s(e,r,o);return this._generateDataFrame(d,l,p,y,u.geomType,u)}_decodeMVTLayer(t,e,r){if(!t.length)return{properties:[],geometries:{},numFeatures:0};switch(e.geomType||(e.geomType=this._autoDiscoverType(t)),e.geomType){case z.POINT:const n=new ArrayBuffer(2*t.length*3*4);return this._decode(t,e,r,n);case z.LINE:return this._decode(t,e,r,[],g);case z.POLYGON:return this._decode(t,e,r,[],v);default:throw new Error("MVT: invalid geometry type")}}_autoDiscoverType(t){switch(t.feature(0).type){case L.point:return z.POINT;case L.line:return z.LINE;case L.polygon:return z.POLYGON;default:throw new Error("MVT: invalid geometry type")}}_decode(t,e,r,n,i){let s,o=0;n&&(s=new Float32Array(n));const{properties:a,propertyNames:u}=this._initializePropertyArrays(e,t.length);for(let h=0;h<t.length;h++){const f=t.feature(h);this._checkType(f,e.geomType);const c=f.loadGeometry();if(i){const t=i(c,r);n.push(t)}else{const t=2*c[0][0].x/r-1,e=2*(1-c[0][0].y/r)-1;if(t<-1||t>=1||e<-1||e>=1)continue;s[6*o+0]=t,s[6*o+1]=e,s[6*o+2]=t,s[6*o+3]=e,s[6*o+4]=t,s[6*o+5]=e}if(void 0===f.properties[e.idProperty])throw new Error(`MVT feature with undefined idProperty '${e.idProperty}'`);this._decodeProperties(e,u,a,f,o),o++}return{properties:a,geometries:n,numFeatures:o}}_checkType(t,e){const r=t.type,n=C[r];if(n!==e)throw new Error(`MVT: mixed geometry types in the same layer. Layer has type: ${e} but feature was ${n}`)}_initializePropertyArrays(t,e){const r=this._getPropertyNamesFrom(t);return{propertyNames:r,properties:this._getPropertiesFor(r,e)}}_getPropertyNamesFrom(t){const e=[];for(let r=0;r<t.propertyKeys.length;r++){const n=t.propertyKeys[r];"geometry"!==t.properties[n].type&&e.push(...t.propertyNames(n))}return e}_getPropertiesFor(t,e){const r={},n=Math.ceil(e/j)*j,i=new ArrayBuffer(4*n*t.length);this._propertiesArrayBuffer=i;for(let e=0;e<t.length;e++){r[t[e]]=new Float32Array(i,4*e*n,n)}return r}_decodeProperties(t,e,r,n,i){const s=e.length;for(let o=0;o<s;o++){const s=e[o],a=n.properties[s];r[s][i]=this.decodeProperty(t,s,a)}}decodeProperty(t,e,r){if("string"==typeof r){if("category"!==t.properties[e].type)throw new Error(`MVT decoding error. Metadata property '${e}' is of type '${t.properties[e].type}' but the MVT tile contained a feature property of type string: '${r}'`);return t.categorizeString(e,r)}if("number"==typeof r){if("number"!==t.properties[e].type)throw new Error(`MVT decoding error. Metadata property '${e}' is of type '${t.properties[e].type}' but the MVT tile contained a feature property of type number: '${r}'`);return r}if(null===r||void 0===r)return Number.NaN;throw new Error(`MVT decoding error. Feature property value of type '${typeof r}' cannot be decoded.`)}_generateDataFrame(t,e,r,n,i,s){return new Z({active:!1,center:t.center,geom:e,properties:r,scale:t.scale,size:n,type:i,metadata:s})}}function $(t){const e={};return Object.keys(t).sort().forEach(r=>{let n=[...new Set(t[r].map(t=>JSON.stringify(t)))];n.sort(),n=n.map(t=>JSON.parse(t)),e[r]=n}),e}const q=new RegExp("^_cdb_agg_[a-zA-Z0-9]+_");var Y={column:{isAggregated:function(t){return t.startsWith("_cdb_agg_")},getBase:function(t){return t.replace(q,"")},getAggFN:function(t){let e=t.substr("_cdb_agg_".length);return e.substr(0,e.indexOf("_"))},aggColumn:(t,e)=>`_cdb_agg_${e}_${t}`},equals:function(t,e){return!(!t||!e)&&JSON.stringify($(t))===JSON.stringify($(e))},union:function(t,e){const r={};return new Set(Object.keys(t).concat(Object.keys(e))).forEach(n=>{const i=t[n]||[],s=e[n]||[],o=[...i,...s];r[n]=o}),r},IDENTITY:{},simplify:$};const J={MVT:new G,windshaft:new class extends G{decodeProperty(t,e,r){const n=Y.column.getBase(e),i=t.properties[n];if(i)switch(i.type){case"date":return function(t,e){const r=new Date;r.setTime(1e3*e);const{min:n,max:i}=t;return(r-n)/(i.getTime()-n.getTime())}(i,r);case"category":return t.categorizeString(n,r);case"number":return r;default:throw new Error(`Windshaft MVT decoding error. Feature property value of type '${typeof r}' cannot be decoded.`)}}}};onmessage=function(t){return J[t.data.workerName].onmessage(t)}}]);