import{r as t,c as e,h as s}from"./p-3fce0d94.js";import{c as i}from"./p-e64a8f04.js";import{r}from"./p-b11b551f.js";import{s as a}from"./p-b283ec9e.js";const h=class{constructor(s){t(this,s),this.categories=[],this.disableInteractivity=!1,this.valueFormatter=this.defaultFormatter,this.showClearButton=!1,this.showHeader=!0,this.useTotalPercentage=!1,this.visibleCategories=1/0,this.isLoading=!1,this.error="",this.errorDescription="",this.noDataHeaderMessage="NO DATA AVAILABLE",this.noDataBodyMessage="There is no data to display.",this.selectedCategories=[],this._firstDataSupplied=!1,this.categoriesSelected=e(this,"categoriesSelected",7)}onDataChange(){this._firstDataSupplied||(this._firstDataSupplied=Boolean(this.categories&&this.categories.length))}componentWillLoad(){this._firstDataSupplied=Boolean(this.categories&&this.categories.length)}defaultFormatter(t){return`${r(t)}`}async getSelectedCategories(){return this.selectedCategories}async clearSelection(){this.selectedCategories.length&&(this.selectedCategories=[],this._onCategoriesChanged())}render(){return this._isLoading()?s("as-category-widget-placeholder",null,this._renderHeader()):[this._renderHeader(),this._renderSelection(),this._renderContent()]}_renderSelection(){if(this._isLoading()||this._isEmpty()||this.error||!this.showClearButton)return"";const t=this.selectedCategories.length;return s("as-widget-selection",{selection:`${t||"All"} selected`,clearText:"Clear selection",showClear:t>0,onClear:()=>this.clearSelection()})}_renderHeader(){if(this.showHeader)return s("as-widget-header",{header:this.heading,subheader:this.description,"is-empty":this._isEmpty(),"is-loading":this._isLoading(),error:this.error,"no-data-message":this.noDataHeaderMessage})}_renderContent(){return i(!1,this.error,this._isEmpty(),this.heading,this.errorDescription,this.noDataBodyMessage,this._renderCategoryList())}_renderCategoryList(){return s("ul",{class:{"as-category-widget__list":!0,"as-category-widget__list--disabled":this.disableInteractivity}},this._renderCategories())}_renderCategories(){const t=this.categories.length>this.visibleCategories,{categories:e,otherCategory:s}=this._parseCategories();let i;const r=e.slice(0,this.visibleCategories),a=this.useTotalPercentage?this._getCategoriesTotalValue(this.categories):this._getCategoriesMaximumValue(e,Boolean(s));return(s||t)&&(i=this._renderOtherCategory(s,{maximumValue:a})),[r.map(t=>this._renderCategory(t,{maximumValue:a})),i]}_renderCategory(t,e){const{isOther:i,maximumValue:r}=e,a=this._isSelected(t.name),h=this.selectedCategories.length>0,o={backgroundColor:this._getBarColor(t.color,{isSelected:a,isOther:i})||"var(--as--category-bar--color)",width:`${t.value/r*100}%`},n={"as-category-widget__category":!0,"as-category-widget__category--not-selected":h&&(!a||i),"as-category-widget__category--other":i,"as-category-widget__category--selected":a},c=this.valueFormatter(t.value);return s("li",{class:n,onClick:()=>this._toggleCategory(t)},s("p",{class:"as-category-widget__info as-body"},s("div",{class:"as-category-widget__title"},t.name),c),s("div",{class:"as-category-widget__bar"},s("div",{class:"as-category-widget__bar-value",style:o})))}_renderOtherCategory(t,e){const s=t||{name:"Other",value:this._getCategoriesTotalValue(this.categories.slice(this.visibleCategories,this.categories.length))};return this._renderCategory(s,{maximumValue:e.maximumValue,isOther:!0})}_isSelected(t){return this.selectedCategories.includes(t)}_toggleCategory(t){this.disableInteractivity||(this.selectedCategories=this._isSelected(t.name)?this.selectedCategories.filter(e=>e!==t.name):[...this.selectedCategories,t.name],this._onCategoriesChanged())}_onCategoriesChanged(){this.categoriesSelected.emit(this.selectedCategories)}_getCategoriesMaximumValue(t,e=!1){return this._getVisibleCategories(t,e).reduce((t,e)=>e.value>t?e.value:t,0)}_getCategoriesTotalValue(t){return t.reduce((t,e)=>e.value+t,0)}_getBarColor(t,e={}){return e.isOther?"#747474":e.isSelected?a(-.16,t):t}_parseCategories(){const t=this.categories.find(t=>"Other"===t.name);return t?{categories:this.categories.filter(e=>e.name!==t.name),otherCategory:t}:{categories:this.categories}}_getVisibleCategories(t,e){return e?t:t.slice(0,this.visibleCategories)}_isLoading(){return(!this._firstDataSupplied||this.isLoading)&&!this.error}_isEmpty(){return this.categories&&!this.categories.length}static get watchers(){return{categories:["onDataChange"]}}static get style(){return"as-category-widget{--as--category-bar--background-color:var(--as--color--ui-02,#f5f5f5);--as--category-bar--color:var(--as--color--complementary,#47db99);--as--category-widget--background-color:var(--as--color--ui-01,#fff);--as--category-widget--bar--height:4px;--as--category-widget--description--color:var(--as--color--type-02,#747474);display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;min-width:228px;height:100%;overflow-y:auto;background:var(--as--category-widget--background-color)}as-category-widget .content{min-height:100px}as-category-widget as-widget-header{padding-top:6px}as-category-widget .as-category-widget__count{color:var(--as--category-widget--description--color)}as-category-widget .as-category-widget__list{-ms-flex:1;flex:1;margin:0;padding:0;overflow-y:auto;list-style:none}as-category-widget .as-category-widget__list.as-category-widget__list--disabled li{pointer-events:none}as-category-widget .as-category-widget__footer{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}as-category-widget .as-category-widget__list+.as-category-widget__footer{margin-top:16px}as-category-widget .as-category-widget__info{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}as-category-widget .as-category-widget__title{-ms-flex:1;flex:1;width:100%;padding-right:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}as-category-widget .as-category-widget__bar{position:relative;width:100%;height:var(--as--category-widget--bar--height);border-radius:2px;background-color:var(--as--category-bar--background-color)}as-category-widget .as-category-widget__bar-value{position:absolute;left:0;max-width:100%;height:var(--as--category-widget--bar--height);-webkit-transition:background .2s ease,opacity .5s ease;transition:background .2s ease,opacity .5s ease;border-radius:2px}as-category-widget .as-category-widget__category{margin-bottom:8px;cursor:pointer}as-category-widget .as-category-widget__category--other{pointer-events:none}as-category-widget .as-category-widget__category--not-selected{opacity:.5}as-category-widget .as-category-widget__category:not(.as-category-widget__category--selected):hover .as-category-widget__bar-value{opacity:.6}"}};export{h as as_category_widget};